
Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 500 initial simulations completed.
(PH4) No additional iteration simulations completed.
(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (500, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 89.98223114013672

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (500, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 278.63409423828125

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (500, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 253.9340362548828

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (500, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 144.67669677734375

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (500, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 210.08883666992188

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 214.84140014648438

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 179.5989990234375

(PH4) The number of combined interpolate curves is 500
(PH4) Finish training ANN for all loadings of curve PH4

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) Optimizing the parameters tau0
(PH4) First optimization stage starts

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 33.73849639720681

(PH4) #### Stage 1 ####
(PH4) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 500 initial simulations completed.
(PH4) No additional iteration simulations completed.
(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (500, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 76.08878326416016

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (500, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 218.25428771972656

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (500, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 192.36630249023438

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (500, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 130.9629669189453

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (500, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 157.4132537841797

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 111.32046508789062

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 152.31378173828125

(PH4) The number of combined interpolate curves is 500
(PH4) Finish training ANN for all loadings of curve PH4

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) Optimizing the parameters tau0
(PH4) First optimization stage starts

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 52.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 0.9170251966426355

(PH4) #### Stage 1 ####
(PH4) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 500 initial simulations completed.
(PH4) No additional iteration simulations completed.
(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (500, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 93.27704620361328

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (500, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 190.383056640625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (500, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 261.85565185546875

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (500, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 142.61865234375

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (500, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 204.25465393066406

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 189.41482543945312

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 96.13579559326172

(PH4) The number of combined interpolate curves is 500
(PH4) Finish training ANN for all loadings of curve PH4

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) Optimizing the parameters tau0
(PH4) First optimization stage starts

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 13.628665983580413

(PH4) #### Stage 1 ####
(PH4) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 500 initial simulations completed.
(PH4) No additional iteration simulations completed.
(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (500, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 113.50532531738281

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (500, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 266.7383117675781

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (500, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 312.26806640625

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (500, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 267.64312744140625

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (500, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 234.1908721923828

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 84.66341400146484

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 178.0808868408203

(PH4) The number of combined interpolate curves is 500
(PH4) Finish training ANN for all loadings of curve PH4

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) Optimizing the parameters tau0
(PH4) First optimization stage starts

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 55.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 47.431910734930916

(PH4) #### Stage 1 ####
(PH4) Running iteration 1 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 501

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 57.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 2.9695714566383735

(PH4) #### Stage 1 ####
(PH4) Running iteration 2 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 502

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) The best candidate parameters found by GA
(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |     6.434218      |
|     h0     |  324.312156 MPa   |
|    tau0    | 55.0 MPa (target) |
|   tausat   |  784.607804 MPa   |
|    self    |     0.967484      |
|  coplanar  |     1.624813      |
| collinear  |     5.07754       |
| orthogonal |     0.872437      |
|  glissile  |     0.247625      |
|  sessile   |     2.332166      |
+------------+-------------------+
(PH4) Parameters already probed. GA needs to run again to obtain new parameters
(PH4) Retraining ANN with slightly different configurations to prevent repeated parameters
(PH4) The number of combined interpolate curves is 502

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) The best candidate parameters found by GA
(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |     6.434218      |
|     h0     |  324.312156 MPa   |
|    tau0    | 57.0 MPa (target) |
|   tausat   |  784.607804 MPa   |
|    self    |     0.967484      |
|  coplanar  |     1.624813      |
| collinear  |     5.07754       |
| orthogonal |     0.872437      |
|  glissile  |     0.247625      |
|  sessile   |     2.332166      |
+------------+-------------------+
(PH4) Parameters already probed. GA needs to run again to obtain new parameters
(PH4) Retraining ANN with slightly different configurations to prevent repeated parameters
(PH4) The number of combined interpolate curves is 502

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 52.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 12.770384781023992

(PH4) #### Stage 1 ####
(PH4) Running iteration 3 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 503

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 56.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 66.04300734733593

(PH4) #### Stage 1 ####
(PH4) Running iteration 4 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 504

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 58.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 178.3551163800651

(PH4) #### Stage 1 ####
(PH4) Running iteration 5 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 505

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) The best candidate parameters found by GA
(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |     6.434218      |
|     h0     |  324.312156 MPa   |
|    tau0    | 52.0 MPa (target) |
|   tausat   |  784.607804 MPa   |
|    self    |     0.967484      |
|  coplanar  |     1.624813      |
| collinear  |     5.07754       |
| orthogonal |     0.872437      |
|  glissile  |     0.247625      |
|  sessile   |     2.332166      |
+------------+-------------------+
(PH4) Parameters already probed. GA needs to run again to obtain new parameters
(PH4) Retraining ANN with slightly different configurations to prevent repeated parameters
(PH4) The number of combined interpolate curves is 505

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 49.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 140.3541946207893

(PH4) #### Stage 1 ####
(PH4) Running iteration 6 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 506

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 21.673039013029914

(PH4) #### Stage 1 ####
(PH4) Running iteration 7 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 507

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 7
(PH4) The first stage parameter solution is:
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) First optimization stage finished

(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     4.4 (target)    |
|     h0     | 1127.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  261.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 133.07596726613258

(PH4) #### Stage 3 ####
(PH4) Running iteration 8 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 7 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 507 simulations completed.(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (507, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (507, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 104.10208892822266

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (507, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (507, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 156.3531036376953

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (507, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (507, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 245.15480041503906

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (507, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (507, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 137.67637634277344

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (507, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (507, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 226.3766326904297

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (507, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (507, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 120.69710540771484

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (507, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (507, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 151.53421020507812

(PH4) The number of combined interpolate curves is 507
(PH4) Finish training ANN for all loadings of curve PH4

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.67 (target)    |
|     h0     | 354.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 627.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 125.67673523584644

(PH4) #### Stage 3 ####
(PH4) Running iteration 8 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 508

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.88 (target)    |
|     h0     | 1005.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  353.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 91.43377788239741

(PH4) #### Stage 3 ####
(PH4) Running iteration 9 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 509

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.89 (target)    |
|     h0     | 1147.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  220.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 121.0833570781267

(PH4) #### Stage 3 ####
(PH4) Running iteration 10 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 510

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.31 (target)    |
|     h0     | 1158.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  337.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 115.21016733195887

(PH4) #### Stage 3 ####
(PH4) Running iteration 11 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 511

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.72 (target)    |
|     h0     | 1020.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  218.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 77.08164663246978

(PH4) #### Stage 3 ####
(PH4) Running iteration 12 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 512

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.06 (target)    |
|     h0     | 1264.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  266.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 75.18339168336277

(PH4) #### Stage 3 ####
(PH4) Running iteration 13 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 513

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.24 (target)    |
|     h0     | 725.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 183.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 86.31821759475824

(PH4) #### Stage 3 ####
(PH4) Running iteration 14 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 514

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.97 (target)    |
|     h0     | 643.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 231.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 77.69578381168756

(PH4) #### Stage 3 ####
(PH4) Running iteration 15 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 515

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.47 (target)    |
|     h0     | 844.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 223.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 92.60409321413087

(PH4) #### Stage 3 ####
(PH4) Running iteration 16 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 516

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.93 (target)    |
|     h0     | 831.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 154.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 86.65478109278675

(PH4) #### Stage 3 ####
(PH4) Running iteration 17 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 517

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.85 (target)    |
|     h0     | 777.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 256.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 58.27580137260639

(PH4) #### Stage 3 ####
(PH4) Running iteration 18 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 518

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.86 (target)    |
|     h0     | 455.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 343.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 73.18601803707998

(PH4) #### Stage 3 ####
(PH4) Running iteration 19 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 519

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.15 (target)    |
|     h0     | 704.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 282.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 79.04686250409108

(PH4) #### Stage 3 ####
(PH4) Running iteration 20 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 520

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    4.06 (target)    |
|     h0     | 1017.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  245.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 75.18819579892445

(PH4) #### Stage 3 ####
(PH4) Running iteration 21 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 521

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.79 (target)    |
|     h0     | 1069.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  300.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 77.45743748517606

(PH4) #### Stage 3 ####
(PH4) Running iteration 22 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 522

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.23 (target)    |
|     h0     | 988.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 299.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 72.6287767550729

(PH4) #### Stage 3 ####
(PH4) Running iteration 23 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 523

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.36 (target)    |
|     h0     | 1092.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  290.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 74.45760029452022

(PH4) #### Stage 3 ####
(PH4) Running iteration 24 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 524

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.48 (target)    |
|     h0     | 1054.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  299.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 103.17527529903084

(PH4) #### Stage 3 ####
(PH4) Running iteration 25 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 525

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    9.65 (target)    |
|     h0     | 1695.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  376.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 96.92366948796058

(PH4) #### Stage 3 ####
(PH4) Running iteration 26 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 526

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.18 (target)    |
|     h0     | 1234.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  262.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 97.60115607195696

(PH4) #### Stage 3 ####
(PH4) Running iteration 27 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 527

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.81 (target)    |
|     h0     | 864.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 298.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 84.56560294777478

(PH4) #### Stage 3 ####
(PH4) Running iteration 28 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 528

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.06 (target)    |
|     h0     | 1105.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  316.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 99.30696523381168

(PH4) #### Stage 3 ####
(PH4) Running iteration 29 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 529

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    5.4 (target)    |
|     h0     | 947.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 308.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 93.30120969708503

(PH4) #### Stage 3 ####
(PH4) Running iteration 30 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 530

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    5.8 (target)    |
|     h0     | 608.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 423.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 84.43522015235862

(PH4) #### Stage 3 ####
(PH4) Running iteration 31 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 531

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.65 (target)    |
|     h0     | 706.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 262.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 67.8471909590535

(PH4) #### Stage 3 ####
(PH4) Running iteration 32 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 532

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.48 (target)    |
|     h0     | 724.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 357.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 90.3802541974592

(PH4) #### Stage 3 ####
(PH4) Running iteration 33 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 533

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.57 (target)    |
|     h0     | 557.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 280.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 62.23391095230685

(PH4) #### Stage 3 ####
(PH4) Running iteration 34 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 534

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.96 (target)    |
|     h0     | 670.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 221.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 66.97281325587414

(PH4) #### Stage 3 ####
(PH4) Running iteration 35 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 535

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.77 (target)    |
|     h0     | 1242.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  279.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 61.30299971996682

(PH4) #### Stage 3 ####
(PH4) Running iteration 36 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 536

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.11 (target)    |
|     h0     | 921.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 200.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 88.65642898170398

(PH4) #### Stage 3 ####
(PH4) Running iteration 37 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 537

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.33 (target)    |
|     h0     | 866.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 263.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 88.05420318747557

(PH4) #### Stage 3 ####
(PH4) Running iteration 38 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 538

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     5.7 (target)    |
|     h0     | 1232.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  293.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 95.78291420753025

(PH4) #### Stage 3 ####
(PH4) Running iteration 39 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 539

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.56 (target)    |
|     h0     | 1203.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  332.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 118.55515369680607

(PH4) #### Stage 3 ####
(PH4) Running iteration 40 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 540

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.04 (target)    |
|     h0     | 1112.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  311.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 78.77010955322427

(PH4) #### Stage 3 ####
(PH4) Running iteration 41 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 541

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.38 (target)    |
|     h0     | 821.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 225.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 77.97072120270545

(PH4) #### Stage 3 ####
(PH4) Running iteration 42 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 542

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.45 (target)    |
|     h0     | 692.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 295.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 86.73451236592572

(PH4) #### Stage 3 ####
(PH4) Running iteration 43 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 543

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.76 (target)    |
|     h0     | 895.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 323.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 72.71165914736913

(PH4) #### Stage 3 ####
(PH4) Running iteration 44 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 544

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.09 (target)    |
|     h0     | 908.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 149.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 70.2646687782497

(PH4) #### Stage 3 ####
(PH4) Running iteration 45 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 545

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.15 (target)    |
|     h0     | 750.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 273.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 94.09585191736888

(PH4) #### Stage 3 ####
(PH4) Running iteration 46 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 546

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.16 (target)    |
|     h0     | 1458.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  291.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 63.89915098526551

(PH4) #### Stage 3 ####
(PH4) Running iteration 47 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 547

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.31 (target)    |
|     h0     | 711.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 242.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 79.7483716831893

(PH4) #### Stage 3 ####
(PH4) Running iteration 48 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 548

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.83 (target)    |
|     h0     | 499.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 313.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 85.90034561440436

(PH4) #### Stage 3 ####
(PH4) Running iteration 49 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 549

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.05 (target)    |
|     h0     | 1389.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  250.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 75.41676939440325

(PH4) #### Stage 3 ####
(PH4) Running iteration 50 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 550

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.13 (target)    |
|     h0     | 960.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 331.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 106.57419680782792

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 551

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.12 (target)    |
|     h0     | 1099.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  273.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 82.35808775702054

(PH4) #### Stage 3 ####
(PH4) Running iteration 52 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 552

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.35 (target)    |
|     h0     | 647.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 299.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 81.22634712318

(PH4) #### Stage 3 ####
(PH4) Running iteration 53 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 553

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.26 (target)    |
|     h0     | 545.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 200.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 76.10529797209307

(PH4) #### Stage 3 ####
(PH4) Running iteration 54 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 554

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.03 (target)    |
|     h0     | 1151.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  257.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 90.89667127953246

(PH4) #### Stage 3 ####
(PH4) Running iteration 55 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 555

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.48 (target)    |
|     h0     | 484.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 312.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 88.10437854804564

(PH4) #### Stage 3 ####
(PH4) Running iteration 56 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 556

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.86 (target)    |
|     h0     | 1082.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  218.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 72.1754391581234

(PH4) #### Stage 3 ####
(PH4) Running iteration 57 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 557

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.97 (target)    |
|     h0     | 1246.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  295.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 94.51418325048522

(PH4) #### Stage 3 ####
(PH4) Running iteration 58 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 57 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 557 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (557, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (557, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 109.63197326660156

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (557, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 187.2705078125

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (557, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 196.54750061035156

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (557, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 150.89840698242188

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (557, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 265.61126708984375

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (557, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 93.46725463867188

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (557, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 146.70152282714844

(PH4) The number of combined interpolate curves is 557
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.682526111602783s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Searching time by GA: 62.20328068733215s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.39 (target)    |
|     h0     | 771.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 240.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 40.50239440676637

(PH4) #### Stage 3 ####
(PH4) Running iteration 58 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 57 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 557 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (557, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (557, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 112.62032318115234

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (557, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 228.3643798828125

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (557, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 199.8668212890625

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (557, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 100.89974975585938

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (557, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 198.2056121826172

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (557, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 127.05368041992188

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (557, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (557, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 153.60174560546875

(PH4) The number of combined interpolate curves is 557
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.929900884628296s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Searching time by GA: 48.639758825302124s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    9.92 (target)    |
|     h0     | 1772.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  394.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 49.81454864797485

(PH4) #### Stage 3 ####
(PH4) Running iteration 58 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) The total weighted hardening MSE of the iteration curve is 74.43214073751108

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 558

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Searching time by GA: 42.79499530792236s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    7.58 (target)    |
|     h0     | 1424.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  332.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 34.0440121772919

(PH4) #### Stage 3 ####
(PH4) Running iteration 59 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) The total weighted hardening MSE of the iteration curve is 97.68339941311575

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 559

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Searching time by GA: 85.75938296318054s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.45 (target)    |
|     h0     | 964.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 173.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 32.68982257604866

(PH4) #### Stage 3 ####
(PH4) Running iteration 60 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) The total weighted hardening MSE of the iteration curve is 92.72160678827576

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 560

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Searching time by GA: 57.6661581993103s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.84 (target)    |
|     h0     | 1579.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  300.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 53.09057483098333

(PH4) #### Stage 3 ####
(PH4) Running iteration 61 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) The total weighted hardening MSE of the iteration curve is 71.78682990552777

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 561

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Searching time by GA: 54.036174058914185s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    8.21 (target)    |
|     h0     | 1466.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  360.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 83.27340169161256

(PH4) #### Stage 3 ####
(PH4) Running iteration 62 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) The total weighted hardening MSE of the iteration curve is 71.57853154630415

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 562

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Searching time by GA: 65.4694561958313s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.49 (target)    |
|     h0     | 847.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 289.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 51.382596846481555

(PH4) #### Stage 3 ####
(PH4) Running iteration 63 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) The total weighted hardening MSE of the iteration curve is 105.18091617189188

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 563

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Searching time by GA: 88.12158942222595s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.19 (target)    |
|     h0     | 1429.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  286.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 43.83864548022454

(PH4) #### Stage 3 ####
(PH4) Running iteration 64 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) The total weighted hardening MSE of the iteration curve is 72.25637550204988

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 564

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Searching time by GA: 28.448434829711914s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.96 (target)    |
|     h0     | 1585.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  266.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 46.8696886346776

(PH4) #### Stage 3 ####
(PH4) Running iteration 65 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) The total weighted hardening MSE of the iteration curve is 76.05874322084155

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 565

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Searching time by GA: 40.1227822303772s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.83 (target)    |
|     h0     | 624.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 426.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 70.86645918396614

(PH4) #### Stage 3 ####
(PH4) Running iteration 66 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) The total weighted hardening MSE of the iteration curve is 106.87858095709443

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 566

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Searching time by GA: 31.952800750732422s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.73 (target)    |
|     h0     | 1125.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  291.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 39.43607164893618

(PH4) #### Stage 3 ####
(PH4) Running iteration 67 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) The total weighted hardening MSE of the iteration curve is 84.62870331360426

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 567

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Searching time by GA: 78.87082529067993s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    7.02 (target)    |
|     h0     | 1165.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  350.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 48.55546571634084

(PH4) #### Stage 3 ####
(PH4) Running iteration 68 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) The total weighted hardening MSE of the iteration curve is 70.13528434549275

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 568

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Searching time by GA: 82.51016926765442s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    8.84 (target)    |
|     h0     | 1555.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  384.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 42.72315202970757

(PH4) #### Stage 3 ####
(PH4) Running iteration 69 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) The total weighted hardening MSE of the iteration curve is 74.45621531399507

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 569

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Searching time by GA: 39.23866057395935s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.34 (target)    |
|     h0     | 1282.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  294.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.7559611688122

(PH4) #### Stage 3 ####
(PH4) Running iteration 70 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) The total weighted hardening MSE of the iteration curve is 120.33872950984565

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 570

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Searching time by GA: 42.31447672843933s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.29 (target)    |
|     h0     | 741.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 179.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 38.00421144291997

(PH4) #### Stage 3 ####
(PH4) Running iteration 71 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) The total weighted hardening MSE of the iteration curve is 69.69188167592884

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 571

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Searching time by GA: 33.94624948501587s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    7.98 (target)    |
|     h0     | 1523.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  344.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 39.55704422635928

(PH4) #### Stage 3 ####
(PH4) Running iteration 72 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) The total weighted hardening MSE of the iteration curve is 75.99061418834847

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 572

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Searching time by GA: 75.88575053215027s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.65 (target)    |
|     h0     | 641.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 319.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 45.008857435882604

(PH4) #### Stage 3 ####
(PH4) Running iteration 73 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) The total weighted hardening MSE of the iteration curve is 111.79086614090525

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 573

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Searching time by GA: 28.08177089691162s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.04 (target)    |
|     h0     | 753.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 329.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 43.187509269535525

(PH4) #### Stage 3 ####
(PH4) Running iteration 74 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) The total weighted hardening MSE of the iteration curve is 81.1926148270081

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 574

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Searching time by GA: 39.95488357543945s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.69 (target)    |
|     h0     | 600.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 463.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 64.7238189829277

(PH4) #### Stage 3 ####
(PH4) Running iteration 75 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) The total weighted hardening MSE of the iteration curve is 103.78017166242905

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 575

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Searching time by GA: 28.242833375930786s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     4.0 (target)    |
|     h0     | 1247.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  222.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 37.841581013428

(PH4) #### Stage 3 ####
(PH4) Running iteration 76 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) The total weighted hardening MSE of the iteration curve is 93.71843741544681

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 576

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Searching time by GA: 53.82738208770752s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     8.7 (target)    |
|     h0     | 1442.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  380.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 40.92365669224709

(PH4) #### Stage 3 ####
(PH4) Running iteration 77 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) The total weighted hardening MSE of the iteration curve is 73.13699958642987

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 577

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Searching time by GA: 53.76735258102417s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.11 (target)    |
|     h0     | 566.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 243.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 44.05838577889885

(PH4) #### Stage 3 ####
(PH4) Running iteration 78 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) The total weighted hardening MSE of the iteration curve is 139.01540158104555

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 578

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Searching time by GA: 42.930577993392944s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    4.47 (target)    |
|     h0     | 1124.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  240.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 47.326247090771716

(PH4) #### Stage 3 ####
(PH4) Running iteration 79 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) The total weighted hardening MSE of the iteration curve is 76.48412516788599

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 579

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Searching time by GA: 28.17968988418579s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.04 (target)    |
|     h0     | 1244.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  177.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 29.18566330498794

(PH4) #### Stage 3 ####
(PH4) Running iteration 80 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) The total weighted hardening MSE of the iteration curve is 70.24906104529053

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 580

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Searching time by GA: 56.65100026130676s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   9.38 (target)    |
|     h0     | 694.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 585.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 49.18961449029396

(PH4) #### Stage 3 ####
(PH4) Running iteration 81 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) The total weighted hardening MSE of the iteration curve is 87.85179707514445

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 581

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Searching time by GA: 47.75145888328552s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    7.38 (target)    |
|     h0     | 1489.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  330.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 31.007837677564385

(PH4) #### Stage 3 ####
(PH4) Running iteration 82 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) The total weighted hardening MSE of the iteration curve is 69.23428769866301

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 582

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Searching time by GA: 56.97052359580994s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    7.15 (target)    |
|     h0     | 1217.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  352.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 44.373736800435104

(PH4) #### Stage 3 ####
(PH4) Running iteration 83 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) The total weighted hardening MSE of the iteration curve is 72.84142000391303

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 583

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Searching time by GA: 36.30905365943909s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.14 (target)    |
|     h0     | 1565.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  274.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 99.52248738306577

(PH4) #### Stage 3 ####
(PH4) Running iteration 84 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) The total weighted hardening MSE of the iteration curve is 75.03059407827507

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 584

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Searching time by GA: 48.255531549453735s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    3.7 (target)    |
|     h0     | 701.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 259.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 68.9339109950845

(PH4) #### Stage 3 ####
(PH4) Running iteration 85 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) The total weighted hardening MSE of the iteration curve is 79.79210673743097

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 585

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Searching time by GA: 62.8865807056427s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    3.5 (target)    |
|     h0     | 607.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 267.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 40.42171557974443

(PH4) #### Stage 3 ####
(PH4) Running iteration 86 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) The total weighted hardening MSE of the iteration curve is 88.86437390219126

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 586

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Searching time by GA: 61.663280963897705s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.85 (target)    |
|     h0     | 502.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 551.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 43.37875700540759

(PH4) #### Stage 3 ####
(PH4) Running iteration 87 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) The total weighted hardening MSE of the iteration curve is 104.92637734474367

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 587

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Searching time by GA: 42.32624530792236s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.02 (target)    |
|     h0     | 751.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 421.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.46704712028789

(PH4) #### Stage 3 ####
(PH4) Running iteration 88 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) The total weighted hardening MSE of the iteration curve is 95.376471988057

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 588

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Searching time by GA: 28.03067445755005s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.16 (target)    |
|     h0     | 1256.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  267.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 37.44436829259141

(PH4) #### Stage 3 ####
(PH4) Running iteration 89 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) The total weighted hardening MSE of the iteration curve is 78.41594630726698

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 589

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Searching time by GA: 56.26445031166077s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    7.88 (target)    |
|     h0     | 1361.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  368.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 43.59714590209005

(PH4) #### Stage 3 ####
(PH4) Running iteration 90 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) The total weighted hardening MSE of the iteration curve is 78.02904235886203

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 590

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Searching time by GA: 43.385615825653076s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    4.9 (target)    |
|     h0     | 676.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 328.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 37.679934273878125

(PH4) #### Stage 3 ####
(PH4) Running iteration 91 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) The total weighted hardening MSE of the iteration curve is 94.35729500434128

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 591

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Searching time by GA: 51.79924774169922s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    9.91 (target)    |
|     h0     | 1870.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  386.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.24333873748879

(PH4) #### Stage 3 ####
(PH4) Running iteration 92 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) The total weighted hardening MSE of the iteration curve is 75.19061795955918

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 592

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Searching time by GA: 25.00492024421692s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    9.92 (target)    |
|     h0     | 1798.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  389.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 51.73118046248047

(PH4) #### Stage 3 ####
(PH4) Running iteration 93 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) The total weighted hardening MSE of the iteration curve is 81.46862858554715

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 593

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Searching time by GA: 80.12399816513062s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.31 (target)    |
|     h0     | 1470.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  244.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.3767266567646

(PH4) #### Stage 3 ####
(PH4) Running iteration 94 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) The total weighted hardening MSE of the iteration curve is 104.06737206720958

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 594

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Searching time by GA: 77.00281071662903s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.32 (target)    |
|     h0     | 1205.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  189.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 35.89915598765578

(PH4) #### Stage 3 ####
(PH4) Running iteration 95 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) The total weighted hardening MSE of the iteration curve is 70.7156346544046

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 595

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Searching time by GA: 81.57986903190613s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    6.05 (target)    |
|     h0     | 1367.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  285.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 42.80900158653156

(PH4) #### Stage 3 ####
(PH4) Running iteration 96 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) The total weighted hardening MSE of the iteration curve is 72.98382482020794

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 596

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Searching time by GA: 39.932374000549316s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.28 (target)    |
|     h0     | 875.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 263.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 47.6291378976312

(PH4) #### Stage 3 ####
(PH4) Running iteration 97 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) The total weighted hardening MSE of the iteration curve is 71.90484755458057

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 597

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Searching time by GA: 65.4254264831543s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    4.68 (target)    |
|     h0     | 1236.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  248.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 36.81526152263011

(PH4) #### Stage 3 ####
(PH4) Running iteration 98 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 97 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 597 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (597, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (597, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 108.10066986083984

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (597, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (597, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 202.08941650390625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (597, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (597, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 152.92774963378906

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (597, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (597, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 130.43516540527344

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (597, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (597, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 196.5137481689453

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (597, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (597, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 166.38421630859375

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (597, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (597, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 144.820068359375

(PH4) The number of combined interpolate curves is 597
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 26.321520566940308s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Searching time by GA: 47.61414694786072s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.55 (target)    |
|     h0     | 699.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 117.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 240.14570560897954

(PH4) #### Stage 3 ####
(PH4) Running iteration 98 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) The total weighted hardening MSE of the iteration curve is 1489.5437813429062

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 598

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Searching time by GA: 47.67100930213928s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    5.48 (target)    |
|     h0     | 1531.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  250.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 196.90674512340397

(PH4) #### Stage 3 ####
(PH4) Running iteration 99 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) The total weighted hardening MSE of the iteration curve is 292.0185306350496

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 599

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Searching time by GA: 73.07230758666992s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.99 (target)    |
|     h0     | 719.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 322.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 211.21948500789233

(PH4) #### Stage 3 ####
(PH4) Running iteration 100 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) The total weighted hardening MSE of the iteration curve is 259.6067125532706

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 600

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Searching time by GA: 26.49817442893982s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.81 (target)    |
|     h0     | 604.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 333.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 189.25962976268949

(PH4) #### Stage 3 ####
(PH4) Running iteration 101 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) The total weighted hardening MSE of the iteration curve is 307.73693998240105

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 601

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Searching time by GA: 27.000020742416382s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    2.71 (target)    |
|     h0     | 1010.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  179.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 191.54340483692184

(PH4) #### Stage 3 ####
(PH4) Running iteration 102 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) The total weighted hardening MSE of the iteration curve is 277.3479929584194

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 602

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Searching time by GA: 94.530282497406s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.14 (target)    |
|     h0     | 1050.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  197.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 200.50383945832584

(PH4) #### Stage 3 ####
(PH4) Running iteration 103 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) The total weighted hardening MSE of the iteration curve is 288.52276303778723

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 603

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Searching time by GA: 45.655110359191895s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.19 (target)    |
|     h0     | 936.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 298.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 198.7656029277733

(PH4) #### Stage 3 ####
(PH4) Running iteration 104 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) The total weighted hardening MSE of the iteration curve is 254.14728438231776

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 604

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 104 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 604 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (604, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (604, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 115.67239379882812

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (604, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 159.12826538085938

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (604, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 173.96493530273438

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (604, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 172.4628448486328

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (604, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 183.80116271972656

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (604, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 140.6845245361328

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (604, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 141.60781860351562

(PH4) The number of combined interpolate curves is 604
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.741246223449707s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Searching time by GA: 44.81053423881531s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.32 (target)    |
|     h0     | 972.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 253.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 210.0123066489969

(PH4) #### Stage 3 ####
(PH4) Running iteration 105 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) The total weighted hardening MSE of the iteration curve is 270.45215276283534

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 605

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Searching time by GA: 56.11950349807739s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.55 (target)    |
|     h0     | 977.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 398.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 207.17313559223354

(PH4) #### Stage 3 ####
(PH4) Running iteration 106 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) The total weighted hardening MSE of the iteration curve is 276.55131050646025

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 606

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) Searching time by GA: 38.68666100502014s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.82 (target)    |
|     h0     | 1193.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  222.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 217.67376849247484

(PH4) #### Stage 3 ####
(PH4) Running iteration 107 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) The total weighted hardening MSE of the iteration curve is 358.1345555313276

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 607

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Searching time by GA: 64.19346857070923s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.95 (target)    |
|     h0     | 525.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 335.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 190.8375932132178

(PH4) #### Stage 3 ####
(PH4) Running iteration 108 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) The total weighted hardening MSE of the iteration curve is 320.0884789628292

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 608

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Searching time by GA: 37.01072287559509s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.72 (target)    |
|     h0     | 819.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 295.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 191.43733467655832

(PH4) #### Stage 3 ####
(PH4) Running iteration 109 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) The total weighted hardening MSE of the iteration curve is 275.31463340907237

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 609

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Searching time by GA: 25.726539134979248s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     9.6 (target)    |
|     h0     | 1469.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  402.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 170.31968886847093

(PH4) #### Stage 3 ####
(PH4) Running iteration 110 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) The total weighted hardening MSE of the iteration curve is 312.86564510142233

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 610

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Searching time by GA: 89.03184533119202s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.56 (target)    |
|     h0     | 788.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 386.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 231.59369774940376

(PH4) #### Stage 3 ####
(PH4) Running iteration 111 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) The total weighted hardening MSE of the iteration curve is 295.3921855524205

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 611

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Searching time by GA: 25.65223503112793s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    8.49 (target)    |
|     h0     | 1485.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  365.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 224.52520248225105

(PH4) #### Stage 3 ####
(PH4) Running iteration 112 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) The total weighted hardening MSE of the iteration curve is 289.6488937207158

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 612

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 112 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 612 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (612, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (612, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 114.65480041503906

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (612, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (612, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 156.46817016601562

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (612, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (612, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 238.75469970703125

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (612, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (612, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 149.66455078125

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (612, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (612, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 180.89999389648438

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (612, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (612, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 90.68213653564453

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (612, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (612, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 120.39949798583984

(PH4) The number of combined interpolate curves is 612
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.045424938201904s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Searching time by GA: 40.95140266418457s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.94 (target)    |
|     h0     | 765.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 264.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 246.11764336885543

(PH4) #### Stage 3 ####
(PH4) Running iteration 113 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) The total weighted hardening MSE of the iteration curve is 292.75934701983806

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 613

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Searching time by GA: 32.836488246917725s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    5.8 (target)    |
|     h0     | 451.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 516.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 236.18575350743188

(PH4) #### Stage 3 ####
(PH4) Running iteration 114 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) The total weighted hardening MSE of the iteration curve is 358.7754776075916

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 614

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Searching time by GA: 47.14275932312012s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.72 (target)    |
|     h0     | 783.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 346.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 232.5113549727722

(PH4) #### Stage 3 ####
(PH4) Running iteration 115 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 114 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 614 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (614, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (614, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 90.49372863769531

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (614, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (614, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 126.02801513671875

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (614, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (614, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 214.480712890625

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (614, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (614, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 92.99430847167969

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (614, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (614, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 187.85145568847656

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (614, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (614, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 120.61326599121094

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (614, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (614, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 194.61019897460938

(PH4) The number of combined interpolate curves is 614
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.5616238117218s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Searching time by GA: 40.3369562625885s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.71 (target)    |
|     h0     | 936.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 181.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 180.66333519825497

(PH4) #### Stage 3 ####
(PH4) Running iteration 115 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) The total weighted hardening MSE of the iteration curve is 294.5485931061053

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 615

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Searching time by GA: 50.93764090538025s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.51 (target)    |
|     h0     | 573.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 268.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 232.84290621521612

(PH4) #### Stage 3 ####
(PH4) Running iteration 116 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) The total weighted hardening MSE of the iteration curve is 352.10455371025904

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 616

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Searching time by GA: 29.034788846969604s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.26 (target)    |
|     h0     | 507.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 422.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 318.83088123506684

(PH4) #### Stage 3 ####
(PH4) Running iteration 117 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) The total weighted hardening MSE of the iteration curve is 344.45921444324387

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 617

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Searching time by GA: 45.56900453567505s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    4.04 (target)    |
|     h0     | 1002.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  242.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 231.51342278267683

(PH4) #### Stage 3 ####
(PH4) Running iteration 118 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) The total weighted hardening MSE of the iteration curve is 309.1082047575927

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 618

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Searching time by GA: 32.71105718612671s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.33 (target)    |
|     h0     | 476.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 329.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 250.47362635878892

(PH4) #### Stage 3 ####
(PH4) Running iteration 119 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) The total weighted hardening MSE of the iteration curve is 408.862936734845

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 619

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 119 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 619 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (619, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (619, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 78.21842956542969

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (619, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (619, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 235.7418670654297

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (619, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (619, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 212.67636108398438

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (619, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (619, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 144.3231658935547

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (619, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (619, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 169.92584228515625

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (619, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (619, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 191.8616180419922

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (619, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (619, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 151.98915100097656

(PH4) The number of combined interpolate curves is 619
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.114849090576172s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) Searching time by GA: 30.18094754219055s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    2.94 (target)    |
|     h0     | 1171.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  172.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 235.0575699870219

(PH4) #### Stage 3 ####
(PH4) Running iteration 120 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) The total weighted hardening MSE of the iteration curve is 339.7592466438505

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 620

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 121 ####
(PH4) Searching time by GA: 85.41475987434387s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    6.3 (target)    |
|     h0     | 962.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 353.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 250.63256035744055

(PH4) #### Stage 3 ####
(PH4) Running iteration 121 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 121 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 121 ####
(PH4) The total weighted hardening MSE of the iteration curve is 303.20586397495566

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 121 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 621

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 121 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 122 ####
(PH4) Searching time by GA: 30.32327127456665s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.91 (target)    |
|     h0     | 447.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 366.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 229.77273599459383

(PH4) #### Stage 3 ####
(PH4) Running iteration 122 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 122 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 122 ####
(PH4) The total weighted hardening MSE of the iteration curve is 350.80567017223166

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 122 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 622

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 122 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 123 ####
(PH4) Searching time by GA: 53.04168486595154s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    9.78 (target)    |
|     h0     | 1246.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  444.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 254.1730710477329

(PH4) #### Stage 3 ####
(PH4) Running iteration 123 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 122 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 622 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (622, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (622, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 121.50350952148438

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (622, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (622, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 311.1142883300781

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (622, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (622, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 143.0047149658203

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (622, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (622, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 178.29449462890625

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (622, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (622, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 202.79408264160156

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (622, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (622, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 120.3495101928711

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (622, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (622, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 150.5669403076172

(PH4) The number of combined interpolate curves is 622
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.826416730880737s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 123 ####
(PH4) Searching time by GA: 28.621558666229248s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.45 (target)    |
|     h0     | 986.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 383.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 175.22726297990033

(PH4) #### Stage 3 ####
(PH4) Running iteration 123 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 123 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 123 ####
(PH4) The total weighted hardening MSE of the iteration curve is 218.3845633731114

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 123 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 623

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 123 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 124 ####
(PH4) Searching time by GA: 25.91190528869629s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.72 (target)    |
|     h0     | 714.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 202.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 111.06343383676234

(PH4) #### Stage 3 ####
(PH4) Running iteration 124 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 124 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 124 ####
(PH4) The total weighted hardening MSE of the iteration curve is 223.96845206051

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 124 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 624

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 124 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 125 ####
(PH4) Searching time by GA: 60.318174600601196s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.18 (target)    |
|     h0     | 781.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 305.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 147.53422941958752

(PH4) #### Stage 3 ####
(PH4) Running iteration 125 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 124 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 624 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (624, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (624, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 107.38167572021484

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (624, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (624, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 221.62550354003906

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (624, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (624, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 256.7091064453125

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (624, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (624, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 105.15491485595703

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (624, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (624, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 176.99546813964844

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (624, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (624, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 154.67788696289062

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (624, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (624, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 244.3146514892578

(PH4) The number of combined interpolate curves is 624
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.85375165939331s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 125 ####
(PH4) Searching time by GA: 50.16955041885376s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.45 (target)    |
|     h0     | 519.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 324.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 246.4627314562137

(PH4) #### Stage 3 ####
(PH4) Running iteration 125 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 125 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 125 ####
(PH4) The total weighted hardening MSE of the iteration curve is 409.040662650591

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 125 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 625

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 125 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 126 ####
(PH4) Searching time by GA: 76.88002514839172s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.93 (target)    |
|     h0     | 1234.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  203.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 252.32712243361425

(PH4) #### Stage 3 ####
(PH4) Running iteration 126 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 126 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 126 ####
(PH4) The total weighted hardening MSE of the iteration curve is 457.4827898800976

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 126 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 626

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 126 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) Searching time by GA: 42.883681774139404s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.06 (target)    |
|     h0     | 824.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 335.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 344.34333803973357

(PH4) #### Stage 3 ####
(PH4) Running iteration 127 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 626

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) Searching time by GA: 53.454641819000244s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.91 (target)    |
|     h0     | 674.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 188.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 344.7767848991216

(PH4) #### Stage 3 ####
(PH4) Running iteration 127 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 126 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 626 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (626, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (626, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 94.6871109008789

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (626, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (626, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 323.87542724609375

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (626, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (626, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 251.2708740234375

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (626, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (626, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 104.76678466796875

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (626, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (626, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 221.1284637451172

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (626, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (626, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 135.45091247558594

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (626, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (626, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 177.783203125

(PH4) The number of combined interpolate curves is 626
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.77244782447815s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) Searching time by GA: 68.32357788085938s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.06 (target)    |
|     h0     | 841.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 333.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 341.79254191087807

(PH4) #### Stage 3 ####
(PH4) Running iteration 127 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) The total weighted hardening MSE of the iteration curve is 449.2625833685085

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 627

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 127 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 127 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 627 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (627, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (627, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 95.50439453125

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (627, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 166.9624481201172

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (627, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 207.4267120361328

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (627, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 139.86959838867188

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (627, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 173.52865600585938

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (627, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 134.51316833496094

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (627, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 143.02500915527344

(PH4) The number of combined interpolate curves is 627
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 26.37012267112732s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 128 ####
(PH4) Searching time by GA: 43.73254632949829s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.68 (target)    |
|     h0     | 428.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 459.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 279.67597608258404

(PH4) #### Stage 3 ####
(PH4) Running iteration 128 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 128 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 127 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 627 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (627, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (627, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 187.1080322265625

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (627, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 208.6900177001953

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (627, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 227.92800903320312

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (627, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 143.41473388671875

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (627, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 167.909912109375

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (627, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 101.55725860595703

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (627, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 139.34429931640625

(PH4) The number of combined interpolate curves is 627
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.10295534133911s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 128 ####
(PH4) Searching time by GA: 54.29071283340454s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.85 (target)    |
|     h0     | 962.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 418.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 337.1587391440013

(PH4) #### Stage 3 ####
(PH4) Running iteration 128 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 128 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 127 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 627 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (627, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (627, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 69.0135269165039

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (627, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 168.5216827392578

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (627, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 233.28981018066406

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (627, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 143.45736694335938

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (627, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 147.7792510986328

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (627, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 110.17705535888672

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (627, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (627, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 148.0180206298828

(PH4) The number of combined interpolate curves is 627
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.945317029953003s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 128 ####
(PH4) Searching time by GA: 60.74999499320984s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     4.9 (target)    |
|     h0     | 1541.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  221.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 388.5556533956315

(PH4) #### Stage 3 ####
(PH4) Running iteration 128 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 128 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 500 initial simulations completed.
(PH4) No additional iteration simulations completed.
(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (500, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 77.1800308227539

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (500, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 263.1025085449219

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (500, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 262.3401184082031

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (500, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 149.33551025390625

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (500, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 218.74569702148438

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 139.00181579589844

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 135.24642944335938

(PH4) The number of combined interpolate curves is 500
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 22.82304072380066s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Searching time by GA: 78.20048189163208s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.94 (target)    |
|     h0     | 580.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 372.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 252.93094778009527

(PH4) #### Stage 3 ####
(PH4) Running iteration 1 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 500 initial simulations completed.
(PH4) No additional iteration simulations completed.
(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (500, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 137.39100646972656

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (500, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 198.4055633544922

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (500, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 290.608154296875

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (500, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 180.5521697998047

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (500, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 210.09072875976562

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 177.64425659179688

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 159.60569763183594

(PH4) The number of combined interpolate curves is 500
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.94106125831604s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Searching time by GA: 54.36339569091797s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.93 (target)    |
|     h0     | 547.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 180.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 318.9189935306424

(PH4) #### Stage 3 ####
(PH4) Running iteration 1 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) The total weighted hardening MSE of the iteration curve is 478.2893947241864

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 501

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Searching time by GA: 56.541375398635864s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.03 (target)    |
|     h0     | 452.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 334.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 313.10309360296736

(PH4) #### Stage 3 ####
(PH4) Running iteration 2 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) The total weighted hardening MSE of the iteration curve is 838.9880759233256

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 502

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 2 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 502 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (502, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (502, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 105.49889373779297

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (502, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 197.03627014160156

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (502, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 262.4584655761719

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (502, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 186.51063537597656

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (502, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 206.762451171875

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (502, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 80.10781860351562

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (502, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 193.56130981445312

(PH4) The number of combined interpolate curves is 502
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.298994302749634s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Searching time by GA: 69.3308584690094s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.64 (target)    |
|     h0     | 646.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 422.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 491.50958941405554

(PH4) #### Stage 3 ####
(PH4) Running iteration 3 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 502


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 2 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 502 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (502, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (502, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 176.43185424804688

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (502, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 330.51470947265625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (502, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 285.98291015625

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (502, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 126.2856216430664

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (502, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 417.7451171875

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (502, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 121.04622650146484

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (502, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 326.5709228515625

(PH4) The number of combined interpolate curves is 502
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.200361967086792s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Searching time by GA: 64.04257559776306s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    8.53 (target)    |
|     h0     | 1011.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  416.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 371.86717781441723

(PH4) #### Stage 3 ####
(PH4) Running iteration 3 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 502

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Searching time by GA: 46.25319004058838s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.01 (target)    |
|     h0     | 360.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 709.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 534.0834744072565

(PH4) #### Stage 3 ####
(PH4) Running iteration 3 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 502


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 2 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 502 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (502, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (502, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 216.32498168945312

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (502, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 382.44952392578125

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (502, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 308.8062744140625

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (502, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 131.7874298095703

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (502, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 168.9796600341797

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (502, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 180.55160522460938

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (502, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (502, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 151.6637420654297

(PH4) The number of combined interpolate curves is 502
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.57650923728943s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Searching time by GA: 28.185004234313965s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.24 (target)    |
|     h0     | 572.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 187.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 123.00026447069713

(PH4) #### Stage 3 ####
(PH4) Running iteration 3 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) The total weighted hardening MSE of the iteration curve is 210.37326012778698

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 503

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Searching time by GA: 36.570695638656616s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.81 (target)    |
|     h0     | 427.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 169.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 157.08402632826022

(PH4) #### Stage 3 ####
(PH4) Running iteration 4 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 503

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Searching time by GA: 33.65499472618103s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   9.46 (target)    |
|     h0     | 481.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 650.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 180.28715499892064

(PH4) #### Stage 3 ####
(PH4) Running iteration 4 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 3 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 503 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (503, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (503, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 117.08152770996094

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (503, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 269.4332275390625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (503, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 130.43115234375

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (503, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 111.52084350585938

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (503, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 211.80923461914062

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (503, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 130.2842559814453

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (503, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 137.39437866210938

(PH4) The number of combined interpolate curves is 503
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.07344365119934s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Searching time by GA: 44.12140440940857s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     6.8 (target)    |
|     h0     | 1915.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  270.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 195.09469081065083

(PH4) #### Stage 3 ####
(PH4) Running iteration 4 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 3 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 503 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (503, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (503, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 136.03233337402344

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (503, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 175.91424560546875

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (503, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 234.96652221679688

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (503, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 187.0443878173828

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (503, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 129.88722229003906

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (503, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 101.34440612792969

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (503, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (503, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 180.8592071533203

(PH4) The number of combined interpolate curves is 503
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.30369257926941s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Searching time by GA: 76.76188683509827s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    7.6 (target)    |
|     h0     | 685.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 460.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 115.05587621601525

(PH4) #### Stage 3 ####
(PH4) Running iteration 4 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) The total weighted hardening MSE of the iteration curve is 220.1238920181316

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 504

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Searching time by GA: 54.74757146835327s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.83 (target)    |
|     h0     | 462.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 374.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 101.34453222063165

(PH4) #### Stage 3 ####
(PH4) Running iteration 5 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) The total weighted hardening MSE of the iteration curve is 302.1461556028001

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 505

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Searching time by GA: 84.95627808570862s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.61 (target)    |
|     h0     | 976.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 116.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 131.7928634022626

(PH4) #### Stage 3 ####
(PH4) Running iteration 6 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) The total weighted hardening MSE of the iteration curve is 279.5844926106918

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 506

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Searching time by GA: 64.23329401016235s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.51 (target)    |
|     h0     | 409.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 429.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 110.02072603446318

(PH4) #### Stage 3 ####
(PH4) Running iteration 7 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) The total weighted hardening MSE of the iteration curve is 257.9741912969425

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 507

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Searching time by GA: 55.135437965393066s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.55 (target)    |
|     h0     | 601.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 331.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 101.48077046603764

(PH4) #### Stage 3 ####
(PH4) Running iteration 8 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) The total weighted hardening MSE of the iteration curve is 240.17061798074894

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 508

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Searching time by GA: 27.955308437347412s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.05 (target)    |
|     h0     | 609.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 176.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 108.45755272617548

(PH4) #### Stage 3 ####
(PH4) Running iteration 9 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) The total weighted hardening MSE of the iteration curve is 221.270658099701

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 509

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Searching time by GA: 59.6279411315918s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.52 (target)    |
|     h0     | 591.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 316.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 124.65686408465474

(PH4) #### Stage 3 ####
(PH4) Running iteration 10 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) The total weighted hardening MSE of the iteration curve is 216.12718167241158

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 510

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Searching time by GA: 30.92552661895752s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.15 (target)    |
|     h0     | 404.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 388.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 114.32368982434376

(PH4) #### Stage 3 ####
(PH4) Running iteration 11 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) The total weighted hardening MSE of the iteration curve is 239.77194533451157

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 511

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Searching time by GA: 52.030229806900024s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.34 (target)    |
|     h0     | 467.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 147.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 154.72182338731415

(PH4) #### Stage 3 ####
(PH4) Running iteration 12 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) The total weighted hardening MSE of the iteration curve is 199.88449918770982

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 512

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Searching time by GA: 72.48138689994812s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.67 (target)    |
|     h0     | 716.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 446.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 118.90531337953253

(PH4) #### Stage 3 ####
(PH4) Running iteration 13 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) The total weighted hardening MSE of the iteration curve is 214.27932288691056

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 513

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Searching time by GA: 86.28744053840637s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.15 (target)    |
|     h0     | 945.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 203.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 105.49185497764675

(PH4) #### Stage 3 ####
(PH4) Running iteration 14 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) The total weighted hardening MSE of the iteration curve is 257.691481850216

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 514

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Searching time by GA: 29.504753589630127s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    4.4 (target)    |
|     h0     | 570.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 314.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 108.463084488636

(PH4) #### Stage 3 ####
(PH4) Running iteration 15 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) The total weighted hardening MSE of the iteration curve is 215.0256854464754

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 515

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Searching time by GA: 85.70928430557251s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.06 (target)    |
|     h0     | 902.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 359.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 136.07925655733254

(PH4) #### Stage 3 ####
(PH4) Running iteration 16 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) The total weighted hardening MSE of the iteration curve is 207.84642430899174

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 516

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Searching time by GA: 57.30224680900574s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     3.9 (target)    |
|     h0     | 1076.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  210.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 137.33353714782865

(PH4) #### Stage 3 ####
(PH4) Running iteration 17 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) The total weighted hardening MSE of the iteration curve is 219.58905628717005

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 517

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Searching time by GA: 68.45587849617004s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.02 (target)    |
|     h0     | 844.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 336.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 110.98674812760251

(PH4) #### Stage 3 ####
(PH4) Running iteration 18 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) The total weighted hardening MSE of the iteration curve is 217.38287397619655

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 518

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Searching time by GA: 85.574871301651s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.43 (target)    |
|     h0     | 776.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 224.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 174.52407537744068

(PH4) #### Stage 3 ####
(PH4) Running iteration 19 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) The total weighted hardening MSE of the iteration curve is 219.32943502252897

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 519

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Searching time by GA: 30.20353078842163s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.97 (target)    |
|     h0     | 774.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 200.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 113.08870221594647

(PH4) #### Stage 3 ####
(PH4) Running iteration 20 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) The total weighted hardening MSE of the iteration curve is 216.0920398890058

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 520

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Searching time by GA: 44.705031633377075s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.91 (target)    |
|     h0     | 898.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 233.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 107.22757000389039

(PH4) #### Stage 3 ####
(PH4) Running iteration 21 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) The total weighted hardening MSE of the iteration curve is 223.71001338560305

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 521

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 21 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 521 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (521, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (521, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 84.28507232666016

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (521, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 230.08229064941406

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (521, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 180.70867919921875

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (521, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 162.7852783203125

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (521, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 178.8282470703125

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (521, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 220.8154296875

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (521, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 211.2585906982422

(PH4) The number of combined interpolate curves is 521
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.3731050491333s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Searching time by GA: 23.95274567604065s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.02 (target)    |
|     h0     | 721.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 317.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 139.9927901816884

(PH4) #### Stage 3 ####
(PH4) Running iteration 22 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) The total weighted hardening MSE of the iteration curve is 223.9800409512144

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 522

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Searching time by GA: 54.37468600273132s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    4.6 (target)    |
|     h0     | 452.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 374.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 137.21966898726893

(PH4) #### Stage 3 ####
(PH4) Running iteration 23 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) The total weighted hardening MSE of the iteration curve is 220.14035985560696

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 523

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Searching time by GA: 54.067620515823364s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.48 (target)    |
|     h0     | 549.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 134.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 140.58056336350387

(PH4) #### Stage 3 ####
(PH4) Running iteration 24 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) The total weighted hardening MSE of the iteration curve is 207.1912646046828

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 524

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Searching time by GA: 74.86624264717102s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.72 (target)    |
|     h0     | 443.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 312.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 119.66110915627144

(PH4) #### Stage 3 ####
(PH4) Running iteration 25 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) The total weighted hardening MSE of the iteration curve is 306.2187041024708

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 525

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Searching time by GA: 35.12859392166138s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   4.43 (target)    |
|     h0     | 560.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 304.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 142.16396872880094

(PH4) #### Stage 3 ####
(PH4) Running iteration 26 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) The total weighted hardening MSE of the iteration curve is 205.38453814822114

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 526

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Searching time by GA: 42.780078649520874s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.68 (target)    |
|     h0     | 818.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 186.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 104.74948663416001

(PH4) #### Stage 3 ####
(PH4) Running iteration 27 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) The total weighted hardening MSE of the iteration curve is 229.59738071206357

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 527

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Searching time by GA: 69.36447787284851s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.98 (target)    |
|     h0     | 608.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 165.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 131.60324954659617

(PH4) #### Stage 3 ####
(PH4) Running iteration 28 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) The total weighted hardening MSE of the iteration curve is 205.42599554834507

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 528

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Searching time by GA: 48.434263467788696s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.88 (target)    |
|     h0     | 995.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 235.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 144.70167464943242

(PH4) #### Stage 3 ####
(PH4) Running iteration 29 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) The total weighted hardening MSE of the iteration curve is 269.90379537349224

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 529

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Searching time by GA: 71.78085589408875s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.57 (target)    |
|     h0     | 915.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 210.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 125.92486478920209

(PH4) #### Stage 3 ####
(PH4) Running iteration 30 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 29 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 529 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (529, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (529, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 100.19567108154297

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (529, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 235.25332641601562

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (529, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 409.4521484375

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (529, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 109.4884262084961

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (529, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 165.09788513183594

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (529, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 110.13282012939453

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (529, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 148.52818298339844

(PH4) The number of combined interpolate curves is 529
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.57273030281067s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Searching time by GA: 54.63949418067932s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.85 (target)    |
|     h0     | 649.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 265.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 150.34008573298894

(PH4) #### Stage 3 ####
(PH4) Running iteration 30 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) The total weighted hardening MSE of the iteration curve is 216.35640266999053

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 530

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Searching time by GA: 24.154123783111572s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    4.5 (target)    |
|     h0     | 558.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 312.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 127.45487334789908

(PH4) #### Stage 3 ####
(PH4) Running iteration 31 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) The total weighted hardening MSE of the iteration curve is 206.81839791866145

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 531

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Searching time by GA: 24.466371297836304s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.89 (target)    |
|     h0     | 709.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 145.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 127.61817080452163

(PH4) #### Stage 3 ####
(PH4) Running iteration 32 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) The total weighted hardening MSE of the iteration curve is 208.6684665222606

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 532

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Searching time by GA: 40.63546133041382s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    3.2 (target)    |
|     h0     | 776.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 217.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 129.6720591222749

(PH4) #### Stage 3 ####
(PH4) Running iteration 33 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) The total weighted hardening MSE of the iteration curve is 229.89162249613963

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 533

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Searching time by GA: 61.68683886528015s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   8.09 (target)    |
|     h0     | 512.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 532.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 144.8698777053571

(PH4) #### Stage 3 ####
(PH4) Running iteration 34 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) The total weighted hardening MSE of the iteration curve is 302.9333308079836

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 534

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Searching time by GA: 23.84234380722046s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    2.65 (target)    |
|     h0     | 1020.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  171.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 104.62501880220783

(PH4) #### Stage 3 ####
(PH4) Running iteration 35 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) The total weighted hardening MSE of the iteration curve is 247.19822945684723

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 535

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 35 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 535 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    7.910956    |
|     h0     | 333.816908 MPa |
|    tau0    |  93.68084 MPa  |
|   tausat   | 719.64032 MPa  |
|    self    |    0.714358    |
|  coplanar  |    0.03902     |
| collinear  |    0.575289    |
| orthogonal |    0.276139    |
|  glissile  |    0.132067    |
|  sessile   |    2.731366    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (535, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (535, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 265.9180908203125

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (535, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 275.08258056640625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (535, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 179.4373016357422

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (535, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 111.1567611694336

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (535, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 199.48565673828125

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (535, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 97.02873992919922

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (535, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 128.3360595703125

(PH4) The number of combined interpolate curves is 535
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 22.878577947616577s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Searching time by GA: 53.41015911102295s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.33 (target)    |
|     h0     | 960.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 286.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 80.16338797682408

(PH4) #### Stage 3 ####
(PH4) Running iteration 36 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) The total weighted hardening MSE of the iteration curve is 150.26780362672724

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 536

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Searching time by GA: 37.73038172721863s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.45 (target)    |
|     h0     | 529.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 522.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 93.21137942919412

(PH4) #### Stage 3 ####
(PH4) Running iteration 37 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) The total weighted hardening MSE of the iteration curve is 154.2601337053361

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 537

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Searching time by GA: 24.61694598197937s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.47 (target)    |
|     h0     | 875.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 211.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 69.86692138880144

(PH4) #### Stage 3 ####
(PH4) Running iteration 38 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) The total weighted hardening MSE of the iteration curve is 148.68534550159916

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 538

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Searching time by GA: 45.57736277580261s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.56 (target)    |
|     h0     | 418.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 171.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 100.87183051871604

(PH4) #### Stage 3 ####
(PH4) Running iteration 39 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) The total weighted hardening MSE of the iteration curve is 145.12701635573586

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 539

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Searching time by GA: 51.151207447052s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    6.1 (target)    |
|     h0     | 696.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 369.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 82.01820068083461

(PH4) #### Stage 3 ####
(PH4) Running iteration 40 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) The total weighted hardening MSE of the iteration curve is 147.97969939686402

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 540

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Searching time by GA: 64.19445657730103s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.29 (target)    |
|     h0     | 566.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 368.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 114.23658784497088

(PH4) #### Stage 3 ####
(PH4) Running iteration 41 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) The total weighted hardening MSE of the iteration curve is 150.52809494592987

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 541

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Searching time by GA: 48.618223667144775s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.32 (target)    |
|     h0     | 924.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 302.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 70.39939082426979

(PH4) #### Stage 3 ####
(PH4) Running iteration 42 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) The total weighted hardening MSE of the iteration curve is 161.4885980442652

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 542

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Searching time by GA: 82.99018836021423s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   8.06 (target)    |
|     h0     | 743.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 450.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 109.12638793093839

(PH4) #### Stage 3 ####
(PH4) Running iteration 43 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) The total weighted hardening MSE of the iteration curve is 147.30657416885725

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 543

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 43 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 543 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+---------------+
| Parameter  |     Value     |
+------------+---------------+
|     a      |    6.68635    |
|     h0     | 976.33817 MPa |
|    tau0    |  43.10955 MPa |
|   tausat   | 360.81991 MPa |
|    self    |    0.32517    |
|  coplanar  |     0.9835    |
| collinear  |    8.27915    |
| orthogonal |    0.89645    |
|  glissile  |    0.87494    |
|  sessile   |    0.86294    |
+------------+---------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (543, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (543, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 80.9063720703125

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (543, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (543, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 195.75201416015625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (543, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (543, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 207.23162841796875

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (543, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (543, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 137.98793029785156

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (543, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (543, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 169.9114227294922

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (543, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (543, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 134.55914306640625

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (543, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (543, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 178.1933135986328

(PH4) The number of combined interpolate curves is 543
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 27.202796697616577s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Searching time by GA: 64.98059678077698s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |     1.3 (target)    |
|     h0     | 1166.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  72.0 MPa (target)  |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 34.302557991816656

(PH4) #### Stage 3 ####
(PH4) Running iteration 44 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 543

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Searching time by GA: 64.53546214103699s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   7.67 (target)    |
|     h0     | 511.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 559.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 62.35528750161151

(PH4) #### Stage 3 ####
(PH4) Running iteration 44 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) The total weighted hardening MSE of the iteration curve is 68.51133176901448

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 544

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Searching time by GA: 27.242465257644653s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    3.81 (target)    |
|     h0     | 1146.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  211.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 46.29367593817678

(PH4) #### Stage 3 ####
(PH4) Running iteration 45 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) The total weighted hardening MSE of the iteration curve is 42.9101737422994

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 545

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Searching time by GA: 28.716471195220947s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.79 (target)    |
|     h0     | 955.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 143.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 37.52781591371087

(PH4) #### Stage 3 ####
(PH4) Running iteration 46 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) The total weighted hardening MSE of the iteration curve is 46.7237676466158

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 546

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Searching time by GA: 55.97346305847168s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   3.52 (target)    |
|     h0     | 774.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 227.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 53.26305526824606

(PH4) #### Stage 3 ####
(PH4) Running iteration 47 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) The total weighted hardening MSE of the iteration curve is 44.07948833781916

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 547

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Searching time by GA: 30.624728679656982s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    6.7 (target)    |
|     h0     | 513.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 495.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 58.78189560944508

(PH4) #### Stage 3 ####
(PH4) Running iteration 48 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) The total weighted hardening MSE of the iteration curve is 67.33153184255181

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 548

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Searching time by GA: 60.45172929763794s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    9.93 (target)    |
|     h0     | 1120.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  448.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 27.257707449489015

(PH4) #### Stage 3 ####
(PH4) Running iteration 49 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) The total weighted hardening MSE of the iteration curve is 49.77777071606671

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 549

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Searching time by GA: 46.651936292648315s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |    2.8 (target)    |
|     h0     | 776.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 211.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 39.010798598547844

(PH4) #### Stage 3 ####
(PH4) Running iteration 50 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) The total weighted hardening MSE of the iteration curve is 60.27599221654585

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 550

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Searching time by GA: 46.78489136695862s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   8.26 (target)    |
|     h0     | 613.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 557.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 68.25628309073429

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 550

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Searching time by GA: 73.90891909599304s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    8.38 (target)    |
|     h0     | 1170.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  392.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 65.81845373057394

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     4.5%    |
|   Small linear hardening dev  |      4%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     6.5%    |
| Small nonlinear hardening dev |      6%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 50 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 550 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+---------------+
| Parameter  |     Value     |
+------------+---------------+
|     a      |    6.68635    |
|     h0     | 976.33817 MPa |
|    tau0    |  43.10955 MPa |
|   tausat   | 360.81991 MPa |
|    self    |    0.32517    |
|  coplanar  |     0.9835    |
| collinear  |    8.27915    |
| orthogonal |    0.89645    |
|  glissile  |    0.87494    |
|  sessile   |    0.86294    |
+------------+---------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (550, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (550, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 94.71260070800781

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (550, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 186.22238159179688

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (550, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 199.93910217285156

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (550, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 153.2012176513672

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (550, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 253.26866149902344

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (550, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 134.4937744140625

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (550, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 167.55845642089844

(PH4) The number of combined interpolate curves is 550
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.77781391143799s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Searching time by GA: 84.74037146568298s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.17 (target)    |
|     h0     | 544.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 433.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 53.7034080733755

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) The total weighted hardening MSE of the iteration curve is 63.629413475644405

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 551

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Searching time by GA: 87.41874504089355s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.32 (target)    |
|     h0     | 583.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 198.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 46.29553905806445

(PH4) #### Stage 3 ####
(PH4) Running iteration 52 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) The total weighted hardening MSE of the iteration curve is 47.01335473717481

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 552

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Searching time by GA: 56.94555330276489s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   5.53 (target)    |
|     h0     | 443.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 490.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 46.489293026433984

(PH4) #### Stage 3 ####
(PH4) Running iteration 53 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) The total weighted hardening MSE of the iteration curve is 82.54692494148804

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 553

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Searching time by GA: 78.76388168334961s

(PH4) The best candidate parameters found by GA
+------------+---------------------+
| Parameter  |        Value        |
+------------+---------------------+
|     a      |    9.12 (target)    |
|     h0     | 1580.0 MPa (target) |
|    tau0    |       54.0 MPa      |
|   tausat   |  367.0 MPa (target) |
|    self    |       0.967484      |
|  coplanar  |       1.624813      |
| collinear  |       5.07754       |
| orthogonal |       0.872437      |
|  glissile  |       0.247625      |
|  sessile   |       2.332166      |
+------------+---------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 67.54507453416227

(PH4) #### Stage 3 ####
(PH4) Running iteration 54 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) The total weighted hardening MSE of the iteration curve is 49.22896016791518

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 554

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Searching time by GA: 45.17784237861633s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.12 (target)    |
|     h0     | 696.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 170.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 35.424461276877125

(PH4) #### Stage 3 ####
(PH4) Running iteration 55 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) The total weighted hardening MSE of the iteration curve is 38.45505110625632

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 555

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 55
(PH4) The third stage parameter solution is:
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.12 (target)    |
|     h0     | 696.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 170.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) Third optimization stage finished

(PH4) **********************************************************************
(PH4) Fourth optimization stage: Optimize the small hardening parameters for the curve PH4

(PH4) #### Stage 4 ####
(PH4) Optimizing the parameters self, coplanar, collinear, orthogonal, glissile, sessile
(PH4) Fourth optimization stage starts

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Searching time by GA: 39.85486173629761s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.392 (target) |
|  coplanar  | 1.683 (target) |
| collinear  |  1.5 (target)  |
| orthogonal | 0.75 (target)  |
|  glissile  | 1.765 (target) |
|  sessile   | 1.257 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 30.737183216616618

(PH4) #### Stage 4 ####
(PH4) Running iteration 56 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) The total weighted hardening MSE of the iteration curve is 58.85819684783192

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 556

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Searching time by GA: 87.51519465446472s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.717 (target) |
|  coplanar  | 1.847 (target) |
| collinear  | 0.17 (target)  |
| orthogonal | 0.978 (target) |
|  glissile  | 0.906 (target) |
|  sessile   | 1.174 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 42.12551128833912

(PH4) #### Stage 4 ####
(PH4) Running iteration 57 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) The total weighted hardening MSE of the iteration curve is 37.7227506231698

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 557

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Searching time by GA: 83.28399610519409s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    |  1.4 (target)  |
|  coplanar  | 0.87 (target)  |
| collinear  | 3.34 (target)  |
| orthogonal | 0.804 (target) |
|  glissile  | 1.328 (target) |
|  sessile   | 2.843 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 33.27120155244033

(PH4) #### Stage 4 ####
(PH4) Running iteration 58 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) The total weighted hardening MSE of the iteration curve is 82.78548613748615

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 558

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Searching time by GA: 88.26832056045532s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.962 (target) |
|  coplanar  | 0.808 (target) |
| collinear  | 1.66 (target)  |
| orthogonal | 1.674 (target) |
|  glissile  | 0.467 (target) |
|  sessile   | 0.012 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 21.194693547670017

(PH4) #### Stage 4 ####
(PH4) Running iteration 59 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) The total weighted hardening MSE of the iteration curve is 54.713580023873554

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 559

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Searching time by GA: 88.23999810218811s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.569 (target) |
|  coplanar  | 0.993 (target) |
| collinear  | 0.72 (target)  |
| orthogonal | 1.549 (target) |
|  glissile  | 1.86 (target)  |
|  sessile   | 0.703 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 21.447866397676673

(PH4) #### Stage 4 ####
(PH4) Running iteration 60 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) The total weighted hardening MSE of the iteration curve is 48.16344021934234

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 560

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Searching time by GA: 50.916560888290405s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.902 (target) |
|  coplanar  | 1.297 (target) |
| collinear  | 0.35 (target)  |
| orthogonal | 1.003 (target) |
|  glissile  | 1.408 (target) |
|  sessile   | 2.044 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 31.535505209691742

(PH4) #### Stage 4 ####
(PH4) Running iteration 61 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) The total weighted hardening MSE of the iteration curve is 31.40908723024807

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 561

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Searching time by GA: 89.96946358680725s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.974 (target) |
|  coplanar  | 0.142 (target) |
| collinear  |  0.1 (target)  |
| orthogonal | 0.915 (target) |
|  glissile  | 1.576 (target) |
|  sessile   | 1.295 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 40.44656878810636

(PH4) #### Stage 4 ####
(PH4) Running iteration 62 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) The total weighted hardening MSE of the iteration curve is 38.199979757483774

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 562

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Searching time by GA: 89.82921552658081s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.68 (target)  |
|  coplanar  | 0.324 (target) |
| collinear  | 5.08 (target)  |
| orthogonal | 1.876 (target) |
|  glissile  | 1.27 (target)  |
|  sessile   | 0.006 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 23.867259312958055

(PH4) #### Stage 4 ####
(PH4) Running iteration 63 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) The total weighted hardening MSE of the iteration curve is 35.835285532351

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 563

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Searching time by GA: 77.21956205368042s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.596 (target) |
|  coplanar  | 1.999 (target) |
| collinear  | 2.49 (target)  |
| orthogonal | 1.157 (target) |
|  glissile  | 0.699 (target) |
|  sessile   | 1.789 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 27.040290263135105

(PH4) #### Stage 4 ####
(PH4) Running iteration 64 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) The total weighted hardening MSE of the iteration curve is 27.73251473376652

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 564

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Searching time by GA: 79.95921683311462s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.487 (target) |
|  coplanar  | 1.297 (target) |
| collinear  | 2.82 (target)  |
| orthogonal | 1.983 (target) |
|  glissile  | 0.236 (target) |
|  sessile   | 1.748 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 32.93631016003469

(PH4) #### Stage 4 ####
(PH4) Running iteration 65 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) The total weighted hardening MSE of the iteration curve is 42.55574051302128

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 565

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Searching time by GA: 57.02619504928589s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.421 (target) |
|  coplanar  | 1.837 (target) |
| collinear  | 0.23 (target)  |
| orthogonal | 1.582 (target) |
|  glissile  | 0.857 (target) |
|  sessile   | 1.328 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 35.2138631449724

(PH4) #### Stage 4 ####
(PH4) Running iteration 66 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) The total weighted hardening MSE of the iteration curve is 30.878537987845903

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 566

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Searching time by GA: 40.04910850524902s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.728 (target) |
|  coplanar  | 0.796 (target) |
| collinear  | 3.25 (target)  |
| orthogonal | 1.902 (target) |
|  glissile  | 0.871 (target) |
|  sessile   | 0.371 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 42.161924294367445

(PH4) #### Stage 4 ####
(PH4) Running iteration 67 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     4.5%    |
|   Small linear hardening dev  |      4%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     6.5%    |
| Small nonlinear hardening dev |      6%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 66 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 566 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+---------------+
| Parameter  |     Value     |
+------------+---------------+
|     a      |    6.68635    |
|     h0     | 976.33817 MPa |
|    tau0    |  43.10955 MPa |
|   tausat   | 360.81991 MPa |
|    self    |    0.32517    |
|  coplanar  |     0.9835    |
| collinear  |    8.27915    |
| orthogonal |    0.89645    |
|  glissile  |    0.87494    |
|  sessile   |    0.86294    |
+------------+---------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (566, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (566, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 153.44114685058594

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (566, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 669.0081176757812

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (566, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 239.71548461914062

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (566, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 153.103515625

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (566, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 222.9929656982422

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (566, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 133.26112365722656

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (566, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 139.07305908203125

(PH4) The number of combined interpolate curves is 566
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.25790762901306s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) The file stage3_curves.npy detected, which means the third stage has finished
(PH4) Third optimization stage finished

(PH4) The current result parameters
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.12 (target)    |
|     h0     | 696.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 170.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) **********************************************************************
(PH4) Fourth optimization stage: Optimize the small hardening parameters for the curve PH4

(PH4) #### Stage 4 ####
(PH4) Optimizing the parameters self, coplanar, collinear, orthogonal, glissile, sessile
(PH4) Fourth optimization stage starts

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Searching time by GA: 84.63694167137146s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.366 (target) |
|  coplanar  | 1.755 (target) |
| collinear  |  9.8 (target)  |
| orthogonal | 1.237 (target) |
|  glissile  | 0.414 (target) |
|  sessile   | 1.945 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 32.87868293424038

(PH4) #### Stage 4 ####
(PH4) Running iteration 67 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) The total weighted hardening MSE of the iteration curve is 38.15278680861996

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 567

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Searching time by GA: 74.23144221305847s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.769 (target) |
|  coplanar  | 0.999 (target) |
| collinear  | 0.37 (target)  |
| orthogonal | 1.586 (target) |
|  glissile  | 1.361 (target) |
|  sessile   | 1.402 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 19.961034528898374

(PH4) #### Stage 4 ####
(PH4) Running iteration 68 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) The total weighted hardening MSE of the iteration curve is 23.565137266849124

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 568

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Searching time by GA: 83.34333848953247s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.576 (target) |
|  coplanar  | 0.365 (target) |
| collinear  | 0.63 (target)  |
| orthogonal | 1.729 (target) |
|  glissile  | 1.363 (target) |
|  sessile   | 2.211 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 21.65297788961378

(PH4) #### Stage 4 ####
(PH4) Running iteration 69 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) The total weighted hardening MSE of the iteration curve is 54.28462049707895

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 569

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Searching time by GA: 56.69922184944153s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.43 (target)  |
|  coplanar  | 1.65 (target)  |
| collinear  | 16.9 (target)  |
| orthogonal | 0.556 (target) |
|  glissile  | 0.682 (target) |
|  sessile   | 1.978 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 29.139049310248378

(PH4) #### Stage 4 ####
(PH4) Running iteration 70 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) The total weighted hardening MSE of the iteration curve is 40.31858558879011

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 570

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Searching time by GA: 83.71002078056335s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.69 (target)  |
|  coplanar  | 1.302 (target) |
| collinear  | 11.85 (target) |
| orthogonal | 0.891 (target) |
|  glissile  | 0.573 (target) |
|  sessile   | 0.261 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 32.0813160676057

(PH4) #### Stage 4 ####
(PH4) Running iteration 71 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) The total weighted hardening MSE of the iteration curve is 29.37904860807408

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 571

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Searching time by GA: 52.85941672325134s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.764 (target) |
|  coplanar  | 0.971 (target) |
| collinear  | 15.53 (target) |
| orthogonal | 1.192 (target) |
|  glissile  | 1.045 (target) |
|  sessile   | 1.771 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 34.52467505130772

(PH4) #### Stage 4 ####
(PH4) Running iteration 72 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) The total weighted hardening MSE of the iteration curve is 89.82493876170251

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 572

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Searching time by GA: 83.46090149879456s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.539 (target) |
|  coplanar  | 1.438 (target) |
| collinear  | 9.23 (target)  |
| orthogonal | 0.327 (target) |
|  glissile  | 0.985 (target) |
|  sessile   | 0.516 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 21.859558746832143

(PH4) #### Stage 4 ####
(PH4) Running iteration 73 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) The total weighted hardening MSE of the iteration curve is 27.999620161073427

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 573

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Searching time by GA: 83.21411776542664s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.417 (target) |
|  coplanar  | 1.297 (target) |
| collinear  | 1.22 (target)  |
| orthogonal | 1.358 (target) |
|  glissile  | 1.46 (target)  |
|  sessile   | 0.975 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 25.978107755059042

(PH4) #### Stage 4 ####
(PH4) Running iteration 74 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) The total weighted hardening MSE of the iteration curve is 27.909820855193747

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 574

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD
nonlinear_planestrain_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Searching time by GA: 80.165198802948s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.685 (target) |
|  coplanar  | 1.094 (target) |
| collinear  | 14.31 (target) |
| orthogonal | 1.666 (target) |
|  glissile  | 0.369 (target) |
|  sessile   | 1.715 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 25.26551587282902

(PH4) #### Stage 4 ####
(PH4) Running iteration 75 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) The total weighted hardening MSE of the iteration curve is 39.90929924283829

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 575

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Searching time by GA: 38.74440312385559s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.071 (target) |
|  coplanar  | 1.318 (target) |
| collinear  | 1.32 (target)  |
| orthogonal | 0.531 (target) |
|  glissile  | 1.984 (target) |
|  sessile   | 0.086 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 26.22717804043217

(PH4) #### Stage 4 ####
(PH4) Running iteration 76 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) The total weighted hardening MSE of the iteration curve is 24.02527440321395

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 576

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD
nonlinear_planestrain_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Searching time by GA: 85.71523261070251s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.354 (target) |
|  coplanar  | 1.359 (target) |
| collinear  |  0.7 (target)  |
| orthogonal | 0.925 (target) |
|  glissile  | 1.844 (target) |
|  sessile   | 0.157 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 18.5031735479146

(PH4) #### Stage 4 ####
(PH4) Running iteration 77 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) The total weighted hardening MSE of the iteration curve is 27.191144810405113

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 577

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Searching time by GA: 86.35559678077698s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.458 (target) |
|  coplanar  | 1.367 (target) |
| collinear  | 0.33 (target)  |
| orthogonal | 1.997 (target) |
|  glissile  | 0.732 (target) |
|  sessile   | 1.983 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 34.8363950236515

(PH4) #### Stage 4 ####
(PH4) Running iteration 78 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) The total weighted hardening MSE of the iteration curve is 43.91997850916784

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 578

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Searching time by GA: 60.74652099609375s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.522 (target) |
|  coplanar  | 1.606 (target) |
| collinear  | 1.23 (target)  |
| orthogonal | 0.702 (target) |
|  glissile  | 0.946 (target) |
|  sessile   | 0.573 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 29.551704490541887

(PH4) #### Stage 4 ####
(PH4) Running iteration 79 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) The total weighted hardening MSE of the iteration curve is 42.412509787193535

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 579

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Searching time by GA: 71.8977882862091s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.043 (target) |
|  coplanar  | 1.262 (target) |
| collinear  | 23.68 (target) |
| orthogonal | 0.713 (target) |
|  glissile  | 0.106 (target) |
|  sessile   | 0.419 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.415524856338145

(PH4) #### Stage 4 ####
(PH4) Running iteration 80 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) The total weighted hardening MSE of the iteration curve is 45.810850446470305

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 580

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     4.5%    |
|   Small linear hardening dev  |      4%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     6.5%    |
| Small nonlinear hardening dev |      6%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 80 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 580 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+---------------+
| Parameter  |     Value     |
+------------+---------------+
|     a      |    6.68635    |
|     h0     | 976.33817 MPa |
|    tau0    |  43.10955 MPa |
|   tausat   | 360.81991 MPa |
|    self    |    0.32517    |
|  coplanar  |     0.9835    |
| collinear  |    8.27915    |
| orthogonal |    0.89645    |
|  glissile  |    0.87494    |
|  sessile   |    0.86294    |
+------------+---------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (580, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (580, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 118.36578369140625

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (580, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (580, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 185.47320556640625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (580, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (580, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 252.63731384277344

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (580, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (580, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 155.088623046875

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (580, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (580, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 190.77688598632812

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (580, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (580, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 132.63160705566406

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (580, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (580, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 150.0785675048828

(PH4) The number of combined interpolate curves is 580
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.454578161239624s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 54.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    54.0 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) The file stage3_curves.npy detected, which means the third stage has finished
(PH4) Third optimization stage finished

(PH4) The current result parameters
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   2.12 (target)    |
|     h0     | 696.0 MPa (target) |
|    tau0    |      54.0 MPa      |
|   tausat   | 170.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) **********************************************************************
(PH4) Fourth optimization stage: Optimize the small hardening parameters for the curve PH4

(PH4) #### Stage 4 ####
(PH4) Optimizing the parameters self, coplanar, collinear, orthogonal, glissile, sessile
(PH4) Fourth optimization stage starts

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Searching time by GA: 84.46783947944641s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.877 (target) |
|  coplanar  | 1.047 (target) |
| collinear  | 6.14 (target)  |
| orthogonal | 1.739 (target) |
|  glissile  | 0.391 (target) |
|  sessile   | 1.502 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 33.455054377427885

(PH4) #### Stage 4 ####
(PH4) Running iteration 81 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) The total weighted hardening MSE of the iteration curve is 31.678746652598473

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 581

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Searching time by GA: 37.94425129890442s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.541 (target) |
|  coplanar  | 0.286 (target) |
| collinear  | 0.63 (target)  |
| orthogonal | 1.125 (target) |
|  glissile  | 1.618 (target) |
|  sessile   | 0.088 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 35.391435929280355

(PH4) #### Stage 4 ####
(PH4) Running iteration 82 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) The total weighted hardening MSE of the iteration curve is 24.02204713416984

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 582

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Searching time by GA: 84.85145854949951s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.151 (target) |
|  coplanar  | 1.693 (target) |
| collinear  | 10.95 (target) |
| orthogonal | 1.946 (target) |
|  glissile  | 0.186 (target) |
|  sessile   | 1.776 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 19.139479031711144

(PH4) #### Stage 4 ####
(PH4) Running iteration 83 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) The total weighted hardening MSE of the iteration curve is 64.66118552711472

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 583

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Searching time by GA: 46.07349681854248s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 0.626 (target) |
|  coplanar  | 1.223 (target) |
| collinear  | 3.37 (target)  |
| orthogonal | 0.908 (target) |
|  glissile  | 1.032 (target) |
|  sessile   | 1.902 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 37.529326867507905

(PH4) #### Stage 4 ####
(PH4) Running iteration 84 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) The total weighted hardening MSE of the iteration curve is 30.61382189223108

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 584

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Searching time by GA: 84.28794956207275s

(PH4) The best candidate parameters found by GA
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.143 (target) |
|  coplanar  | 0.266 (target) |
| collinear  | 0.17 (target)  |
| orthogonal | 0.652 (target) |
|  glissile  | 2.292 (target) |
|  sessile   | 0.533 (target) |
+------------+----------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 19.95558947959972

(PH4) #### Stage 4 ####
(PH4) Running iteration 85 simulation

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) The total weighted hardening MSE of the iteration curve is 22.28353410977453

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 585

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 85
(PH4) The fourth stage parameter solution is:
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |      2.12      |
|     h0     |   696.0 MPa    |
|    tau0    |    54.0 MPa    |
|   tausat   |   170.0 MPa    |
|    self    | 1.143 (target) |
|  coplanar  | 0.266 (target) |
| collinear  | 0.17 (target)  |
| orthogonal | 0.652 (target) |
|  glissile  | 2.292 (target) |
|  sessile   | 0.533 (target) |
+------------+----------------+
(PH4) Fourth optimization stage finished

(PH4) All four optimization stages have successfully completed for curve PH4
(PH4) The final optimized set of parameters is:
+------------+-----------+
| Parameter  |   Value   |
+------------+-----------+
|     a      |    2.12   |
|     h0     | 696.0 MPa |
|    tau0    |  54.0 MPa |
|   tausat   | 170.0 MPa |
|    self    |   1.143   |
|  coplanar  |   0.266   |
| collinear  |    0.17   |
| orthogonal |   0.652   |
|  glissile  |   2.292   |
|  sessile   |   0.533   |
+------------+-----------+
(PH4) Optimization for curve PH4 has finished
(PH4) Waiting for other curves to finish their optimization


======================================================================
Fitting parameter optimization for all target curves completed
Congratulations! Thank you for using the Crystal Plasticity Software

Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |   discrete  |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |      GA     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     4.5%    |
|   Small linear hardening dev  |      4%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     6.5%    |
| Small nonlinear hardening dev |      6%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_GA_discrete

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 85 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 585 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) The file default_curves.npy exists. Loading the default curves
(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (585, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (585, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 109.49646759033203

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (585, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (585, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 186.9866485595703

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (585, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (585, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 214.12216186523438

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (585, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (585, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 122.23727416992188

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (585, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (585, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 198.11471557617188

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (585, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (585, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 146.7024383544922

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (585, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (585, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 107.2380142211914

(PH4) The number of combined interpolate curves is 585
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.39326238632202s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Genetic Algorithm
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) Optimizing the parameters tau0
(PH4) First optimization stage starts

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Searching time by GA: 5.624417781829834s

(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 53.0 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.467622577247587

(PH4) #### Stage 1 ####
(PH4) Running iteration 86 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) The total weighted yielding MSE of the iteration curve is 1836.5267278209737

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 586

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Searching time by GA: 7.193889379501343s

(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 56.3 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.31971854392082844

(PH4) #### Stage 1 ####
(PH4) Running iteration 87 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) The total weighted yielding MSE of the iteration curve is 822.0970253036386

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 587

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Searching time by GA: 7.266427040100098s

(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 56.2 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.05951976886089244

(PH4) #### Stage 1 ####
(PH4) Running iteration 88 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) The total weighted yielding MSE of the iteration curve is 819.0857247857515

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 588

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Searching time by GA: 4.761291980743408s

(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 55.2 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.1463544793491952

(PH4) #### Stage 1 ####
(PH4) Running iteration 89 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) The total weighted yielding MSE of the iteration curve is 789.3660844923108

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 589

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Searching time by GA: 4.7077317237854s

(PH4) The best candidate parameters found by GA
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 53.9 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.20725688180765964

(PH4) #### Stage 1 ####
(PH4) Running iteration 90 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) The total weighted yielding MSE of the iteration curve is 751.8866043756065

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 590

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 90
(PH4) The first stage parameter solution is:
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      6.434218     |
|     h0     |   324.312156 MPa  |
|    tau0    | 53.9 MPa (target) |
|   tausat   |   784.607804 MPa  |
|    self    |      0.967484     |
|  coplanar  |      1.624813     |
| collinear  |      5.07754      |
| orthogonal |      0.872437     |
|  glissile  |      0.247625     |
|  sessile   |      2.332166     |
+------------+-------------------+
(PH4) First optimization stage finished

(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |    53.9 MPa    |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Searching time by GA: 43.673462867736816s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   6.92 (target)    |
|     h0     | 604.0 MPa (target) |
|    tau0    |      53.9 MPa      |
|   tausat   | 471.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 58.71914667651273

(PH4) #### Stage 3 ####
(PH4) Running iteration 91 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) The total weighted hardening MSE of the iteration curve is 61.49281660411542

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 591

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Searching time by GA: 71.36146545410156s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.51 (target)    |
|     h0     | 896.0 MPa (target) |
|    tau0    |      53.9 MPa      |
|   tausat   | 121.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 33.79685463427113

(PH4) #### Stage 3 ####
(PH4) Running iteration 92 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) The total weighted hardening MSE of the iteration curve is 70.49857480393271

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 592

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Searching time by GA: 74.86789965629578s

(PH4) The best candidate parameters found by GA
+------------+--------------------+
| Parameter  |       Value        |
+------------+--------------------+
|     a      |   1.71 (target)    |
|     h0     | 486.0 MPa (target) |
|    tau0    |      53.9 MPa      |
|   tausat   | 180.0 MPa (target) |
|    self    |      0.967484      |
|  coplanar  |      1.624813      |
| collinear  |      5.07754       |
| orthogonal |      0.872437      |
|  glissile  |      0.247625      |
|  sessile   |      2.332166      |
+------------+--------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 68.05162901655228

(PH4) #### Stage 3 ####
(PH4) Running iteration 93 simulation

