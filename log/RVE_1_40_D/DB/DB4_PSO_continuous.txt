
Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 43 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 543 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 255.177 MPa  |  [251.349, 259.005] MPa |  [252.625, 257.729 MPa] |
|   nonlinear_biaxial_TD   | 255.177 MPa  |  [251.349, 259.005] MPa |  [252.625, 257.729 MPa] |
| nonlinear_planestrain_RD | 239.628 MPa  |  [236.034, 243.223] MPa |  [237.232, 242.025 MPa] |
| nonlinear_planestrain_TD | 239.628 MPa  |  [236.034, 243.223] MPa |  [237.232, 242.025 MPa] |
|  nonlinear_uniaxial_RD   | 213.867 MPa  |  [210.659, 217.075] MPa |  [211.728, 216.005 MPa] |
|  nonlinear_uniaxial_TD   | 213.867 MPa  |  [210.659, 217.075] MPa |  [211.728, 216.005 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (543, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (543, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 113.31493377685547

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (543, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (543, 9)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 677.1142578125

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (543, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (543, 8)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 283.589111328125

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (543, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (543, 14)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 358.0918884277344

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (543, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (543, 12)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 143.25662231445312

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (543, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (543, 20)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 138.67604064941406

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (543, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (543, 15)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 106.01628875732422

(DB4) The number of combined interpolate curves is 543
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.172777891159058s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |         0.02352          |
|     q     |         1.04452          |
|   tausol  | 107.25628e6 MPa (target) |
|     Qs    |  7.69501e-19 J (target)  |
|     Qc    |       1.9904e-19 J       |
|     v0    |     65.97649e-5 m/s      |
|   rho_e   | 2.51152e12 m⁻² (target)  |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) Optimizing the parameters p, q, v0
(DB4) Second optimization stage starts

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 44 ####
(DB4) Searching time by PSO: 4.7513885498046875s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.08854 (target)     |
|     q     |     1.89191 (target)     |
|   tausol  |     107.25628e6 MPa      |
|     Qs    |      7.69501e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 62.33608e-5 m/s (target) |
|   rho_e   |      2.51152e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 5.888436435701744

(DB4) #### Stage 2 ####
(DB4) Running iteration 44 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 44 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 44 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2552.56397733803

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 44 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 544

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 44 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 45 ####
(DB4) Searching time by PSO: 4.719990015029907s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.1086 (target)      |
|     q     |     1.92762 (target)     |
|   tausol  |     107.25628e6 MPa      |
|     Qs    |      7.69501e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 86.33636e-5 m/s (target) |
|   rho_e   |      2.51152e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 4.526119843861968

(DB4) #### Stage 2 ####
(DB4) Running iteration 45 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 500 initial simulations completed.
(DB4) No additional iteration simulations completed.
(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 255.177 MPa  |  [251.349, 259.005] MPa |  [252.625, 257.729 MPa] |
|   nonlinear_biaxial_TD   | 255.177 MPa  |  [251.349, 259.005] MPa |  [252.625, 257.729 MPa] |
| nonlinear_planestrain_RD | 239.628 MPa  |  [236.034, 243.223] MPa |  [237.232, 242.025 MPa] |
| nonlinear_planestrain_TD | 239.628 MPa  |  [236.034, 243.223] MPa |  [237.232, 242.025 MPa] |
|  nonlinear_uniaxial_RD   | 213.867 MPa  |  [210.659, 217.075] MPa |  [211.728, 216.005 MPa] |
|  nonlinear_uniaxial_TD   | 213.867 MPa  |  [210.659, 217.075] MPa |  [211.728, 216.005 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (500, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 130.12425231933594

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (500, 9)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 256.3612365722656

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (500, 8)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 401.74462890625

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (500, 14)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 160.65345764160156

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (500, 12)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 228.41900634765625

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 156.24957275390625

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 15)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 217.26023864746094

(DB4) The number of combined interpolate curves is 500
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 22.727274894714355s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) Optimizing the parameters tausol, Qs, rho_e
(DB4) First optimization stage starts

(DB4) #### Stage 1 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 1 ####
(DB4) Searching time by PSO: 4.722219705581665s

(DB4) The best candidate parameters found by PSO
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 63.03396e6 MPa (target) |
|     Qs    |  5.14819e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 3.94733e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 4.646474477566206

(DB4) #### Stage 1 ####
(DB4) Running iteration 1 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 500 initial simulations completed.
(DB4) No additional iteration simulations completed.
(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 255.177 MPa  |  [251.349, 259.005] MPa |  [252.625, 257.729 MPa] |
|   nonlinear_biaxial_TD   | 255.177 MPa  |  [251.349, 259.005] MPa |  [252.625, 257.729 MPa] |
| nonlinear_planestrain_RD | 239.628 MPa  |  [236.034, 243.223] MPa |  [237.232, 242.025 MPa] |
| nonlinear_planestrain_TD | 239.628 MPa  |  [236.034, 243.223] MPa |  [237.232, 242.025 MPa] |
|  nonlinear_uniaxial_RD   | 213.867 MPa  |  [210.659, 217.075] MPa |  [211.728, 216.005 MPa] |
|  nonlinear_uniaxial_TD   | 213.867 MPa  |  [210.659, 217.075] MPa |  [211.728, 216.005 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (500, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 229.97537231445312

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (500, 9)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 983.3099975585938

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (500, 8)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 2107.9931640625

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (500, 14)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 225.3771209716797

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (500, 12)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 853.2998046875

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 129.59666442871094

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 15)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 217.70326232910156

(DB4) The number of combined interpolate curves is 500
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 22.59523320198059s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) Optimizing the parameters tausol, Qs, rho_e
(DB4) First optimization stage starts

(DB4) #### Stage 1 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 1 ####
(DB4) Searching time by PSO: 4.589719533920288s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |         0.02352          |
|     q     |         1.04452          |
|   tausol  | 111.47834e6 MPa (target) |
|     Qs    |  6.5991e-19 J (target)   |
|     Qc    |       1.9904e-19 J       |
|     v0    |     65.97649e-5 m/s      |
|   rho_e   | 1.01927e12 m⁻² (target)  |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.7591468997239283

(DB4) #### Stage 1 ####
(DB4) Running iteration 1 simulation

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 1 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 1 ####
(DB4) The total weighted yielding MSE of the iteration curve is 4303.799149250521

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 1 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 501

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 1 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 1 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 2 ####
(DB4) Searching time by PSO: 4.620533227920532s

(DB4) The best candidate parameters found by PSO
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 42.18133e6 MPa (target) |
|     Qs    |  7.81805e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.93838e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.07658285685992401

(DB4) #### Stage 1 ####
(DB4) Running iteration 2 simulation

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 2 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 2 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1919.7158393775178

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 2 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 502

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 2 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 1 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 3 ####
(DB4) Searching time by PSO: 4.696398973464966s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |         0.02352          |
|     q     |         1.04452          |
|   tausol  | 153.22839e6 MPa (target) |
|     Qs    |  8.25766e-19 J (target)  |
|     Qc    |       1.9904e-19 J       |
|     v0    |     65.97649e-5 m/s      |
|   rho_e   | 2.13768e12 m⁻² (target)  |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 3.0328327845664873

(DB4) #### Stage 1 ####
(DB4) Running iteration 3 simulation

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 3 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 3 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1715.7956906804288

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 3 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 503

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 3 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 1 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 4 ####
(DB4) Searching time by PSO: 4.666002035140991s

(DB4) The best candidate parameters found by PSO
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 52.16373e6 MPa (target) |
|     Qs    |  6.47199e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   |  3.9141e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 3.2367301421343275

(DB4) #### Stage 1 ####
(DB4) Running iteration 4 simulation

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 4 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 4 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2532.014124002064

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 4 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 504

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 4 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 1 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 5 ####
(DB4) Searching time by PSO: 4.930770635604858s

(DB4) The best candidate parameters found by PSO
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.019120531721781305

(DB4) #### Stage 1 ####
(DB4) Running iteration 5 simulation

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 5 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 5 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2760.9954490789396

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 5 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 505

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 5 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 1 ####
(DB4) #### (Curve DB4) Iteration 5 ####
(DB4) All loadings have successfully satisfied the deviation percentage
(DB4) Succeeded iteration: 5
(DB4) The first stage parameter solution is:
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) First optimization stage finished

(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) Optimizing the parameters p, q, v0
(DB4) Second optimization stage starts

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 6 ####
(DB4) Searching time by PSO: 4.606231927871704s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02599 (target)     |
|     q     |     1.25011 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 47.87836e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1.898147344538172

(DB4) #### Stage 2 ####
(DB4) Running iteration 6 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 6 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 6 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2792.746178625904

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 6 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 506

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 6 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 7 ####
(DB4) Searching time by PSO: 4.578805208206177s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.17093 (target)     |
|     q     |     1.98533 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 34.30106e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 10.841520588526556

(DB4) #### Stage 2 ####
(DB4) Running iteration 7 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 7 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 7 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1915.3036599779011

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 7 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 507

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 7 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 8 ####
(DB4) Searching time by PSO: 4.621962308883667s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.10104 (target)     |
|     q     |     1.85684 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 93.97895e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1.6696133589081505

(DB4) #### Stage 2 ####
(DB4) Running iteration 8 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 8 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 8 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2578.6571810848027

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 8 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 508

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 8 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 9 ####
(DB4) Searching time by PSO: 4.5830934047698975s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.30911 (target)     |
|     q     |     1.97367 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 41.06499e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 4.4467464241842425

(DB4) #### Stage 2 ####
(DB4) Running iteration 9 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 9 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 9 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1811.9952053465026

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 9 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 509

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 9 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 10 ####
(DB4) Searching time by PSO: 4.633239030838013s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.09847 (target)     |
|     q     |     1.84817 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 64.01876e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 4.541816389883204

(DB4) #### Stage 2 ####
(DB4) Running iteration 10 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 10 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 10 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2571.8779232063557

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 10 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 510

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 10 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 11 ####
(DB4) Searching time by PSO: 4.619181156158447s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.07511 (target)     |
|     q     |     1.97612 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 72.58018e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 4.6802602895227965

(DB4) #### Stage 2 ####
(DB4) Running iteration 11 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 11 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 11 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2762.4859501945944

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 11 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 511

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 11 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 12 ####
(DB4) Searching time by PSO: 4.656346321105957s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.07466 (target)     |
|     q     |     1.92556 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 75.36419e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.9902650499273347

(DB4) #### Stage 2 ####
(DB4) Running iteration 12 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 12 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 12 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2756.4416990391774

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 12 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 512

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 12 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 13 ####
(DB4) Searching time by PSO: 4.613139629364014s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.01379 (target)     |
|     q     |     1.22628 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 56.00227e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 11.262369631466102

(DB4) #### Stage 2 ####
(DB4) Running iteration 13 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 13 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 512

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 13 ####
(DB4) Searching time by PSO: 4.5549633502960205s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.22869 (target)     |
|     q     |     1.52678 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 45.29541e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 4.1337440742357305

(DB4) #### Stage 2 ####
(DB4) Running iteration 13 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 13 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 13 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1909.5317667981546

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 13 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 513

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 13 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 14 ####
(DB4) Searching time by PSO: 4.32712459564209s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.09248 (target)     |
|     q     |     1.75298 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 91.76248e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 2.6358080757146034

(DB4) #### Stage 2 ####
(DB4) Running iteration 14 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 14 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 14 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2579.0173196549267

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 14 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 514

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 14 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 15 ####
(DB4) Searching time by PSO: 4.550743818283081s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.11948 (target)     |
|     q     |     1.84905 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 57.30276e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 6.1029385362530855

(DB4) #### Stage 2 ####
(DB4) Running iteration 15 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 15 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 15 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2431.8662034788713

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 15 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 515

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 15 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 16 ####
(DB4) Searching time by PSO: 4.613490104675293s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.16333 (target)     |
|     q     |     1.56189 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 78.29042e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.3905399416500929

(DB4) #### Stage 2 ####
(DB4) Running iteration 16 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 16 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 16 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1758.3285407120475

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 16 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 516

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 16 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 17 ####
(DB4) Searching time by PSO: 4.530841827392578s

(DB4) The best candidate parameters found by PSO
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |     0.00833 (target)    |
|     q     |     1.84597 (target)    |
|   tausol  |      54.69694e6 MPa     |
|     Qs    |      3.33043e-19 J      |
|     Qc    |       1.9904e-19 J      |
|     v0    | 32.4405e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²     |
+-----------+-------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1.7736081945724804

(DB4) #### Stage 2 ####
(DB4) Running iteration 17 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 17 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 516

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 17 ####
(DB4) Searching time by PSO: 4.574103593826294s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.05367 (target)     |
|     q     |     1.15992 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 65.21135e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 6.750352459317616

(DB4) #### Stage 2 ####
(DB4) Running iteration 17 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 17 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 17 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2411.4135037718684

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 17 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 517

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 17 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 18 ####
(DB4) Searching time by PSO: 4.6930506229400635s

(DB4) The best candidate parameters found by PSO
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |     0.14376 (target)    |
|     q     |     1.87596 (target)    |
|   tausol  |      54.69694e6 MPa     |
|     Qs    |      3.33043e-19 J      |
|     Qc    |       1.9904e-19 J      |
|     v0    | 93.2123e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²     |
+-----------+-------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 5.3414441577652925

(DB4) #### Stage 2 ####
(DB4) Running iteration 18 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 18 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 18 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2336.1497722879917

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 18 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 518

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 18 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 19 ####
(DB4) Searching time by PSO: 4.594409227371216s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.11547 (target)     |
|     q     |     1.85983 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 43.59399e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 2.8003749805381277

(DB4) #### Stage 2 ####
(DB4) Running iteration 19 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 19 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 19 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2447.088288711412

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 19 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 519

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 19 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 20 ####
(DB4) Searching time by PSO: 4.4551777839660645s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.07737 (target)     |
|     q     |     1.60522 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 81.00944e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 2.614209968393224

(DB4) #### Stage 2 ####
(DB4) Running iteration 20 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 20 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 20 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2595.645065045993

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 20 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 520

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 20 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 21 ####
(DB4) Searching time by PSO: 4.744457960128784s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.11201 (target)     |
|     q     |     1.68086 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 59.63319e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.9635245441425305

(DB4) #### Stage 2 ####
(DB4) Running iteration 21 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 21 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 21 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2369.135625228255

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 21 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 521

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 21 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 22 ####
(DB4) Searching time by PSO: 4.737973690032959s

(DB4) The best candidate parameters found by PSO
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |     0.08857 (target)    |
|     q     |     1.44726 (target)    |
|   tausol  |      54.69694e6 MPa     |
|     Qs    |      3.33043e-19 J      |
|     Qc    |       1.9904e-19 J      |
|     v0    | 86.6003e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²     |
+-----------+-------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.8324335981179615

(DB4) #### Stage 2 ####
(DB4) Running iteration 22 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 21 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 521 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (521, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (521, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 117.21415710449219

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (521, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (521, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 237.9029541015625

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (521, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (521, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 217.92547607421875

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (521, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (521, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 183.36260986328125

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (521, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (521, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 126.35460662841797

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (521, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (521, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 186.2615203857422

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (521, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (521, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 140.677734375

(DB4) The number of combined interpolate curves is 521
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.065447092056274s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) Optimizing the parameters p, q, v0
(DB4) Second optimization stage starts

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 22 ####
(DB4) Searching time by PSO: 7.9509193897247314s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.09199 (target)     |
|     q     |     1.89712 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 82.35061e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.9209265894007956

(DB4) #### Stage 2 ####
(DB4) Running iteration 22 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 22 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 22 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1638.725963248138

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 22 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 522

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 22 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 23 ####
(DB4) Searching time by PSO: 7.824206352233887s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.08918 (target)     |
|     q     |     1.47246 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 74.07416e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.6059602566962679

(DB4) #### Stage 2 ####
(DB4) Running iteration 23 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 23 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 23 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1661.2124900705226

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 23 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 523

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 23 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 24 ####
(DB4) Searching time by PSO: 7.927305221557617s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.11397 (target)     |
|     q     |     1.65596 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 64.33585e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1.088951837802639

(DB4) #### Stage 2 ####
(DB4) Running iteration 24 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 24 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 24 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1753.5484224758989

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 24 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 524

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 24 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 25 ####
(DB4) Searching time by PSO: 8.044610023498535s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.14207 (target)     |
|     q     |     1.9202 (target)      |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 33.48637e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.6738944713004434

(DB4) #### Stage 2 ####
(DB4) Running iteration 25 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 25 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 25 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1851.4559200954263

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 25 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 525

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 25 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 26 ####
(DB4) Searching time by PSO: 7.964416027069092s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.13447 (target)     |
|     q     |     1.97373 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 20.23308e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 2.480411046307238

(DB4) #### Stage 2 ####
(DB4) Running iteration 26 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 26 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 26 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1749.3437852698985

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 26 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 526

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 26 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 27 ####
(DB4) Searching time by PSO: 7.979640483856201s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.09845 (target)     |
|     q     |     1.51557 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 84.31473e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 7.509584348874635

(DB4) #### Stage 2 ####
(DB4) Running iteration 27 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 27 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 27 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1708.314420714706

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 27 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 527

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 27 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 28 ####
(DB4) Searching time by PSO: 7.987593173980713s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.03447 (target)     |
|     q     |     1.55076 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 62.36995e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.7917630887340568

(DB4) #### Stage 2 ####
(DB4) Running iteration 28 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 27 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 527 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (527, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (527, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 191.56602478027344

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (527, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (527, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 355.02655029296875

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (527, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (527, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 132.82171630859375

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (527, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (527, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 120.93750762939453

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (527, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (527, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 224.66468811035156

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (527, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (527, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 96.39344787597656

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (527, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (527, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 184.60401916503906

(DB4) The number of combined interpolate curves is 527
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 23.988804817199707s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) Optimizing the parameters p, q, v0
(DB4) Second optimization stage starts

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 28 ####
(DB4) Searching time by PSO: 7.817032814025879s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.06954 (target)     |
|     q     |     1.47864 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 98.88166e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1.0104238604460682

(DB4) #### Stage 2 ####
(DB4) Running iteration 28 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 28 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 28 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1733.1087078205974

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 28 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 528

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 28 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 29 ####
(DB4) Searching time by PSO: 7.793179750442505s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.07362 (target)     |
|     q     |     1.54462 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 39.81002e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1.8297536356111732

(DB4) #### Stage 2 ####
(DB4) Running iteration 29 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 29 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 29 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1715.8211874841277

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 29 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 529

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 29 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Searching time by PSO: 11.940045595169067s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.1114 (target)      |
|     q     |     1.99485 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 97.92446e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.6852669631781032

(DB4) #### Stage 2 ####
(DB4) Running iteration 30 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) The total weighted yielding MSE of the iteration curve is 1752.1571384799358

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 7.937201976776123s

(DB4) The best candidate parameters found by PSO
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 0.8144802272790821

(DB4) #### Stage 2 ####
(DB4) Running iteration 31 simulation

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) The total weighted yielding MSE of the iteration curve is 2038.2394387489799

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 531

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 2 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) All loadings have successfully satisfied the deviation percentage
(DB4) Succeeded iteration: 31
(DB4) The second stage parameter solution is:
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) Second optimization stage finished

(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Searching time by PSO: 43.648804903030396s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.2022 b (target)    |
|   islip   |   62.63189 (target)    |
|   omega   |  39.35606 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.87233e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 2559.7323894844144

(DB4) #### Stage 3 ####
(DB4) Running iteration 32 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 31 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 531 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (531, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 133.554443359375

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (531, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 234.66098022460938

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (531, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 217.853759765625

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 194.0340118408203

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (531, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 159.2914276123047

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (531, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 127.94868469238281

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 129.09649658203125

(DB4) The number of combined interpolate curves is 531
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.351232528686523s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Searching time by PSO: 44.83837032318115s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.71846 b (target)   |
|   islip   |   107.78662 (target)   |
|   omega   |  4.68979 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.87155e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 3421.9464407299383

(DB4) #### Stage 3 ####
(DB4) Running iteration 32 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 31 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 531 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (531, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 166.3812255859375

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (531, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 607.3712768554688

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (531, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 353.18780517578125

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 153.37269592285156

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (531, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 239.68301391601562

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (531, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 197.0217742919922

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 119.43677520751953

(DB4) The number of combined interpolate curves is 531
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.897027254104614s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Searching time by PSO: 46.402472257614136s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.71539 b (target)   |
|   islip   |   242.28851 (target)   |
|   omega   |  2.57907 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96389e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1214.3192091150963

(DB4) #### Stage 3 ####
(DB4) Running iteration 32 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 31 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 531 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (531, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 152.15504455566406

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (531, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 300.574951171875

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (531, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 344.9894104003906

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 99.67667388916016

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (531, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 106.09224700927734

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (531, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 109.29749298095703

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 194.80154418945312

(DB4) The number of combined interpolate curves is 531
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 23.549509048461914s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Searching time by PSO: 43.38680458068848s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.89905 b (target)   |
|   islip   |   955.31224 (target)   |
|   omega   |  3.48198 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98294e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 2882.8611884724387

(DB4) #### Stage 3 ####
(DB4) Running iteration 32 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 31 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 531 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (531, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 143.66885375976562

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (531, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 197.80792236328125

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (531, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 234.79017639160156

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 114.68013000488281

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (531, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 275.66119384765625

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (531, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 134.3212890625

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 103.57410430908203

(DB4) The number of combined interpolate curves is 531
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 23.28397512435913s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 31 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 531 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (531, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 119.12845611572266

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (531, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 242.6127471923828

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (531, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 173.03456115722656

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 106.5996322631836

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (531, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 139.33299255371094

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (531, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 174.85316467285156

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 119.56989288330078

(DB4) The number of combined interpolate curves is 531
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.39023995399475s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Searching time by PSO: 45.82223606109619s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.41744 b (target)   |
|   islip   |   33.77819 (target)    |
|   omega   |  1.29972 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97907e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 911.5135581460331

(DB4) #### Stage 3 ####
(DB4) Running iteration 32 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 31 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 531 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (531, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 101.30187225341797

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (531, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 268.81597900390625

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (531, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 344.92413330078125

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 158.34983825683594

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (531, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 155.72145080566406

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (531, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 327.38177490234375

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 132.14390563964844

(DB4) The number of combined interpolate curves is 531
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.498000621795654s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Searching time by PSO: 45.806861877441406s

(DB4) The best candidate parameters found by PSO
+-----------+-----------------------+
| Parameter |         Value         |
+-----------+-----------------------+
|   dipole  |   1.88671 b (target)  |
|   islip   |   889.70496 (target)  |
|   omega   |   0.5593 b³ (target)  |
|     p     |        0.02365        |
|     q     |        1.40696        |
|   tausol  |     54.69694e6 MPa    |
|     Qs    |     3.33043e-19 J     |
|     Qc    | 1.9868e-19 J (target) |
|     v0    |    76.47686e-5 m/s    |
|   rho_e   |     4.41456e12 m⁻²    |
+-----------+-----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1931.4292110628844

(DB4) #### Stage 3 ####
(DB4) Running iteration 32 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 31 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 531 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (531, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 173.19471740722656

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (531, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 371.171875

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (531, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 136.29583740234375

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 177.26504516601562

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (531, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 209.9852294921875

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (531, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 285.5625915527344

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (531, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (531, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 117.88726043701172

(DB4) The number of combined interpolate curves is 531
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 23.907713413238525s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Searching time by PSO: 45.14895510673523s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   3.69934 b (target)   |
|   islip   |   114.92784 (target)   |
|   omega   |  48.61703 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98512e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1541.1373597375834

(DB4) #### Stage 3 ####
(DB4) Running iteration 32 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) The total weighted hardening MSE of the iteration curve is 2025.6692320739212

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 532

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 32 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Searching time by PSO: 46.29135990142822s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   7.09466 b (target)   |
|   islip   |   126.93247 (target)   |
|   omega   |  2.34355 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98489e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1419.2744017654704

(DB4) #### Stage 3 ####
(DB4) Running iteration 33 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 32 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 532 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (532, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (532, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 135.455322265625

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (532, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 193.9619140625

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (532, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 255.437744140625

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (532, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 104.65603637695312

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (532, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 176.45677185058594

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (532, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 122.10806274414062

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (532, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 121.06657409667969

(DB4) The number of combined interpolate curves is 532
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.464077711105347s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Searching time by PSO: 45.76494026184082s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.07461 b (target)   |
|   islip   |    30.8301 (target)    |
|   omega   |  7.40039 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.93068e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 727.9720931148056

(DB4) #### Stage 3 ####
(DB4) Running iteration 33 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 32 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 532 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (532, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (532, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 101.76235961914062

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (532, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 318.3209533691406

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (532, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 203.4475555419922

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (532, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 118.82070922851562

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (532, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 201.14727783203125

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (532, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 153.66363525390625

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (532, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 122.5596694946289

(DB4) The number of combined interpolate curves is 532
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 38.48847818374634s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Searching time by PSO: 145.351309299469s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.42411 b (target)   |
|   islip   |   165.89228 (target)   |
|   omega   |  9.92712 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99313e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1195.622491268476

(DB4) #### Stage 3 ####
(DB4) Running iteration 33 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 32 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 532 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (532, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (532, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 134.28831481933594

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (532, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 936.5736694335938

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (532, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 196.6067657470703

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (532, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 322.8746643066406

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (532, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 156.73516845703125

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (532, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 224.32571411132812

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (532, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (532, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 108.537109375

(DB4) The number of combined interpolate curves is 532
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 29.5524423122406s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Searching time by PSO: 49.40297865867615s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.1296 b (target)    |
|   islip   |   37.57292 (target)    |
|   omega   |  40.00991 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97097e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1728.1647551008482

(DB4) #### Stage 3 ####
(DB4) Running iteration 33 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 532

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Searching time by PSO: 46.36648416519165s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.33975 b (target)   |
|   islip   |   79.91679 (target)    |
|   omega   |  45.70198 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99337e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1912.9814945488592

(DB4) #### Stage 3 ####
(DB4) Running iteration 33 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 532

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Searching time by PSO: 45.90050268173218s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.48063 b (target)   |
|   islip   |   241.82897 (target)   |
|   omega   |  6.48344 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97493e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 4672.866213119886

(DB4) #### Stage 3 ####
(DB4) Running iteration 33 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) The total weighted hardening MSE of the iteration curve is 1791.5017306284794

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 533

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 33 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 34 ####
(DB4) Searching time by PSO: 45.671398639678955s

(DB4) The best candidate parameters found by PSO
+-----------+-----------------------+
| Parameter |         Value         |
+-----------+-----------------------+
|   dipole  |   0.72646 b (target)  |
|   islip   |   115.74394 (target)  |
|   omega   |  37.80098 b³ (target) |
|     p     |        0.02365        |
|     q     |        1.40696        |
|   tausol  |     54.69694e6 MPa    |
|     Qs    |     3.33043e-19 J     |
|     Qc    | 1.8936e-19 J (target) |
|     v0    |    76.47686e-5 m/s    |
|   rho_e   |     4.41456e12 m⁻²    |
+-----------+-----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 3185.638366050747

(DB4) #### Stage 3 ####
(DB4) Running iteration 34 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 34 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 533

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 34 ####
(DB4) Searching time by PSO: 46.513230323791504s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.99014 b (target)   |
|   islip   |   33.35475 (target)    |
|   omega   |  7.03618 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97011e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 960.3637332420205

(DB4) #### Stage 3 ####
(DB4) Running iteration 34 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 33 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 533 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (533, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (533, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 163.3359375

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (533, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 1009.0142211914062

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (533, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 146.0944366455078

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (533, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 148.2901611328125

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (533, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 247.4134521484375

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (533, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 86.73339080810547

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (533, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 130.87733459472656

(DB4) The number of combined interpolate curves is 533
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.820234775543213s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 34 ####
(DB4) Searching time by PSO: 46.41531586647034s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.63147 b (target)   |
|   islip   |   67.39421 (target)    |
|   omega   |  49.95654 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99142e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1887.6400795114803

(DB4) #### Stage 3 ####
(DB4) Running iteration 34 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 33 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 533 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (533, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (533, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 142.30274963378906

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (533, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 232.72055053710938

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (533, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 399.4754943847656

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (533, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 159.4818115234375

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (533, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 123.29779815673828

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (533, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 355.23651123046875

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (533, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (533, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 92.30911254882812

(DB4) The number of combined interpolate curves is 533
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.922707080841064s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 34 ####
(DB4) Searching time by PSO: 170.84636068344116s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.8942 b (target)    |
|   islip   |   359.71812 (target)   |
|   omega   |   4.9404 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99847e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1267.9417391661352

(DB4) #### Stage 3 ####
(DB4) Running iteration 34 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 28 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 528 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (528, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (528, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 187.65792846679688

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (528, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (528, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 241.35626220703125

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (528, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (528, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 148.0812225341797

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (528, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (528, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 200.78562927246094

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (528, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (528, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 168.98727416992188

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (528, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (528, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 279.10772705078125

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (528, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (528, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 170.66412353515625

(DB4) The number of combined interpolate curves is 528
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 23.845927715301514s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 29 ####
(DB4) Searching time by PSO: 168.81959557533264s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.97001 b (target)   |
|   islip   |   103.00335 (target)   |
|   omega   |  7.45227 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.85106e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 1032.3558604181271

(DB4) #### Stage 3 ####
(DB4) Running iteration 29 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 29 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 529 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |     1.7859 b    |
|   islip   |    159.42071    |
|   omega   |   48.74937 b³   |
|     p     |     0.57429     |
|     q     |     1.31316     |
|   tausol  |  13.25664e6 MPa |
|     Qs    |  5.79895e-19 J  |
|     Qc    |  1.95213e-19 J  |
|     v0    | 70.33467e-5 m/s |
|   rho_e   |  2.93147e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (529, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (529, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 223.47994995117188

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (529, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (529, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 332.5959167480469

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (529, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (529, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 259.0126953125

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (529, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (529, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 136.05532836914062

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (529, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (529, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 285.7380676269531

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (529, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (529, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 155.6321258544922

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (529, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (529, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 167.04176330566406

(DB4) The number of combined interpolate curves is 529
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.894654273986816s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Searching time by PSO: 45.42366695404053s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   3.2082 b (target)    |
|   islip   |   224.76648 (target)   |
|   omega   |  4.59288 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97359e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 487.21300413214084

(DB4) #### Stage 3 ####
(DB4) Running iteration 30 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Iteration simulation has converged. Saving the one new iteration simulation curves

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) The total weighted hardening MSE of the iteration curve is 391.85562561403765

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Starting to retrain the ANN for all loadings
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 30 ####
(DB4) Finish training ANN for all loadings

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.02201199531555s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.85367 b (target)   |
|   islip   |   154.54365 (target)   |
|   omega   |  10.69123 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.90799e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 276.908795926705

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |     1.7859 b    |
|   islip   |    159.42071    |
|   omega   |   48.74937 b³   |
|     p     |     0.57429     |
|     q     |     1.31316     |
|   tausol  |  13.25664e6 MPa |
|     Qs    |  5.79895e-19 J  |
|     Qc    |  1.95213e-19 J  |
|     v0    | 70.33467e-5 m/s |
|   rho_e   |  2.93147e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 122.77587890625

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 267.2550964355469

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 281.116943359375

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 131.90232849121094

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 439.2218322753906

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 266.433349609375

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 179.79583740234375

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.79879879951477s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 44.55708909034729s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.65704 b (target)   |
|   islip   |   46.74401 (target)    |
|   omega   |  6.27821 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97197e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 219.8681767937948

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 189.6840057373047

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 442.289306640625

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 175.9623260498047

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 309.7425842285156

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 152.1030731201172

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 133.49649047851562

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 191.93594360351562

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.039146900177002s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.952051639556885s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.84552 b (target)   |
|   islip   |   77.86202 (target)    |
|   omega   |  1.71097 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.91082e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 127.19704987391782

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 207.5816192626953

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 731.765380859375

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 321.4490051269531

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 136.95233154296875

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 210.44061279296875

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 171.55685424804688

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 235.25038146972656

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.791943788528442s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.96703314781189s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   5.04825 b (target)   |
|   islip   |   197.32747 (target)   |
|   omega   |  6.49533 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99588e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 361.33089459384917

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 132.5495147705078

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 768.9378662109375

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 236.355712890625

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 203.09310913085938

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 212.60980224609375

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 117.80644989013672

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 200.63841247558594

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.29098105430603s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.21709942817688s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.14774 b (target)   |
|   islip   |   186.55008 (target)   |
|   omega   |  0.05114 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99611e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 203.39236959467573

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 209.19921875

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 182.75576782226562

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 312.4501647949219

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 168.4605255126953

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 256.5609436035156

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 149.486572265625

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 190.2216033935547

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.38723063468933s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.44147062301636s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   5.05551 b (target)   |
|   islip   |   53.01278 (target)    |
|   omega   |  16.28767 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.95327e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 178.13631891999353

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 174.8668670654297

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 339.2141418457031

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 203.81488037109375

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 138.1044158935547

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 273.2839050292969

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 171.23692321777344

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 141.44927978515625

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.14064931869507s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 46.24412274360657s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.24059 b (target)   |
|   islip   |   146.28533 (target)   |
|   omega   |  24.19774 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.94208e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 152.04402521719328

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 190.63523864746094

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 222.1000213623047

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 370.8258056640625

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 145.7257080078125

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 376.48931884765625

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 199.06036376953125

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 229.74732971191406

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.584126234054565s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 44.10096287727356s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   5.70426 b (target)   |
|   islip   |   42.21578 (target)    |
|   omega   |  11.81189 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99236e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 256.1713069099352

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 152.0145263671875

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 594.8764038085938

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 277.1855163574219

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 158.9860076904297

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 165.84286499023438

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 117.6742935180664

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 167.1767578125

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.297310829162598s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 43.352219343185425s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.07446 b (target)   |
|   islip   |   27.26832 (target)    |
|   omega   |  6.02508 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97902e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 151.1324786170431

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 43.89032340049744s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.40931 b (target)   |
|   islip   |   34.89999 (target)    |
|   omega   |  36.6322 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.94996e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 327.513396334096

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 203.76283264160156

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 267.42950439453125

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 179.87240600585938

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 152.08279418945312

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 199.414306640625

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 160.34239196777344

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 130.07151794433594

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.709978580474854s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.02487277984619s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.18837 b (target)   |
|   islip   |   107.26857 (target)   |
|   omega   |  17.61647 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96482e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 184.30840181013846

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 30 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 530 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (530, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 199.94509887695312

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (530, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 307.2021179199219

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (530, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 150.0615234375

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 182.03286743164062

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (530, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 161.90733337402344

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (530, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 168.1288299560547

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (530, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (530, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 145.42723083496094

(DB4) The number of combined interpolate curves is 530
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.93464994430542s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 1.5%

(DB4) largeNonlinearHardeningDev = 2%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 44.859261989593506s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.73951 b (target)   |
|   islip   |   148.79373 (target)   |
|   omega   |  12.90857 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.89697e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 273.1003635007405

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 43.85043668746948s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.95333 b (target)   |
|   islip   |   39.56892 (target)    |
|   omega   |  14.87133 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98168e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 94.80760489903086

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 43.42373490333557s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.38005 b (target)   |
|   islip   |   232.98379 (target)   |
|   omega   |  1.51859 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.94329e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 106.00182166681066

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.18869209289551s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.14503 b (target)   |
|   islip   |   73.62368 (target)    |
|   omega   |  13.07656 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.91386e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 103.1758552258652

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.4073531627655s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.89779 b (target)   |
|   islip   |   100.02162 (target)   |
|   omega   |  7.57993 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96279e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 124.18051658531564

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 530

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 31 ####
(DB4) Searching time by PSO: 45.2155077457428s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   7.70188 b (target)   |
|   islip   |    67.2312 (target)    |
|   omega   |  49.31301 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99902e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 279.12074190379354

(DB4) #### Stage 3 ####
(DB4) Running iteration 31 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 189.82546997070312

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 820.5299682617188

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 352.1017150878906

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 146.2157745361328

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 244.7329559326172

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 135.0480194091797

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 143.13705444335938

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.29833197593689s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 43.992552042007446s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   3.33556 b (target)   |
|   islip   |   128.71641 (target)   |
|   omega   |  24.58654 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99595e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 176.27039353556242

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 43.59230709075928s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |  8.87007 b (target)  |
|   islip   |  25.98772 (target)   |
|   omega   |  1.3898 b³ (target)  |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.973e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 198.65216764457017

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.14255952835083s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.03384 b (target)   |
|   islip   |   104.47221 (target)   |
|   omega   |  38.47316 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98338e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 264.5797967540295

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.63445591926575s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.24932 b (target)   |
|   islip   |   88.65457 (target)    |
|   omega   |  1.23671 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97615e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 76.97564601389561

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.08580660820007s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.60409 b (target)   |
|   islip   |   163.87126 (target)   |
|   omega   |  4.46241 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96633e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 335.37868233758564

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.151514768600464s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.65895 b (target)   |
|   islip   |   40.34102 (target)    |
|   omega   |  9.16654 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99224e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 118.65550671130117

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.59693932533264s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.02867 b (target)   |
|   islip   |   35.28291 (target)    |
|   omega   |  45.96195 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99244e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 52.71313315743659

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.92765021324158s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.4758 b (target)    |
|   islip   |   193.28025 (target)   |
|   omega   |  16.95393 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97414e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 139.55304030569084

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.734442710876465s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   5.76949 b (target)   |
|   islip   |    4.38073 (target)    |
|   omega   |  2.11597 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98882e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 63.44903199087221

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.040244340896606s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.72494 b (target)   |
|   islip   |   88.01278 (target)    |
|   omega   |  1.19341 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96843e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 52.04264584314113

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.761754512786865s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.04559 b (target)   |
|   islip   |   49.03964 (target)    |
|   omega   |  32.39964 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.92787e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 105.51712160526232

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.74611496925354s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   8.45099 b (target)   |
|   islip   |   40.69485 (target)    |
|   omega   |  38.98179 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.95574e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 338.6505268645394

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.73201560974121s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   5.09877 b (target)   |
|   islip   |   97.17643 (target)    |
|   omega   |  2.16433 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.92206e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 171.84559031382145

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 43.81804013252258s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   6.70326 b (target)   |
|   islip   |   152.86475 (target)   |
|   omega   |   5.1572 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99529e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 109.58310279594292

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.8329074382782s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.5169 b (target)    |
|   islip   |   68.05315 (target)    |
|   omega   |  3.38081 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.91929e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 55.30515110855235

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.67571997642517s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.82357 b (target)   |
|   islip   |    6.59926 (target)    |
|   omega   |  9.03688 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.90302e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 124.42799535986452

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.976393699645996s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.79118 b (target)   |
|   islip   |   138.78675 (target)   |
|   omega   |  2.58273 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.90234e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 217.48344471687497

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.73183798789978s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   5.75558 b (target)   |
|   islip   |   41.66853 (target)    |
|   omega   |  5.45772 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96102e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 95.15587907673982

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 158.66326904296875

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 219.00473022460938

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 265.0741882324219

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 127.77938842773438

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 198.5718994140625

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 115.9239730834961

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 176.30535888671875

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 26.62322974205017s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.340821504592896s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   8.83004 b (target)   |
|   islip   |   43.11948 (target)    |
|   omega   |  12.23783 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.86547e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 296.399341833392

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.29680943489075s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.67952 b (target)   |
|   islip   |   277.65294 (target)   |
|   omega   |  2.31784 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99374e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 230.63453764489387

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.93677639961243s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.54327 b (target)   |
|   islip   |   29.11869 (target)    |
|   omega   |  47.84991 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.94508e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 331.82767552852033

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.76105976104736s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   3.38331 b (target)   |
|   islip   |    24.7479 (target)    |
|   omega   |  18.14508 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.90388e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 102.27942146146034

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.3942768573761s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   3.84873 b (target)   |
|   islip   |    67.2981 (target)    |
|   omega   |  13.33603 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98469e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 202.5645358014566

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.377917528152466s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.97551 b (target)   |
|   islip   |   36.30399 (target)    |
|   omega   |  4.56491 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.93317e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 63.94442776974032

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.141918897628784s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.06446 b (target)   |
|   islip   |   254.99033 (target)   |
|   omega   |  10.38575 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96916e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 131.3705686303999

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 267.15301513671875

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 478.41290283203125

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 308.1141052246094

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 181.75393676757812

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 180.0244140625

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 221.70089721679688

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 194.67381286621094

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 27.53056311607361s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.55132341384888s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   6.68748 b (target)   |
|   islip   |   81.11421 (target)    |
|   omega   |  1.72608 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99166e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 77.55692670680773

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 47.26680946350098s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.09402 b (target)   |
|   islip   |   97.96823 (target)    |
|   omega   |  6.40881 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97954e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 114.83207382621097

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.62784194946289s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.06277 b (target)   |
|   islip   |   198.08585 (target)   |
|   omega   |  5.94558 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.92966e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 87.90401217556527

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 104.60893249511719

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 409.7718811035156

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 209.8349609375

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 210.98704528808594

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 199.28280639648438

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 164.85935974121094

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 135.50108337402344

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 26.050342798233032s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.01612854003906s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   4.64917 b (target)   |
|   islip   |   22.04814 (target)    |
|   omega   |  2.58023 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.95985e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 212.7512383136566

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.88503336906433s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.13185 b (target)   |
|   islip   |   292.09792 (target)   |
|   omega   |  7.65972 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.96799e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 172.56568805132764

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.57712268829346s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.31409 b (target)   |
|   islip   |   118.62289 (target)   |
|   omega   |  16.98198 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99569e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 97.31552650265222

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.51848125457764s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   3.77314 b (target)   |
|   islip   |   168.9576 (target)    |
|   omega   |   5.5448 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.92079e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 226.9118916350626

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.45048427581787s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   6.04132 b (target)   |
|   islip   |    3.50388 (target)    |
|   omega   |  1.24316 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.95778e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 117.49888332188226

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.727229833602905s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   3.09186 b (target)   |
|   islip   |   59.53507 (target)    |
|   omega   |  10.92564 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.97286e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 185.251048480259

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.5143404006958s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   6.63988 b (target)   |
|   islip   |   101.20065 (target)   |
|   omega   |  0.60615 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99302e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 201.24393480964812

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 47.17802834510803s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.34421 b (target)   |
|   islip   |   114.50708 (target)   |
|   omega   |  7.51509 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.88927e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 109.2803786465612

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.85453772544861s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.77882 b (target)   |
|   islip   |   36.80602 (target)    |
|   omega   |  6.33897 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98874e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 107.40752580032193

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 201.64044189453125

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 146.19943237304688

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 220.58641052246094

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 254.37628173828125

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 253.94297790527344

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 151.58909606933594

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 125.75237274169922

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.074169635772705s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.89456582069397s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   2.07027 b (target)   |
|   islip   |   53.35635 (target)    |
|   omega   |  23.28544 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.99827e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 135.85863945037002

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 44.73593759536743s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.69479 b (target)   |
|   islip   |   35.68132 (target)    |
|   omega   |  22.04725 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.98539e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 118.76695432400018

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.12388849258423s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.17558 b (target)   |
|   islip   |   56.23978 (target)    |
|   omega   |  17.49021 b³ (target)  |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.95916e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 106.90932616800195

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.055867195129395s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   0.86083 b (target)   |
|   islip   |   35.43445 (target)    |
|   omega   |  0.57671 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.90419e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 92.402740428968

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.78742170333862s

(DB4) The best candidate parameters found by PSO
+-----------+------------------------+
| Parameter |         Value          |
+-----------+------------------------+
|   dipole  |   1.60873 b (target)   |
|   islip   |   126.21682 (target)   |
|   omega   |  3.77794 b³ (target)   |
|     p     |        0.02365         |
|     q     |        1.40696         |
|   tausol  |     54.69694e6 MPa     |
|     Qs    |     3.33043e-19 J      |
|     Qc    | 1.85974e-19 J (target) |
|     v0    |    76.47686e-5 m/s     |
|   rho_e   |     4.41456e12 m⁻²     |
+-----------+------------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 159.4344214589911

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.09581398963928s

(DB4) The best candidate parameters found by PSO
+-----------+-----------------------+
| Parameter |         Value         |
+-----------+-----------------------+
|   dipole  |   1.56186 b (target)  |
|   islip   |   121.1644 (target)   |
|   omega   |  3.02817 b³ (target)  |
|     p     |        0.02365        |
|     q     |        1.40696        |
|   tausol  |     54.69694e6 MPa    |
|     Qs    |     3.33043e-19 J     |
|     Qc    | 1.9379e-19 J (target) |
|     v0    |    76.47686e-5 m/s    |
|   rho_e   |     4.41456e12 m⁻²    |
+-----------+-----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 48.26785023852871

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      3      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 220.41554260253906

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 685.1354370117188

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 180.42910766601562

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 121.05171966552734

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 172.13572692871094

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 169.0296173095703

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 143.5662078857422

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.40771245956421s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.39361238479614s

(DB4) The best candidate parameters found by PSO
+-----------+---------------------+
| Parameter |        Value        |
+-----------+---------------------+
|   dipole  |   5.293 b (target)  |
|   islip   |   55.064 (target)   |
|   omega   |  3.542 b³ (target)  |
|     p     |       0.02365       |
|     q     |       1.40696       |
|   tausol  |    54.69694e6 MPa   |
|     Qs    |    3.33043e-19 J    |
|     Qc    | 1.89e-19 J (target) |
|     v0    |   76.47686e-5 m/s   |
|   rho_e   |    4.41456e12 m⁻²   |
+-----------+---------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 100.76310987158347

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      3      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 141.45758056640625

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 218.3197784423828

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 136.0897216796875

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 125.77349853515625

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 139.15975952148438

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 110.45181274414062

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 163.59906005859375

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 24.705856800079346s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.770360469818115s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   1.256 b (target)   |
|   islip   |   63.492 (target)    |
|   omega   |  18.799 b³ (target)  |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.871e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 72.26788645129032

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.18436598777771s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   4.401 b (target)   |
|   islip   |   67.522 (target)    |
|   omega   |  19.926 b³ (target)  |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.963e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 120.08545453454728

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      DB     |
|           Optimizer           |     PSO     |
|         Target curves         |     DB4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |      Pa     |
|       Rounding decimals       |      3      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     2.2%    |
|   Small linear hardening dev  |      2%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     3.2%    |
| Small nonlinear hardening dev |      3%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Khai/COE_DB_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(DB4) **********************************************************************
(DB4) Step 1: Loading progress and preparing data for curve DB4

(DB4) Curve DB4 status: 
(DB4) 41 iteration simulations completed.
(DB4) 500 initial simulations completed.
(DB4) Total: 541 simulations completed.

(DB4) Saving interpolating DB4 target curves
(DB4) Saving initial interpolating curves and reverse initial interpolating curves
(DB4) Experimental and simulated curves preparation completed

(DB4) Curve DB4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 209.491 MPa  |  [206.348, 212.633] MPa |  [207.396, 211.586 MPa] |
| nonlinear_planestrain_TD | 209.796 MPa  |  [206.649, 212.943] MPa |  [207.698, 211.894 MPa] |
|  nonlinear_uniaxial_RD   | 194.204 MPa  |  [191.291, 197.117] MPa |  [192.262, 196.146 MPa] |
|  nonlinear_uniaxial_TD   | 194.324 MPa  |  [191.409, 197.239] MPa |  [192.381, 196.267 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(DB4) Parameter set of the closest simulation curve to the target curve DB4 is: 
+-----------+-----------------+
| Parameter |      Value      |
+-----------+-----------------+
|   dipole  |    1.15559 b    |
|   islip   |    369.81541    |
|   omega   |    48.9995 b³   |
|     p     |     0.02352     |
|     q     |     1.04452     |
|   tausol  | 324.91246e6 MPa |
|     Qs    |  6.26883e-19 J  |
|     Qc    |   1.9904e-19 J  |
|     v0    | 65.97649e-5 m/s |
|   rho_e   |  4.22212e12 m⁻² |
+-----------+-----------------+
(DB4) Saving the default curves
(DB4) This parameter set will serve as default parameters for the 4 stage optimization of curve DB4

(DB4) **********************************************************************
(DB4) Step 2: Train the regressors for all loadings with the initial simulations of curve DB4

(DB4) ANN model: (parameters) -> (stress values at interpolating strain points)
(DB4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2800   |
|   Epochs of nonlinear_biaxial_RD   |   2200   |
|   Epochs of nonlinear_biaxial_TD   |   3000   |
| Epochs of nonlinear_planestrain_RD |   3200   |
| Epochs of nonlinear_planestrain_TD |   3600   |
|  Epochs of nonlinear_uniaxial_RD   |   2400   |
|  Epochs of nonlinear_uniaxial_TD   |   3400   |
+------------------------------------+----------+

(DB4) (linear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (linear_uniaxial_RD) stressLabels shape is (541, 26)
(DB4) Finish training ANN for loading linear_uniaxial_RD
(DB4) Training MSE error: 117.86161041259766

(DB4) (nonlinear_biaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_RD) stressLabels shape is (541, 14)
(DB4) Finish training ANN for loading nonlinear_biaxial_RD
(DB4) Training MSE error: 290.3746337890625

(DB4) (nonlinear_biaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_biaxial_TD) stressLabels shape is (541, 15)
(DB4) Finish training ANN for loading nonlinear_biaxial_TD
(DB4) Training MSE error: 225.6056671142578

(DB4) (nonlinear_planestrain_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_RD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_planestrain_RD
(DB4) Training MSE error: 195.38906860351562

(DB4) (nonlinear_planestrain_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_planestrain_TD) stressLabels shape is (541, 17)
(DB4) Finish training ANN for loading nonlinear_planestrain_TD
(DB4) Training MSE error: 230.9665985107422

(DB4) (nonlinear_uniaxial_RD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_RD) stressLabels shape is (541, 24)
(DB4) Finish training ANN for loading nonlinear_uniaxial_RD
(DB4) Training MSE error: 124.67237854003906

(DB4) (nonlinear_uniaxial_TD) paramFeatures shape is (541, 10)
(DB4) (nonlinear_uniaxial_TD) stressLabels shape is (541, 21)
(DB4) Finish training ANN for loading nonlinear_uniaxial_TD
(DB4) Training MSE error: 110.13557434082031

(DB4) The number of combined interpolate curves is 541
(DB4) Finish training ANN for all loadings of curve DB4
(DB4) Total training time: 25.28445601463318s

(DB4) **********************************************************************
(DB4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve DB4

(DB4) The large yielding parameters are ['tausol', 'Qs', 'rho_e']
(DB4) The small yielding parameters are ['p', 'q', 'v0']
(DB4) The large hardening parameters are ['dipole', 'islip', 'omega', 'Qc']
(DB4) The small hardening parameters are []

(DB4) There are 3 large yielding parameters
(DB4) 1st stage optimization required
(DB4) There are 3 small yielding parameters
(DB4) 2nd stage optimization required
(DB4) There are 4 large hardening parameters
(DB4) 3rd stage optimization required
(DB4) There are no small hardening parameters
(DB4) 4th stage optimization not required

(DB4) Because there are no small hardening parameters but there are large hardening parameters
(DB4) the large hardening deviation percentage is set as the small hardening deviation percentage
(DB4) largeLinearHardeningDev = 2%

(DB4) largeNonlinearHardeningDev = 3%

(DB4) The chosen optimizer is Particle Swarm Optimization
(DB4) Starting the four stage optimization for curve DB4

(DB4) **********************************************************************
(DB4) First optimization stage: Optimize the large yielding parameters for the curve DB4

(DB4) #### Stage 1 ####
(DB4) The file stage1_curves.npy detected, which means the first stage has finished
(DB4) First optimization stage finished

(DB4) The current result parameters
+-----------+-------------------------+
| Parameter |          Value          |
+-----------+-------------------------+
|   dipole  |        1.15559 b        |
|   islip   |        369.81541        |
|   omega   |        48.9995 b³       |
|     p     |         0.02352         |
|     q     |         1.04452         |
|   tausol  | 54.69694e6 MPa (target) |
|     Qs    |  3.33043e-19 J (target) |
|     Qc    |       1.9904e-19 J      |
|     v0    |     65.97649e-5 m/s     |
|   rho_e   | 4.41456e12 m⁻² (target) |
+-----------+-------------------------+
(DB4) **********************************************************************
(DB4) Second optimization stage: Optimize the small yielding parameters for the curve DB4

(DB4) #### Stage 2 ####
(DB4) The file stage2_curves.npy detected, which means the second stage has finished
(DB4) Second optimization stage finished

(DB4) The current result parameters
+-----------+--------------------------+
| Parameter |          Value           |
+-----------+--------------------------+
|   dipole  |        1.15559 b         |
|   islip   |        369.81541         |
|   omega   |        48.9995 b³        |
|     p     |     0.02365 (target)     |
|     q     |     1.40696 (target)     |
|   tausol  |      54.69694e6 MPa      |
|     Qs    |      3.33043e-19 J       |
|     Qc    |       1.9904e-19 J       |
|     v0    | 76.47686e-5 m/s (target) |
|   rho_e   |      4.41456e12 m⁻²      |
+-----------+--------------------------+
(DB4) **********************************************************************
(DB4) Third optimization stage: Optimize the large hardening parameters for the curve DB4

(DB4) #### Stage 3 ####
(DB4) Optimizing the parameters dipole, islip, omega, Qc
(DB4) Third optimization stage starts

(DB4) #### Stage 3 ####
(DB4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.69293236732483s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   1.146 b (target)   |
|   islip   |   17.222 (target)    |
|   omega   |  27.953 b³ (target)  |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.953e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 136.6627929282874

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.83222246170044s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   3.194 b (target)   |
|   islip   |   92.006 (target)    |
|   omega   |  1.791 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.921e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 37.45275769269279

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.70949149131775s

(DB4) The best candidate parameters found by PSO
+-----------+---------------------+
| Parameter |        Value        |
+-----------+---------------------+
|   dipole  |   1.798 b (target)  |
|   islip   |   62.166 (target)   |
|   omega   |  4.537 b³ (target)  |
|     p     |       0.02365       |
|     q     |       1.40696       |
|   tausol  |    54.69694e6 MPa   |
|     Qs    |    3.33043e-19 J    |
|     Qc    | 1.98e-19 J (target) |
|     v0    |   76.47686e-5 m/s   |
|   rho_e   |    4.41456e12 m⁻²   |
+-----------+---------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 42.70441101140757

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.82689166069031s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   2.892 b (target)   |
|   islip   |   74.501 (target)    |
|   omega   |  8.231 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.987e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 148.93439731552547

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.37308740615845s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   4.973 b (target)   |
|   islip   |   137.106 (target)   |
|   omega   |  6.704 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.989e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 97.25914206970397

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.488017082214355s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   4.083 b (target)   |
|   islip   |   117.751 (target)   |
|   omega   |  6.967 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.985e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 81.47079183045739

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.633955240249634s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   2.162 b (target)   |
|   islip   |   213.606 (target)   |
|   omega   |  16.32 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.954e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 95.6266091498243

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.41568207740784s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   1.109 b (target)   |
|   islip   |   81.846 (target)    |
|   omega   |   5.68 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.953e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 98.90080816562171

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.29430031776428s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   3.657 b (target)   |
|   islip   |   164.391 (target)   |
|   omega   |  5.018 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.987e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 251.40447462857372

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 46.12239074707031s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   3.254 b (target)   |
|   islip   |   131.336 (target)   |
|   omega   |  19.109 b³ (target)  |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.993e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 206.2890790285029

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.85070562362671s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   4.889 b (target)   |
|   islip   |   76.968 (target)    |
|   omega   |  6.456 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.967e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 91.75404074529145

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(DB4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(DB4) The number of combined interpolate curves is 541

(DB4) #### Stage 3 ####
(DB4) #### (Curve DB4) Iteration 42 ####
(DB4) Searching time by PSO: 45.856231689453125s

(DB4) The best candidate parameters found by PSO
+-----------+----------------------+
| Parameter |        Value         |
+-----------+----------------------+
|   dipole  |   3.843 b (target)   |
|   islip   |   76.486 (target)    |
|   omega   |  4.122 b³ (target)   |
|     p     |       0.02365        |
|     q     |       1.40696        |
|   tausol  |    54.69694e6 MPa    |
|     Qs    |    3.33043e-19 J     |
|     Qc    | 1.946e-19 J (target) |
|     v0    |   76.47686e-5 m/s    |
|   rho_e   |    4.41456e12 m⁻²    |
+-----------+----------------------+
(DB4) This is new parameters. Fitness value of the best candidate parameters: 172.89816669851317

(DB4) #### Stage 3 ####
(DB4) Running iteration 42 simulation

