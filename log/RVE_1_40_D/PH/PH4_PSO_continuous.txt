
Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |      2%     |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.5%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 500 initial simulations completed.
(PH4) No additional iteration simulations completed.
(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (500, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 134.77272033691406

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (500, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 250.59445190429688

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (500, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 228.38954162597656

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (500, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 280.58697509765625

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (500, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 211.842529296875

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (500, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 133.85386657714844

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (500, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (500, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 123.6205825805664

(PH4) The number of combined interpolate curves is 500
(PH4) Finish training ANN for all loadings of curve PH4

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) Optimizing the parameters tau0
(PH4) First optimization stage starts

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 54.51439 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 101.8946378610672

(PH4) #### Stage 1 ####
(PH4) Running iteration 1 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 501

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 1 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 52.18338 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 8.742197342631234

(PH4) #### Stage 1 ####
(PH4) Running iteration 2 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 502

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 2 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 56.12318 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 86.19306076894502

(PH4) #### Stage 1 ####
(PH4) Running iteration 3 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 503

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 3 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 54.92345 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 125.85301331026498

(PH4) #### Stage 1 ####
(PH4) Running iteration 4 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 504

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 4 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) The best candidate parameters found by PSO
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 33.00314565834184

(PH4) #### Stage 1 ####
(PH4) Running iteration 5 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 505

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 5 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 5
(PH4) The first stage parameter solution is:
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) First optimization stage finished

(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.04912 (target)    |
|     h0     | 989.3688 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 363.10078 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 195.45541451919215

(PH4) #### Stage 3 ####
(PH4) Running iteration 6 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 506

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 6 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.58679 (target)    |
|     h0     | 790.95802 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 425.7431 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 204.13317938344062

(PH4) #### Stage 3 ####
(PH4) Running iteration 7 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 507

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 7 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.90662 (target)    |
|     h0     | 1000.63956 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  362.96397 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 141.88169284943046

(PH4) #### Stage 3 ####
(PH4) Running iteration 8 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 508

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 8 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.51009 (target)    |
|     h0     | 400.96945 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 721.91897 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 171.18174384560996

(PH4) #### Stage 3 ####
(PH4) Running iteration 9 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 509

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 9 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.76404 (target)    |
|     h0     | 995.69402 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 320.99436 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 128.13261714042187

(PH4) #### Stage 3 ####
(PH4) Running iteration 10 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 510

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 10 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.94823 (target)    |
|     h0     | 956.45123 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 330.88515 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 122.71038902399536

(PH4) #### Stage 3 ####
(PH4) Running iteration 11 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 511

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 11 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.46472 (target)    |
|     h0     | 792.67105 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 434.31765 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 115.69673364525133

(PH4) #### Stage 3 ####
(PH4) Running iteration 12 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 512

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 12 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.0932 (target)     |
|     h0     | 832.92566 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 410.78626 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 125.54795473033063

(PH4) #### Stage 3 ####
(PH4) Running iteration 13 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 513

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 13 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.13852 (target)    |
|     h0     | 1168.68684 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  360.56078 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 84.55368699746185

(PH4) #### Stage 3 ####
(PH4) Running iteration 14 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 514

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 14 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.07654 (target)    |
|     h0     | 927.50398 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 476.57378 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 123.60798783493183

(PH4) #### Stage 3 ####
(PH4) Running iteration 15 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 515

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 15 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.89087 (target)    |
|     h0     | 625.2562 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 632.51256 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 127.95440544063959

(PH4) #### Stage 3 ####
(PH4) Running iteration 16 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 516

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 16 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.79932 (target)    |
|     h0     | 1058.80108 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  346.69553 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 69.81796354334965

(PH4) #### Stage 3 ####
(PH4) Running iteration 17 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 517

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 17 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.57887 (target)    |
|     h0     | 968.07948 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 336.39381 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 95.236066565434

(PH4) #### Stage 3 ####
(PH4) Running iteration 18 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 518

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 18 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.47217 (target)    |
|     h0     | 492.41119 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 539.74378 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 116.0116810546085

(PH4) #### Stage 3 ####
(PH4) Running iteration 19 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 519

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 19 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.28572 (target)    |
|     h0     | 876.85814 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 354.7127 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 106.90128340667698

(PH4) #### Stage 3 ####
(PH4) Running iteration 20 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 520

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.66814 (target)    |
|     h0     |  780.392 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 399.78491 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 94.2654696316767

(PH4) #### Stage 3 ####
(PH4) Running iteration 21 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 521

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 21 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |     7.316 (target)     |
|     h0     | 712.01288 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 448.91589 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 115.04519563180585

(PH4) #### Stage 3 ####
(PH4) Running iteration 22 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 522

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.18742 (target)    |
|     h0     | 1157.03132 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  378.57401 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 165.21724239730634

(PH4) #### Stage 3 ####
(PH4) Running iteration 23 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 523

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.45129 (target)    |
|     h0     | 645.68469 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 521.69363 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 121.79853409251066

(PH4) #### Stage 3 ####
(PH4) Running iteration 24 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 524

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.68861 (target)    |
|     h0     | 725.52071 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 407.55579 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 100.6124157708152

(PH4) #### Stage 3 ####
(PH4) Running iteration 25 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 525

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.87311 (target)    |
|     h0     | 619.25737 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 349.89402 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 134.62390827501818

(PH4) #### Stage 3 ####
(PH4) Running iteration 26 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 526

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.70636 (target)    |
|     h0     | 903.68888 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 430.71041 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 85.15303061637069

(PH4) #### Stage 3 ####
(PH4) Running iteration 27 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 527

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.31105 (target)    |
|     h0     | 407.83793 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 670.79429 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 134.45261178099577

(PH4) #### Stage 3 ####
(PH4) Running iteration 28 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 528

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.14523 (target)    |
|     h0     | 621.9989 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 385.27892 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 87.43855388042948

(PH4) #### Stage 3 ####
(PH4) Running iteration 29 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 529

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.37987 (target)    |
|     h0     | 614.06162 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 508.40579 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 97.43462971447647

(PH4) #### Stage 3 ####
(PH4) Running iteration 30 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 530

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.12445 (target)    |
|     h0     | 1093.57039 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  322.11707 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 105.54392152896075

(PH4) #### Stage 3 ####
(PH4) Running iteration 31 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 531

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.75277 (target)    |
|     h0     | 1444.27669 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  346.16782 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 108.23781256280677

(PH4) #### Stage 3 ####
(PH4) Running iteration 32 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 532

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.44945 (target)    |
|     h0     | 849.97797 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 415.60689 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 94.48639659577644

(PH4) #### Stage 3 ####
(PH4) Running iteration 33 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 533

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.5881 (target)     |
|     h0     | 1196.31597 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  356.64701 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 93.57927513280275

(PH4) #### Stage 3 ####
(PH4) Running iteration 34 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 534

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    2.48895 (target)    |
|     h0     | 591.05459 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 216.62961 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 98.03530606946407

(PH4) #### Stage 3 ####
(PH4) Running iteration 35 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 535

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.98802 (target)    |
|     h0     | 567.83692 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 375.84234 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 90.17553911308563

(PH4) #### Stage 3 ####
(PH4) Running iteration 36 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 536

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.9052 (target)     |
|     h0     | 1166.81912 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  349.00312 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 73.66348253823693

(PH4) #### Stage 3 ####
(PH4) Running iteration 37 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 537

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.37705 (target)    |
|     h0     | 620.51527 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 524.27856 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 84.36683467236486

(PH4) #### Stage 3 ####
(PH4) Running iteration 38 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 538

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.78155 (target)    |
|     h0     | 407.62764 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 651.82462 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 192.5020711545838

(PH4) #### Stage 3 ####
(PH4) Running iteration 39 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 539

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    2.8808 (target)     |
|     h0     | 705.66342 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 223.13909 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 121.87458515974888

(PH4) #### Stage 3 ####
(PH4) Running iteration 40 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 540

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |      8.018 (target)     |
|     h0     | 1440.20763 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  347.06585 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 105.51202161706497

(PH4) #### Stage 3 ####
(PH4) Running iteration 41 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 541

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.73181 (target)    |
|     h0     | 509.69782 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 341.22946 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 109.72263884854885

(PH4) #### Stage 3 ####
(PH4) Running iteration 42 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 542

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.03072 (target)    |
|     h0     | 872.15589 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 397.38563 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 102.58542139811715

(PH4) #### Stage 3 ####
(PH4) Running iteration 43 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 543

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.32187 (target)    |
|     h0     | 881.42049 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 317.75515 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 102.70425567334902

(PH4) #### Stage 3 ####
(PH4) Running iteration 44 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 544

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.33041 (target)    |
|     h0     | 899.93987 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 350.87004 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 120.1324217037822

(PH4) #### Stage 3 ####
(PH4) Running iteration 45 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 545

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.89673 (target)    |
|     h0     | 616.64042 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 270.88466 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 105.44021467849925

(PH4) #### Stage 3 ####
(PH4) Running iteration 46 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 546

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.03679 (target)    |
|     h0     | 476.59396 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 647.7579 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 105.91775552733434

(PH4) #### Stage 3 ####
(PH4) Running iteration 47 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 547

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.15542 (target)    |
|     h0     | 742.62337 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 225.60447 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 102.49961724624299

(PH4) #### Stage 3 ####
(PH4) Running iteration 48 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 548

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.47746 (target)    |
|     h0     | 830.94893 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 382.3143 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 107.109414004437

(PH4) #### Stage 3 ####
(PH4) Running iteration 49 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 549

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.02965 (target)    |
|     h0     | 651.28917 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 359.26796 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 114.2243603905637

(PH4) #### Stage 3 ####
(PH4) Running iteration 50 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 550

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.95895 (target)    |
|     h0     | 801.40556 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 306.03345 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 97.10622765676847

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 50 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 550 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (550, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (550, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 97.68464660644531

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (550, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 170.74578857421875

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (550, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 450.5679016113281

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (550, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 189.61083984375

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (550, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 133.3526153564453

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (550, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 116.73793029785156

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (550, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 203.29849243164062

(PH4) The number of combined interpolate curves is 550
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.10063362121582s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Searching time by PSO: 47.342740058898926s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.51536 (target)    |
|     h0     | 568.88254 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 611.35693 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 70.74072297984785

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) The total weighted hardening MSE of the iteration curve is 98.1802539293705

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 551

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Searching time by PSO: 47.484477043151855s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.93977 (target)    |
|     h0     | 832.64612 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 493.96214 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 57.797121128215245

(PH4) #### Stage 3 ####
(PH4) Running iteration 52 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) The total weighted hardening MSE of the iteration curve is 93.38126199530632

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 552

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Searching time by PSO: 47.21355056762695s

(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |    7.79181 (target)   |
|     h0     | 677.9325 MPa (target) |
|    tau0    |      53.9818 MPa      |
|   tausat   | 496.5301 MPa (target) |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 54.845167367999075

(PH4) #### Stage 3 ####
(PH4) Running iteration 53 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) The total weighted hardening MSE of the iteration curve is 91.72486082027685

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 553

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Searching time by PSO: 47.08694911003113s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.64119 (target)    |
|     h0     | 938.55811 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 419.84664 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 66.38154072400438

(PH4) #### Stage 3 ####
(PH4) Running iteration 54 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) The total weighted hardening MSE of the iteration curve is 76.75412831914169

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 554

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Searching time by PSO: 47.447330713272095s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.79042 (target)    |
|     h0     | 1246.0457 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 300.68265 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 65.95287466064862

(PH4) #### Stage 3 ####
(PH4) Running iteration 55 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) The total weighted hardening MSE of the iteration curve is 112.61824929800146

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 555

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Searching time by PSO: 47.25795888900757s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.6924 (target)     |
|     h0     | 990.08073 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 493.11194 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 58.47102783854696

(PH4) #### Stage 3 ####
(PH4) Running iteration 56 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) The total weighted hardening MSE of the iteration curve is 77.94805227451084

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 556

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Searching time by PSO: 47.47045087814331s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.75457 (target)    |
|     h0     | 450.67772 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 531.58462 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 73.22517748817722

(PH4) #### Stage 3 ####
(PH4) Running iteration 57 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) The total weighted hardening MSE of the iteration curve is 120.07723397072405

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 557

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Searching time by PSO: 47.9756977558136s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.95771 (target)    |
|     h0     | 868.32387 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 526.54165 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 70.0065060512503

(PH4) #### Stage 3 ####
(PH4) Running iteration 58 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) The total weighted hardening MSE of the iteration curve is 107.1059290529002

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 558

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Searching time by PSO: 47.455795764923096s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.55902 (target)    |
|     h0     | 1043.84429 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  338.91761 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 51.82159670921122

(PH4) #### Stage 3 ####
(PH4) Running iteration 59 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) The total weighted hardening MSE of the iteration curve is 79.65184473538737

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 559

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Searching time by PSO: 47.14705753326416s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.41629 (target)    |
|     h0     | 726.15177 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 480.83286 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 74.37516868813756

(PH4) #### Stage 3 ####
(PH4) Running iteration 60 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) The total weighted hardening MSE of the iteration curve is 103.54375901837139

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 560

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Searching time by PSO: 45.95410966873169s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     8.95092 (target)    |
|     h0     | 1017.52822 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  445.38017 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 52.73150650181863

(PH4) #### Stage 3 ####
(PH4) Running iteration 61 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) The total weighted hardening MSE of the iteration curve is 92.65314298453345

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 561

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Searching time by PSO: 46.13617467880249s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.40169 (target)    |
|     h0     | 1252.6585 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 313.17054 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 43.398820761541124

(PH4) #### Stage 3 ####
(PH4) Running iteration 62 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) The total weighted hardening MSE of the iteration curve is 69.08827298303345

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 562

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Searching time by PSO: 47.676337480545044s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.84231 (target)    |
|     h0     | 1015.24413 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  493.13147 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.052545481957715

(PH4) #### Stage 3 ####
(PH4) Running iteration 63 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) The total weighted hardening MSE of the iteration curve is 78.41818338378587

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 563

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Searching time by PSO: 46.93103742599487s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.48004 (target)    |
|     h0     | 1701.27654 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  369.99702 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 76.1169638128053

(PH4) #### Stage 3 ####
(PH4) Running iteration 64 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) The total weighted hardening MSE of the iteration curve is 139.84600202586623

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 564

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Searching time by PSO: 47.23562550544739s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.40422 (target)    |
|     h0     | 635.72527 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 387.83112 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 58.894606901158454

(PH4) #### Stage 3 ####
(PH4) Running iteration 65 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) The total weighted hardening MSE of the iteration curve is 92.55251482909131

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 565

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Searching time by PSO: 46.93738675117493s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.9226 (target)     |
|     h0     | 1555.6194 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 409.63688 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 45.977844092388466

(PH4) #### Stage 3 ####
(PH4) Running iteration 66 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) The total weighted hardening MSE of the iteration curve is 83.21117987908852

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 566

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Searching time by PSO: 46.936827421188354s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     5.98074 (target)    |
|     h0     | 1044.45707 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  317.17132 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 45.48584717603232

(PH4) #### Stage 3 ####
(PH4) Running iteration 67 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) The total weighted hardening MSE of the iteration curve is 71.86840087734646

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 567

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Searching time by PSO: 47.23337125778198s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     8.07873 (target)    |
|     h0     | 1122.39755 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  402.56921 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 40.843317999032934

(PH4) #### Stage 3 ####
(PH4) Running iteration 68 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) The total weighted hardening MSE of the iteration curve is 71.36241370477006

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 568

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Searching time by PSO: 47.210795640945435s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.8665 (target)     |
|     h0     | 777.30014 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 417.4676 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 70.83011060044177

(PH4) #### Stage 3 ####
(PH4) Running iteration 69 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) The total weighted hardening MSE of the iteration curve is 79.62902764618399

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 569

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Searching time by PSO: 47.50538229942322s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.51721 (target)    |
|     h0     | 839.20976 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 486.39855 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 45.08625516571993

(PH4) #### Stage 3 ####
(PH4) Running iteration 70 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) The total weighted hardening MSE of the iteration curve is 78.48750001174801

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 570

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Searching time by PSO: 47.213846921920776s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.25926 (target)    |
|     h0     | 586.36554 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 319.18451 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 71.84928282909105

(PH4) #### Stage 3 ####
(PH4) Running iteration 71 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) The total weighted hardening MSE of the iteration curve is 96.25381901163198

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 571

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Searching time by PSO: 47.018086433410645s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.77531 (target)    |
|     h0     | 1706.28004 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  387.2737 MPa (target)  |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 30.593513267211286

(PH4) #### Stage 3 ####
(PH4) Running iteration 72 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) The total weighted hardening MSE of the iteration curve is 95.85958190836209

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 572

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Searching time by PSO: 47.064708948135376s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     5.54106 (target)    |
|     h0     | 1169.81161 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  285.26726 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 36.525628426539114

(PH4) #### Stage 3 ####
(PH4) Running iteration 73 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) The total weighted hardening MSE of the iteration curve is 69.10084870502955

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 573

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Searching time by PSO: 47.57095742225647s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.74759 (target)    |
|     h0     | 1120.33445 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  385.52708 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 45.60507342456904

(PH4) #### Stage 3 ####
(PH4) Running iteration 74 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) The total weighted hardening MSE of the iteration curve is 70.94730412849276

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 574

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Searching time by PSO: 45.765772581100464s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     8.76478 (target)    |
|     h0     | 1037.47405 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  438.02558 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 54.72434618083429

(PH4) #### Stage 3 ####
(PH4) Running iteration 75 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) The total weighted hardening MSE of the iteration curve is 80.53503354156737

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 575

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Searching time by PSO: 47.12400960922241s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.06652 (target)    |
|     h0     | 1810.90181 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  364.61783 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 31.12424543483607

(PH4) #### Stage 3 ####
(PH4) Running iteration 76 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) The total weighted hardening MSE of the iteration curve is 70.68604775353037

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 576

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 76 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Searching time by PSO: 47.5844783782959s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     5.29166 (target)    |
|     h0     | 1001.27527 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  306.30049 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 79.35634094728572

(PH4) #### Stage 3 ####
(PH4) Running iteration 77 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) The total weighted hardening MSE of the iteration curve is 108.84810216637405

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 577

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 77 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Searching time by PSO: 66.98339653015137s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.2196 (target)     |
|     h0     | 1076.63844 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  335.93812 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 52.356881367129525

(PH4) #### Stage 3 ####
(PH4) Running iteration 78 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) The total weighted hardening MSE of the iteration curve is 92.0486234154886

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 578

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 78 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Searching time by PSO: 46.90891933441162s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.93823 (target)    |
|     h0     | 582.78874 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 646.20496 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 55.18918354124526

(PH4) #### Stage 3 ####
(PH4) Running iteration 79 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) The total weighted hardening MSE of the iteration curve is 173.24328687624808

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 579

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 79 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Searching time by PSO: 46.14337229728699s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.85058 (target)    |
|     h0     | 1447.33371 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  347.94789 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 54.230826285177834

(PH4) #### Stage 3 ####
(PH4) Running iteration 80 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) The total weighted hardening MSE of the iteration curve is 71.76723632263344

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 580

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 80 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Searching time by PSO: 46.82971525192261s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.53576 (target)    |
|     h0     | 1096.91716 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  469.1944 MPa (target)  |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 44.233235297614016

(PH4) #### Stage 3 ####
(PH4) Running iteration 81 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) The total weighted hardening MSE of the iteration curve is 71.90258382576066

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 581

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 81 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Searching time by PSO: 47.33713674545288s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.86307 (target)    |
|     h0     | 1307.58402 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  367.00583 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 50.10443220217448

(PH4) #### Stage 3 ####
(PH4) Running iteration 82 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) The total weighted hardening MSE of the iteration curve is 69.36750925169906

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 582

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 82 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Searching time by PSO: 46.900776863098145s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.70046 (target)    |
|     h0     | 774.01096 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 476.7723 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 79.21016122284215

(PH4) #### Stage 3 ####
(PH4) Running iteration 83 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) The total weighted hardening MSE of the iteration curve is 95.98745088541884

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 583

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 83 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Searching time by PSO: 46.57467579841614s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.01895 (target)    |
|     h0     | 790.36087 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 357.33875 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 54.43261103786206

(PH4) #### Stage 3 ####
(PH4) Running iteration 84 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) The total weighted hardening MSE of the iteration curve is 94.3166478494881

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 584

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 84 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Searching time by PSO: 46.66747570037842s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.26935 (target)    |
|     h0     | 920.63573 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 353.09112 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 74.06436890381906

(PH4) #### Stage 3 ####
(PH4) Running iteration 85 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) The total weighted hardening MSE of the iteration curve is 73.5034885168088

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 585

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 85 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Searching time by PSO: 46.786837339401245s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     5.86074 (target)    |
|     h0     | 1370.70554 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  281.76045 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 54.58859665349679

(PH4) #### Stage 3 ####
(PH4) Running iteration 86 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) The total weighted hardening MSE of the iteration curve is 69.2224661844073

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 586

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 86 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Searching time by PSO: 46.79585385322571s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.50187 (target)    |
|     h0     | 462.41469 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 618.66552 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 89.27921206473714

(PH4) #### Stage 3 ####
(PH4) Running iteration 87 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) The total weighted hardening MSE of the iteration curve is 127.57716195491881

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 587

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 87 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Searching time by PSO: 46.80945038795471s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.5902 (target)     |
|     h0     |  1002.52 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 444.23606 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 57.25071542314953

(PH4) #### Stage 3 ####
(PH4) Running iteration 88 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) The total weighted hardening MSE of the iteration curve is 73.53332158660356

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 588

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 88 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Searching time by PSO: 47.0292809009552s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.53942 (target)    |
|     h0     | 614.10231 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 341.66972 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 91.24749625755791

(PH4) #### Stage 3 ####
(PH4) Running iteration 89 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 88 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 588 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (588, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (588, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 107.95480346679688

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (588, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (588, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 155.03155517578125

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (588, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (588, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 134.41050720214844

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (588, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (588, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 114.70384216308594

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (588, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (588, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 156.07763671875

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (588, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (588, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 144.3035888671875

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (588, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (588, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 136.04579162597656

(PH4) The number of combined interpolate curves is 588
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.169316053390503s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Searching time by PSO: 48.81184768676758s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.2286 (target)     |
|     h0     | 492.43882 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 373.76813 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 202.49314096780685

(PH4) #### Stage 3 ####
(PH4) Running iteration 89 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) The total weighted hardening MSE of the iteration curve is 299.0803979077608

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 589

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 89 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Searching time by PSO: 48.43329381942749s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.57177 (target)    |
|     h0     | 604.42637 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 341.24756 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 232.09664095431793

(PH4) #### Stage 3 ####
(PH4) Running iteration 90 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) The total weighted hardening MSE of the iteration curve is 267.1623937539672

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 590

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 90 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Searching time by PSO: 47.04108953475952s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.77791 (target)    |
|     h0     | 1044.01535 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  343.22454 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 212.47066943923028

(PH4) #### Stage 3 ####
(PH4) Running iteration 91 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) The total weighted hardening MSE of the iteration curve is 273.3631532644381

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 591

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 91 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Searching time by PSO: 48.28166317939758s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.3657 (target)     |
|     h0     | 535.45629 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 621.11929 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 230.40150909408936

(PH4) #### Stage 3 ####
(PH4) Running iteration 92 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) The total weighted hardening MSE of the iteration curve is 284.3111895245156

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 592

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 92 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Searching time by PSO: 48.88272500038147s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.16861 (target)    |
|     h0     | 621.93213 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 639.59745 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 217.57105097982742

(PH4) #### Stage 3 ####
(PH4) Running iteration 93 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) The total weighted hardening MSE of the iteration curve is 300.29568650303554

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 593

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 93 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Searching time by PSO: 48.93175983428955s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.99539 (target)    |
|     h0     | 945.19085 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 510.96005 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 212.41644968264058

(PH4) #### Stage 3 ####
(PH4) Running iteration 94 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) The total weighted hardening MSE of the iteration curve is 263.9506403255185

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 594

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 94 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Searching time by PSO: 49.03556561470032s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    8.3348 (target)     |
|     h0     | 882.08221 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 444.8185 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 216.05837992358877

(PH4) #### Stage 3 ####
(PH4) Running iteration 95 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) The total weighted hardening MSE of the iteration curve is 274.0845519481891

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 595

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 95 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 95 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 595 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (595, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (595, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 130.6681365966797

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (595, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (595, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 218.09066772460938

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (595, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (595, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 195.5112762451172

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (595, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (595, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 98.94223022460938

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (595, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (595, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 132.5714874267578

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (595, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (595, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 129.49330139160156

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (595, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (595, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 126.54203796386719

(PH4) The number of combined interpolate curves is 595
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.04000449180603s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Searching time by PSO: 44.33565044403076s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.03266 (target)    |
|     h0     | 844.81515 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 307.11612 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 215.9835791600013

(PH4) #### Stage 3 ####
(PH4) Running iteration 96 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) The total weighted hardening MSE of the iteration curve is 276.06702588889186

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 596

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 96 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Searching time by PSO: 44.50840091705322s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.39013 (target)    |
|     h0     | 1465.10187 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  325.50247 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 167.4134708034474

(PH4) #### Stage 3 ####
(PH4) Running iteration 97 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) The total weighted hardening MSE of the iteration curve is 291.08342151525005

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 597

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 97 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Searching time by PSO: 43.82628774642944s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.83751 (target)    |
|     h0     | 638.90571 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 409.51512 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 247.8115101063829

(PH4) #### Stage 3 ####
(PH4) Running iteration 98 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) The total weighted hardening MSE of the iteration curve is 301.0352388686175

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 598

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 98 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Searching time by PSO: 44.51899981498718s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.46864 (target)    |
|     h0     | 937.47421 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 317.79305 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 213.05050053020528

(PH4) #### Stage 3 ####
(PH4) Running iteration 99 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) The total weighted hardening MSE of the iteration curve is 286.69500340451896

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 599

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 99 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Searching time by PSO: 45.292168378829956s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.74765 (target)    |
|     h0     | 1244.1614 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 287.04405 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 202.77238233328183

(PH4) #### Stage 3 ####
(PH4) Running iteration 100 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) The total weighted hardening MSE of the iteration curve is 274.85699942171146

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 600

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 100 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Searching time by PSO: 45.165154695510864s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    2.72832 (target)    |
|     h0     | 844.68141 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 189.6051 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 259.4580554199714

(PH4) #### Stage 3 ####
(PH4) Running iteration 101 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) The total weighted hardening MSE of the iteration curve is 266.4745662084962

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 601

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 101 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Searching time by PSO: 44.971107959747314s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.90129 (target)    |
|     h0     | 886.95168 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 335.76493 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 203.58588842923697

(PH4) #### Stage 3 ####
(PH4) Running iteration 102 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) The total weighted hardening MSE of the iteration curve is 278.66549865178393

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 602

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 102 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Searching time by PSO: 45.03951930999756s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.38432 (target)    |
|     h0     | 495.13059 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 391.44683 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 209.02676643319873

(PH4) #### Stage 3 ####
(PH4) Running iteration 103 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) The total weighted hardening MSE of the iteration curve is 358.74871689197255

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 603

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 103 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Searching time by PSO: 45.35793209075928s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.53874 (target)    |
|     h0     | 819.63929 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 243.99514 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 243.89293265825174

(PH4) #### Stage 3 ####
(PH4) Running iteration 104 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) The total weighted hardening MSE of the iteration curve is 325.72187051838597

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 604

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 104 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     1.7%    |
|   Small linear hardening dev  |     1.5%    |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     2.2%    |
| Small nonlinear hardening dev |      2%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 104 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 604 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (604, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (604, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 101.34247589111328

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (604, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 158.63607788085938

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (604, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 182.72010803222656

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (604, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 107.66597747802734

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (604, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 182.6387176513672

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (604, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 101.68816375732422

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (604, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (604, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 107.46530151367188

(PH4) The number of combined interpolate curves is 604
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.84697127342224s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Searching time by PSO: 48.01778030395508s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.33104 (target)    |
|     h0     | 826.68456 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 519.62551 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 238.04330858715548

(PH4) #### Stage 3 ####
(PH4) Running iteration 105 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) The total weighted hardening MSE of the iteration curve is 308.5838023212506

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 605

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 105 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Searching time by PSO: 48.425902128219604s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.63774 (target)    |
|     h0     | 978.60622 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 273.22744 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 204.4495305752676

(PH4) #### Stage 3 ####
(PH4) Running iteration 106 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) The total weighted hardening MSE of the iteration curve is 310.21755760029066

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 606

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 106 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) Searching time by PSO: 48.60467290878296s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.70061 (target)    |
|     h0     | 530.05245 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 407.62172 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 257.6444151062843

(PH4) #### Stage 3 ####
(PH4) Running iteration 107 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) The total weighted hardening MSE of the iteration curve is 406.7010445207959

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 107 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 607


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 107 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 607 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (607, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (607, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 97.310546875

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (607, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (607, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 495.01531982421875

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (607, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (607, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 228.57217407226562

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (607, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (607, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 124.85701751708984

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (607, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (607, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 205.3220977783203

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (607, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (607, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 90.42512512207031

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (607, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (607, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 151.5449676513672

(PH4) The number of combined interpolate curves is 607
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.8013858795166s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Searching time by PSO: 44.50009036064148s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.99454 (target)    |
|     h0     | 1259.94948 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  334.87294 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 224.29493517096762

(PH4) #### Stage 3 ####
(PH4) Running iteration 108 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) The total weighted hardening MSE of the iteration curve is 301.8889576342558

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 608

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 108 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Searching time by PSO: 44.38405680656433s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.08253 (target)    |
|     h0     | 621.9552 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 301.43049 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 230.42337442433512

(PH4) #### Stage 3 ####
(PH4) Running iteration 109 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) The total weighted hardening MSE of the iteration curve is 306.38421154485206

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 609

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 109 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Searching time by PSO: 43.705559968948364s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     3.62387 (target)    |
|     h0     | 1003.94895 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  224.07306 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 239.2450939507624

(PH4) #### Stage 3 ####
(PH4) Running iteration 110 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) The total weighted hardening MSE of the iteration curve is 320.86124181709613

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 610

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 110 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Searching time by PSO: 44.916929483413696s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.95312 (target)    |
|     h0     | 1559.13121 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  426.06286 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 184.30684135635346

(PH4) #### Stage 3 ####
(PH4) Running iteration 111 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) The total weighted hardening MSE of the iteration curve is 319.3838761521182

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 611

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 111 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 111 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 611 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (611, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (611, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 94.80218505859375

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (611, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (611, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 158.1711883544922

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (611, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (611, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 290.5756530761719

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (611, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (611, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 317.9459533691406

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (611, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (611, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 265.8946838378906

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (611, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (611, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 101.12014770507812

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (611, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (611, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 161.80523681640625

(PH4) The number of combined interpolate curves is 611
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.59366750717163s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Searching time by PSO: 44.96023654937744s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    2.88721 (target)    |
|     h0     | 749.28589 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 215.09289 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 225.16703733445544

(PH4) #### Stage 3 ####
(PH4) Running iteration 112 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) The total weighted hardening MSE of the iteration curve is 307.54283897513346

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 612

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 112 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Searching time by PSO: 44.62979865074158s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.35386 (target)    |
|     h0     | 634.5392 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 517.45023 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 294.92797597663787

(PH4) #### Stage 3 ####
(PH4) Running iteration 113 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) The total weighted hardening MSE of the iteration curve is 337.77153084495995

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 613

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 113 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Searching time by PSO: 44.844125509262085s

(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |    6.77679 (target)   |
|     h0     | 1217.777 MPa (target) |
|    tau0    |      53.9818 MPa      |
|   tausat   | 343.7607 MPa (target) |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 288.81238068467013

(PH4) #### Stage 3 ####
(PH4) Running iteration 114 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) The total weighted hardening MSE of the iteration curve is 336.3041809616104

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 614

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 114 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Searching time by PSO: 44.81624913215637s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.13363 (target)    |
|     h0     | 999.03548 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 474.47578 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 262.5172704163481

(PH4) #### Stage 3 ####
(PH4) Running iteration 115 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) The total weighted hardening MSE of the iteration curve is 297.5153653585754

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 615

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 115 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 115 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 615 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (615, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (615, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 124.80170440673828

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (615, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (615, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 335.10504150390625

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (615, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (615, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 157.19869995117188

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (615, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (615, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 119.58746337890625

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (615, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (615, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 309.1524353027344

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (615, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (615, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 259.9866638183594

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (615, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (615, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 131.0283660888672

(PH4) The number of combined interpolate curves is 615
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.691444158554077s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Searching time by PSO: 47.400895833969116s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.73393 (target)    |
|     h0     | 475.5946 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 446.30894 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 158.7533513317552

(PH4) #### Stage 3 ####
(PH4) Running iteration 116 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) The total weighted hardening MSE of the iteration curve is 221.49623744023523

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 616

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 116 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Searching time by PSO: 48.31612968444824s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     5.1068 (target)     |
|     h0     | 1034.35694 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  271.20227 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 153.13856870802272

(PH4) #### Stage 3 ####
(PH4) Running iteration 117 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) The total weighted hardening MSE of the iteration curve is 217.29863132471527

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 617

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 117 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 117 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 617 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (617, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (617, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 125.90306854248047

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (617, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (617, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 233.876953125

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (617, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (617, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 172.78292846679688

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (617, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (617, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 93.88322448730469

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (617, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (617, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 126.60128021240234

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (617, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (617, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 129.13424682617188

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (617, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (617, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 140.88453674316406

(PH4) The number of combined interpolate curves is 617
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 25.11523413658142s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Searching time by PSO: 46.98192000389099s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    7.20855 (target)    |
|     h0     | 821.4846 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 387.86546 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 305.207882702111

(PH4) #### Stage 3 ####
(PH4) Running iteration 118 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) The total weighted hardening MSE of the iteration curve is 412.86842735325274

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 618

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 118 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Searching time by PSO: 46.196823835372925s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.14927 (target)    |
|     h0     | 770.64797 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 208.38704 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 288.5027194647836

(PH4) #### Stage 3 ####
(PH4) Running iteration 119 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) The total weighted hardening MSE of the iteration curve is 426.09335904217767

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 619

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 119 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) Searching time by PSO: 46.84514760971069s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.9079 (target)     |
|     h0     | 1183.80115 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  420.59922 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 317.4248971444533

(PH4) #### Stage 3 ####
(PH4) Running iteration 120 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 619

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 120 ####
(PH4) Searching time by PSO: 47.140384912490845s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |     6.555 (target)     |
|     h0     | 785.34939 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 382.60773 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 350.214412821729

(PH4) #### Stage 3 ####
(PH4) Running iteration 120 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 19 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 519 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (519, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (519, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 163.4259033203125

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (519, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (519, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 121.7816390991211

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (519, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (519, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 191.3787384033203

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (519, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (519, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 160.5700225830078

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (519, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (519, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 207.42262268066406

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (519, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (519, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 189.43505859375

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (519, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (519, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 241.18701171875

(PH4) The number of combined interpolate curves is 519
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.146915912628174s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 20 ####
(PH4) Searching time by PSO: 46.74449563026428s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.71639 (target)    |
|     h0     | 867.57983 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 318.73784 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 153.19139716995568

(PH4) #### Stage 3 ####
(PH4) Running iteration 20 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 21 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 521 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (521, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (521, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 117.6070556640625

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (521, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 337.5540771484375

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (521, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 170.59727478027344

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (521, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 97.90776824951172

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (521, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 171.71405029296875

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (521, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 126.7540054321289

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (521, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (521, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 210.34864807128906

(PH4) The number of combined interpolate curves is 521
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 22.699326276779175s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Searching time by PSO: 45.52301597595215s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.70554 (target)    |
|     h0     | 712.10999 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 407.13435 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 140.87108748437487

(PH4) #### Stage 3 ####
(PH4) Running iteration 22 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) The total weighted hardening MSE of the iteration curve is 223.56034431785923

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 522

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 22 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Searching time by PSO: 45.8793249130249s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.25315 (target)    |
|     h0     | 477.3155 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 423.72338 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 179.18096393583505

(PH4) #### Stage 3 ####
(PH4) Running iteration 23 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) The total weighted hardening MSE of the iteration curve is 236.0972610025639

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 523

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 23 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Searching time by PSO: 44.90546941757202s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.41928 (target)    |
|     h0     | 439.31089 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 472.0015 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 124.90746559813246

(PH4) #### Stage 3 ####
(PH4) Running iteration 24 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) The total weighted hardening MSE of the iteration curve is 249.9234753646495

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 524

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 24 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Searching time by PSO: 45.74524402618408s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.68394 (target)    |
|     h0     | 698.74783 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 288.47475 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 112.98613418832738

(PH4) #### Stage 3 ####
(PH4) Running iteration 25 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) The total weighted hardening MSE of the iteration curve is 206.27905403003717

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 525

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 25 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Searching time by PSO: 45.758323431015015s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.92733 (target)    |
|     h0     | 392.77044 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 342.64391 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 134.655682006126

(PH4) #### Stage 3 ####
(PH4) Running iteration 26 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) The total weighted hardening MSE of the iteration curve is 305.2405838660213

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 526

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 26 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Searching time by PSO: 44.68998098373413s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.39823 (target)    |
|     h0     | 960.79759 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 248.72202 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 81.47113065801723

(PH4) #### Stage 3 ####
(PH4) Running iteration 27 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) The total weighted hardening MSE of the iteration curve is 226.33440171725437

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 527

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 27 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Searching time by PSO: 44.88848614692688s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.31714 (target)    |
|     h0     | 967.63709 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 252.54579 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 114.62015604142866

(PH4) #### Stage 3 ####
(PH4) Running iteration 28 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) The total weighted hardening MSE of the iteration curve is 248.17094727644422

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 528

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 28 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Searching time by PSO: 45.29365134239197s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.20903 (target)    |
|     h0     | 815.05748 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 211.98271 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 150.09736849528147

(PH4) #### Stage 3 ####
(PH4) Running iteration 29 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) The total weighted hardening MSE of the iteration curve is 228.7771276778498

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 529

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 29 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Searching time by PSO: 44.70027685165405s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.47325 (target)    |
|     h0     | 873.59561 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 266.13226 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 131.5538255202677

(PH4) #### Stage 3 ####
(PH4) Running iteration 30 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Iteration simulation has not converged. Rerunning the optimizer to obtain another set of candidate parameters

(PH4) Retraining ANN with slightly different configurations to prevent nonconverging parameters
(PH4) The number of combined interpolate curves is 529

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Searching time by PSO: 45.29295802116394s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.0458 (target)     |
|     h0     | 743.24113 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 314.74047 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 133.5475887121108

(PH4) #### Stage 3 ####
(PH4) Running iteration 30 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 29 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 529 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    4.408205    |
|     h0     | 716.858429 MPa |
|    tau0    | 62.223112 MPa  |
|   tausat   | 213.893447 MPa |
|    self    |    1.669835    |
|  coplanar  |    1.781891    |
| collinear  |    2.463733    |
| orthogonal |    0.113057    |
|  glissile  |    2.603802    |
|  sessile   |    0.163583    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (529, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (529, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 90.08678436279297

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (529, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 241.62637329101562

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (529, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 242.89349365234375

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (529, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 128.3619842529297

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (529, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 190.9461212158203

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (529, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 68.7083969116211

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (529, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (529, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 231.943603515625

(PH4) The number of combined interpolate curves is 529
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.663564205169678s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Searching time by PSO: 45.03142309188843s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.14469 (target)    |
|     h0     | 798.1202 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 543.18388 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 168.1880005383266

(PH4) #### Stage 3 ####
(PH4) Running iteration 30 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) The total weighted hardening MSE of the iteration curve is 273.3024548407553

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 530

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 30 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Searching time by PSO: 45.27370643615723s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.52656 (target)    |
|     h0     | 978.23374 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 252.57727 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 118.4456197853332

(PH4) #### Stage 3 ####
(PH4) Running iteration 31 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) The total weighted hardening MSE of the iteration curve is 226.860873008215

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 531

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 31 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Searching time by PSO: 45.55410432815552s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.90824 (target)    |
|     h0     | 919.64347 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 272.27066 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 125.34814603424003

(PH4) #### Stage 3 ####
(PH4) Running iteration 32 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) The total weighted hardening MSE of the iteration curve is 217.82677030877292

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 532

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 32 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Searching time by PSO: 45.351887226104736s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.81871 (target)    |
|     h0     | 529.49492 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 358.82952 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 111.57629170579926

(PH4) #### Stage 3 ####
(PH4) Running iteration 33 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) The total weighted hardening MSE of the iteration curve is 222.0018175271726

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 533

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 33 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Searching time by PSO: 45.51699757575989s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.56488 (target)    |
|     h0     | 445.75279 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 370.39336 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 125.00309648600634

(PH4) #### Stage 3 ####
(PH4) Running iteration 34 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) The total weighted hardening MSE of the iteration curve is 307.53744030005186

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 534

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 34 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Searching time by PSO: 43.95905065536499s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     3.74188 (target)    |
|     h0     | 1007.31559 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  208.19092 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 137.6895038617343

(PH4) #### Stage 3 ####
(PH4) Running iteration 35 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) The total weighted hardening MSE of the iteration curve is 216.588154305258

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 535

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 35 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_planestrain_TD
nonlinear_uniaxial_TD


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 35 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 535 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    7.910956    |
|     h0     | 333.816908 MPa |
|    tau0    |  93.68084 MPa  |
|   tausat   | 719.64032 MPa  |
|    self    |    0.714358    |
|  coplanar  |    0.03902     |
| collinear  |    0.575289    |
| orthogonal |    0.276139    |
|  glissile  |    0.132067    |
|  sessile   |    2.731366    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (535, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (535, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 72.70166015625

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (535, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 405.5579833984375

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (535, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 189.52908325195312

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (535, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 128.37744140625

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (535, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 124.23822784423828

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (535, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 137.62228393554688

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (535, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (535, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 125.99878692626953

(PH4) The number of combined interpolate curves is 535
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.482876539230347s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Searching time by PSO: 45.295050859451294s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     4.81856 (target)    |
|     h0     | 1009.59676 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  280.69036 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 82.18315330054128

(PH4) #### Stage 3 ####
(PH4) Running iteration 36 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) The total weighted hardening MSE of the iteration curve is 191.35446809047278

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 536

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 36 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Searching time by PSO: 45.40281438827515s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.39498 (target)    |
|     h0     | 707.13799 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 274.62145 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 95.34615205874678

(PH4) #### Stage 3 ####
(PH4) Running iteration 37 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) The total weighted hardening MSE of the iteration curve is 145.91836407070733

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 537

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 37 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Searching time by PSO: 45.61370801925659s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.64228 (target)    |
|     h0     | 1321.16871 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  314.52718 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 107.96424489068644

(PH4) #### Stage 3 ####
(PH4) Running iteration 38 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) The total weighted hardening MSE of the iteration curve is 171.37563392983995

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 538

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 38 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Searching time by PSO: 46.00597786903381s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.68236 (target)    |
|     h0     | 640.22998 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 436.3258 MPa (target)  |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 96.08195596351192

(PH4) #### Stage 3 ####
(PH4) Running iteration 39 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) The total weighted hardening MSE of the iteration curve is 157.96765511586796

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 539

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 39 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Searching time by PSO: 45.64911127090454s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.99825 (target)    |
|     h0     | 686.44832 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 423.07761 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 94.54790516631547

(PH4) #### Stage 3 ####
(PH4) Running iteration 40 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) The total weighted hardening MSE of the iteration curve is 149.81502186990667

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 540

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 40 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Searching time by PSO: 44.76169562339783s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.0126 (target)     |
|     h0     | 875.36323 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 501.76737 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 75.8678326130754

(PH4) #### Stage 3 ####
(PH4) Running iteration 41 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) The total weighted hardening MSE of the iteration curve is 174.04866674714742

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 541

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 41 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Searching time by PSO: 46.014840841293335s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    2.24961 (target)    |
|     h0     | 619.98027 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 164.15161 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 100.21309538828714

(PH4) #### Stage 3 ####
(PH4) Running iteration 42 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) The total weighted hardening MSE of the iteration curve is 162.54104067993111

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 542

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 42 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Searching time by PSO: 45.251630544662476s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    5.76179 (target)    |
|     h0     | 619.08991 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 377.57418 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 116.9781588483039

(PH4) #### Stage 3 ####
(PH4) Running iteration 43 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 42 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 542 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    7.910956    |
|     h0     | 333.816908 MPa |
|    tau0    |  93.68084 MPa  |
|   tausat   | 719.64032 MPa  |
|    self    |    0.714358    |
|  coplanar  |    0.03902     |
| collinear  |    0.575289    |
| orthogonal |    0.276139    |
|  glissile  |    0.132067    |
|  sessile   |    2.731366    |
+------------+----------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (542, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (542, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 120.57831573486328

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (542, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 178.85638427734375

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (542, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 317.46405029296875

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (542, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 110.2820053100586

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (542, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 213.56149291992188

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (542, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 125.53131866455078

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (542, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 108.17485046386719

(PH4) The number of combined interpolate curves is 542
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 24.432920932769775s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Searching time by PSO: 44.276732206344604s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.34004 (target)    |
|     h0     | 852.87346 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 341.62732 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 91.5665024015103

(PH4) #### Stage 3 ####
(PH4) Running iteration 43 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     3.5%    |
|   Small linear hardening dev  |      3%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     5.5%    |
| Small nonlinear hardening dev |      5%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 42 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 542 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+---------------+
| Parameter  |     Value     |
+------------+---------------+
|     a      |    6.68635    |
|     h0     | 976.33817 MPa |
|    tau0    |  43.10955 MPa |
|   tausat   | 360.81991 MPa |
|    self    |    0.32517    |
|  coplanar  |     0.9835    |
| collinear  |    8.27915    |
| orthogonal |    0.89645    |
|  glissile  |    0.87494    |
|  sessile   |    0.86294    |
+------------+---------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (542, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (542, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 105.47042846679688

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (542, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 306.421630859375

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (542, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 259.1047668457031

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (542, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 158.4513397216797

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (542, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 304.15704345703125

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (542, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 159.923828125

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (542, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (542, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 137.13809204101562

(PH4) The number of combined interpolate curves is 542
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 22.60142207145691s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Searching time by PSO: 43.650665044784546s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.44658 (target)    |
|     h0     | 907.7881 MPa (target)  |
|    tau0    |      53.9818 MPa       |
|   tausat   | 230.01974 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 58.213609964976136

(PH4) #### Stage 3 ####
(PH4) Running iteration 43 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) The total weighted hardening MSE of the iteration curve is 61.82080411596743

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 543

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 43 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Searching time by PSO: 43.8620970249176s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     6.43453 (target)    |
|     h0     | 1335.44029 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  304.16865 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 52.63083239852027

(PH4) #### Stage 3 ####
(PH4) Running iteration 44 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) The total weighted hardening MSE of the iteration curve is 45.83262154017019

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 544

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 44 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Searching time by PSO: 43.33401894569397s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    1.65706 (target)    |
|     h0     | 434.05088 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 182.35339 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 38.5625076621383

(PH4) #### Stage 3 ####
(PH4) Running iteration 45 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) The total weighted hardening MSE of the iteration curve is 55.294309392541734

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 545

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 45 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Searching time by PSO: 43.32536482810974s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     3.46419 (target)    |
|     h0     | 1141.74728 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  196.53737 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 53.342973294522196

(PH4) #### Stage 3 ####
(PH4) Running iteration 46 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) The total weighted hardening MSE of the iteration curve is 42.862690528569516

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 546

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 46 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Searching time by PSO: 43.996098041534424s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.91394 (target)    |
|     h0     | 759.39742 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 543.94946 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 30.569081660086137

(PH4) #### Stage 3 ####
(PH4) Running iteration 47 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) The total weighted hardening MSE of the iteration curve is 54.240329165768074

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 547

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 47 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Searching time by PSO: 44.354315519332886s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.8645 (target)     |
|     h0     | 926.26621 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 487.54332 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 42.01098921105955

(PH4) #### Stage 3 ####
(PH4) Running iteration 48 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) The total weighted hardening MSE of the iteration curve is 50.64414969163916

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 548

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 48 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Searching time by PSO: 44.01239585876465s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     4.79315 (target)    |
|     h0     | 1133.66192 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  247.60644 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 42.24550719758551

(PH4) #### Stage 3 ####
(PH4) Running iteration 49 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) The total weighted hardening MSE of the iteration curve is 43.47046526368282

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 549

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 49 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Searching time by PSO: 44.32712483406067s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    6.90818 (target)    |
|     h0     | 1026.1546 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 344.44457 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 49.66429697459917

(PH4) #### Stage 3 ####
(PH4) Running iteration 50 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) The total weighted hardening MSE of the iteration curve is 46.06490964247417

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 550

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 50 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_planestrain_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Searching time by PSO: 44.7400426864624s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.84587 (target)    |
|     h0     | 762.66054 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 554.71658 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 44.21397881034447

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     4.5%    |
|   Small linear hardening dev  |      4%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     6.5%    |
| Small nonlinear hardening dev |      6%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 50 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 550 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+---------------+
| Parameter  |     Value     |
+------------+---------------+
|     a      |    6.68635    |
|     h0     | 976.33817 MPa |
|    tau0    |  43.10955 MPa |
|   tausat   | 360.81991 MPa |
|    self    |    0.32517    |
|  coplanar  |     0.9835    |
| collinear  |    8.27915    |
| orthogonal |    0.89645    |
|  glissile  |    0.87494    |
|  sessile   |    0.86294    |
+------------+---------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (550, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (550, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 95.34851837158203

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (550, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 141.0668487548828

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (550, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 132.11727905273438

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (550, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 136.0723114013672

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (550, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 234.48866271972656

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (550, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 97.3569107055664

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (550, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (550, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 159.6082000732422

(PH4) The number of combined interpolate curves is 550
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.51235866546631s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Searching time by PSO: 44.72025465965271s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     4.90552 (target)    |
|     h0     | 1029.37462 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  262.29561 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.71705812773285

(PH4) #### Stage 3 ####
(PH4) Running iteration 51 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) The total weighted hardening MSE of the iteration curve is 43.26349381057767

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 551

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 51 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Searching time by PSO: 44.608365297317505s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.3515 (target)     |
|     h0     | 1951.37523 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  366.76554 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 36.3248535851661

(PH4) #### Stage 3 ####
(PH4) Running iteration 52 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) The total weighted hardening MSE of the iteration curve is 52.98967007384067

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 552

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 52 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Searching time by PSO: 44.5477557182312s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.70919 (target)    |
|     h0     | 934.26327 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 230.72215 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 48.623982662168416

(PH4) #### Stage 3 ####
(PH4) Running iteration 53 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) The total weighted hardening MSE of the iteration curve is 46.605308366326014

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 553

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 53 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Searching time by PSO: 45.37830877304077s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     5.34257 (target)    |
|     h0     | 1449.60485 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  259.6108 MPa (target)  |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 56.29452610620571

(PH4) #### Stage 3 ####
(PH4) Running iteration 54 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) The total weighted hardening MSE of the iteration curve is 52.066671347294786

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 554

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 54 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Searching time by PSO: 45.12874126434326s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.94619 (target)    |
|     h0     | 1148.7959 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 221.93794 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.76860626375987

(PH4) #### Stage 3 ####
(PH4) Running iteration 55 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) The total weighted hardening MSE of the iteration curve is 46.445709159119154

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 555

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 55 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Searching time by PSO: 45.0418004989624s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.28982 (target)    |
|     h0     | 614.47942 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 310.63812 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 41.48396794261693

(PH4) #### Stage 3 ####
(PH4) Running iteration 56 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) The total weighted hardening MSE of the iteration curve is 55.77360044609813

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 556

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 56 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Searching time by PSO: 44.39149188995361s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    4.72876 (target)    |
|     h0     | 1128.2071 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 254.65505 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 44.522231050897844

(PH4) #### Stage 3 ####
(PH4) Running iteration 57 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) The total weighted hardening MSE of the iteration curve is 45.033768212712864

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 557

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 57 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Searching time by PSO: 44.871575355529785s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     1.99506 (target)    |
|     h0     | 1073.41039 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  150.91677 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 57.58438080922734

(PH4) #### Stage 3 ####
(PH4) Running iteration 58 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) The total weighted hardening MSE of the iteration curve is 63.41707159723938

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 558

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 58 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Searching time by PSO: 45.42830944061279s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.86458 (target)    |
|     h0     | 533.69932 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 312.90062 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 69.67976530411471

(PH4) #### Stage 3 ####
(PH4) Running iteration 59 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) The total weighted hardening MSE of the iteration curve is 63.5893962260235

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 559

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 59 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Searching time by PSO: 45.19449067115784s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.81071 (target)    |
|     h0     | 973.12642 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 492.62728 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 48.53029366133675

(PH4) #### Stage 3 ####
(PH4) Running iteration 60 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) The total weighted hardening MSE of the iteration curve is 47.05737365996479

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 560

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 60 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Searching time by PSO: 44.56114721298218s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.11115 (target)    |
|     h0     | 1831.27116 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  375.82881 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 49.21584247176128

(PH4) #### Stage 3 ####
(PH4) Running iteration 61 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) The total weighted hardening MSE of the iteration curve is 58.862754585334045

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 561

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 61 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Searching time by PSO: 45.4178307056427s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     5.50063 (target)    |
|     h0     | 1064.79052 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  286.0201 MPa (target)  |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 53.37798330355376

(PH4) #### Stage 3 ####
(PH4) Running iteration 62 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) The total weighted hardening MSE of the iteration curve is 43.411504413246575

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 562

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 62 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Searching time by PSO: 45.502867221832275s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.19578 (target)    |
|     h0     | 1501.87926 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  336.32065 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 43.63947524372891

(PH4) #### Stage 3 ####
(PH4) Running iteration 63 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) The total weighted hardening MSE of the iteration curve is 63.81338805896509

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 563

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 63 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Searching time by PSO: 45.65615439414978s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.27152 (target)    |
|     h0     | 1947.96652 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  356.54232 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 34.64752257748982

(PH4) #### Stage 3 ####
(PH4) Running iteration 64 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) The total weighted hardening MSE of the iteration curve is 50.68206605036193

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 564

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 64 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Searching time by PSO: 45.362579107284546s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     7.3589 (target)     |
|     h0     | 1030.25674 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  373.16583 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 64.64285241667531

(PH4) #### Stage 3 ####
(PH4) Running iteration 65 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) The total weighted hardening MSE of the iteration curve is 45.055621935899836

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 565

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 65 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Searching time by PSO: 45.477304458618164s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     1.99517 (target)    |
|     h0     | 1176.41523 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  123.53015 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 29.32748064733802

(PH4) #### Stage 3 ####
(PH4) Running iteration 66 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) The total weighted hardening MSE of the iteration curve is 111.83027823755558

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 566

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 66 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_RD
nonlinear_biaxial_TD
nonlinear_planestrain_RD
nonlinear_planestrain_TD
nonlinear_uniaxial_RD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Searching time by PSO: 45.83609318733215s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    9.93937 (target)    |
|     h0     | 891.74561 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 521.62603 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 42.5919314284649

(PH4) #### Stage 3 ####
(PH4) Running iteration 67 simulation


Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     4.5%    |
|   Small linear hardening dev  |      4%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     6.5%    |
| Small nonlinear hardening dev |      6%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 66 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 566 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+---------------+
| Parameter  |     Value     |
+------------+---------------+
|     a      |    6.68635    |
|     h0     | 976.33817 MPa |
|    tau0    |  43.10955 MPa |
|   tausat   | 360.81991 MPa |
|    self    |    0.32517    |
|  coplanar  |     0.9835    |
| collinear  |    8.27915    |
| orthogonal |    0.89645    |
|  glissile  |    0.87494    |
|  sessile   |    0.86294    |
+------------+---------------+
(PH4) Saving the default curves
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (566, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (566, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 110.97276306152344

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (566, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 185.93470764160156

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (566, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 226.06735229492188

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (566, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 151.26011657714844

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (566, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 182.70736694335938

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (566, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 114.78263854980469

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (566, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (566, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 183.84754943847656

(PH4) The number of combined interpolate curves is 566
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 26.08188509941101s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) The file stage1_curves.npy detected, which means the first stage has finished
(PH4) First optimization stage finished

(PH4) The current result parameters
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 53.9818 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Searching time by PSO: 45.28019952774048s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |    3.05616 (target)    |
|     h0     | 380.08434 MPa (target) |
|    tau0    |      53.9818 MPa       |
|   tausat   | 336.22117 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 48.26682450479028

(PH4) #### Stage 3 ####
(PH4) Running iteration 67 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) The total weighted hardening MSE of the iteration curve is 91.46112775257035

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 567

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 67 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Searching time by PSO: 45.748794078826904s

(PH4) The best candidate parameters found by PSO
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.97495 (target)    |
|     h0     | 1125.50849 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  475.37173 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) This is new parameters. Fitness value of the best candidate parameters: 58.405416814552346

(PH4) #### Stage 3 ####
(PH4) Running iteration 68 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) The total weighted hardening MSE of the iteration curve is 46.50666779035306

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 568

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 68
(PH4) The third stage parameter solution is:
+------------+-------------------------+
| Parameter  |          Value          |
+------------+-------------------------+
|     a      |     9.97495 (target)    |
|     h0     | 1125.50849 MPa (target) |
|    tau0    |       53.9818 MPa       |
|   tausat   |  475.37173 MPa (target) |
|    self    |         0.967484        |
|  coplanar  |         1.624813        |
| collinear  |         5.07754         |
| orthogonal |         0.872437        |
|  glissile  |         0.247625        |
|  sessile   |         2.332166        |
+------------+-------------------------+
(PH4) Third optimization stage finished

(PH4) **********************************************************************
(PH4) Fourth optimization stage: Optimize the small hardening parameters for the curve PH4

(PH4) #### Stage 4 ####
(PH4) Optimizing the parameters self, coplanar, collinear, orthogonal, glissile, sessile
(PH4) Fourth optimization stage starts

(PH4) #### Stage 4 ####
(PH4) #### (Curve PH4) Iteration 68 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 68
(PH4) The fourth stage parameter solution is:
+------------+-------------------+
| Parameter  |       Value       |
+------------+-------------------+
|     a      |      9.97495      |
|     h0     |   1125.50849 MPa  |
|    tau0    |    53.9818 MPa    |
|   tausat   |   475.37173 MPa   |
|    self    | 0.967484 (target) |
|  coplanar  | 1.624813 (target) |
| collinear  |  5.07754 (target) |
| orthogonal | 0.872437 (target) |
|  glissile  | 0.247625 (target) |
|  sessile   | 2.332166 (target) |
+------------+-------------------+
(PH4) Fourth optimization stage finished

(PH4) All four optimization stages have successfully completed for curve PH4
(PH4) The final optimized set of parameters is:
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    9.97495     |
|     h0     | 1125.50849 MPa |
|    tau0    |  53.9818 MPa   |
|   tausat   | 475.37173 MPa  |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) Optimization for curve PH4 has finished
(PH4) Waiting for other curves to finish their optimization


======================================================================
Fitting parameter optimization for all target curves completed
Congratulations! Thank you for using the Crystal Plasticity Software

Welcome to the Crystal Plasticity Parameter Calibration software

The configurations you have chosen: 
+-------------------------------+-------------+
|         Configurations        | User choice |
+-------------------------------+-------------+
|             Server            |    mahti    |
|           Hyperqueue          |      no     |
|   Initial simulation number   |     2000    |
|   Initial simulation method   |     auto    |
|        Searching space        |  continuous |
|         Searching type        |   general   |
|            Material           |  RVE_1_40_D |
|             CP Law            |      PH     |
|           Optimizer           |     PSO     |
|         Target curves         |     PH4     |
|       Experimental types      |  D, D, D, E |
|          Stress unit          |     MPa     |
|       Rounding decimals       |      5      |
|   Large linear yielding dev   |      1%     |
|   Small linear yielding dev   |     0.5%    |
|   Large linear hardening dev  |     4.5%    |
|   Small linear hardening dev  |      4%     |
|  Large nonlinear yielding dev |     1.5%    |
|  Small nonlinear yielding dev |      1%     |
| Large nonlinear hardening dev |     6.5%    |
| Small nonlinear hardening dev |      6%     |
+-------------------------------+-------------+

Generating necessary directories
The path to your main project folder is
/scratch/project_2004956/Binh/COE_PH_PSO_continuous

PyTorch version: 1.13.0+cu117
Device used: cpu

**********************************************************************

Step 0: Running initial simulations

Done. 500 simulations completed
Saving reverse and original initial true and process curves
Finished preparing all target curves

(PH4) **********************************************************************
(PH4) Step 1: Loading progress and preparing data for curve PH4

(PH4) Curve PH4 status: 
(PH4) 68 iteration simulations completed.
(PH4) 500 initial simulations completed.
(PH4) Total: 568 simulations completed.

(PH4) Saving interpolating PH4 target curves
(PH4) Saving initial interpolating curves and reverse initial interpolating curves
(PH4) Experimental and simulated curves preparation completed

(PH4) Curve PH4 info: 
+--------------------------+--------------+-------------------------+-------------------------+
|         Loading          | Exp σ_yield  | Large σ_yield sim range | Small σ_yield sim range |
+--------------------------+--------------+-------------------------+-------------------------+
|    linear_uniaxial_RD    | 132.147 MPa  |  [130.826, 133.469] MPa |  [131.487, 132.808 MPa] |
|   nonlinear_biaxial_RD   | 232.185 MPa  |  [228.702, 235.668] MPa |  [229.863, 234.507 MPa] |
|   nonlinear_biaxial_TD   | 221.318 MPa  |  [217.998, 224.637] MPa |  [219.105, 223.531 MPa] |
| nonlinear_planestrain_RD | 212.946 MPa  |  [209.752, 216.140] MPa |  [210.816, 215.075 MPa] |
| nonlinear_planestrain_TD | 214.199 MPa  |  [210.986, 217.412] MPa |  [212.057, 216.341 MPa] |
|  nonlinear_uniaxial_RD   | 196.410 MPa  |  [193.464, 199.356] MPa |  [194.446, 198.374 MPa] |
|  nonlinear_uniaxial_TD   | 198.441 MPa  |  [195.465, 201.418] MPa |  [196.457, 200.426 MPa] |
+--------------------------+--------------+-------------------------+-------------------------+

(PH4) The file default_curves.npy exists. Loading the default curves
(PH4) Parameter set of the closest simulation curve to the target curve PH4 is: 
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    | 56.349675 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) This parameter set will serve as default parameters for the 4 stage optimization of curve PH4

(PH4) **********************************************************************
(PH4) Step 2: Train the regressors for all loadings with the initial simulations of curve PH4

(PH4) ANN model: (parameters) -> (stress values at interpolating strain points)
(PH4) ANN configuration:
+------------------------------------+----------+
|         ANN configurations         |  Choice  |
+------------------------------------+----------+
|      Number of hidden layers       |    2     |
|     Hidden layer nodes formula     | formula1 |
|           ANN Optimizer            |   Adam   |
|           Learning rate            |   0.1    |
|       L2 regularization term       |   0.5    |
|    Epochs of linear_uniaxial_RD    |   2200   |
|   Epochs of nonlinear_biaxial_RD   |   3200   |
|   Epochs of nonlinear_biaxial_TD   |   2200   |
| Epochs of nonlinear_planestrain_RD |   3600   |
| Epochs of nonlinear_planestrain_TD |   3000   |
|  Epochs of nonlinear_uniaxial_RD   |   3400   |
|  Epochs of nonlinear_uniaxial_TD   |   2000   |
+------------------------------------+----------+

(PH4) (linear_uniaxial_RD) paramFeatures shape is (568, 10)
(PH4) (linear_uniaxial_RD) stressLabels shape is (568, 27)
(PH4) Finish training ANN for loading linear_uniaxial_RD
(PH4) Training MSE error: 174.6248321533203

(PH4) (nonlinear_biaxial_RD) paramFeatures shape is (568, 10)
(PH4) (nonlinear_biaxial_RD) stressLabels shape is (568, 12)
(PH4) Finish training ANN for loading nonlinear_biaxial_RD
(PH4) Training MSE error: 263.8575134277344

(PH4) (nonlinear_biaxial_TD) paramFeatures shape is (568, 10)
(PH4) (nonlinear_biaxial_TD) stressLabels shape is (568, 14)
(PH4) Finish training ANN for loading nonlinear_biaxial_TD
(PH4) Training MSE error: 172.0474090576172

(PH4) (nonlinear_planestrain_RD) paramFeatures shape is (568, 10)
(PH4) (nonlinear_planestrain_RD) stressLabels shape is (568, 18)
(PH4) Finish training ANN for loading nonlinear_planestrain_RD
(PH4) Training MSE error: 111.07845306396484

(PH4) (nonlinear_planestrain_TD) paramFeatures shape is (568, 10)
(PH4) (nonlinear_planestrain_TD) stressLabels shape is (568, 16)
(PH4) Finish training ANN for loading nonlinear_planestrain_TD
(PH4) Training MSE error: 169.3912811279297

(PH4) (nonlinear_uniaxial_RD) paramFeatures shape is (568, 10)
(PH4) (nonlinear_uniaxial_RD) stressLabels shape is (568, 20)
(PH4) Finish training ANN for loading nonlinear_uniaxial_RD
(PH4) Training MSE error: 111.37081909179688

(PH4) (nonlinear_uniaxial_TD) paramFeatures shape is (568, 10)
(PH4) (nonlinear_uniaxial_TD) stressLabels shape is (568, 21)
(PH4) Finish training ANN for loading nonlinear_uniaxial_TD
(PH4) Training MSE error: 343.5430908203125

(PH4) The number of combined interpolate curves is 568
(PH4) Finish training ANN for all loadings of curve PH4
(PH4) Total training time: 23.4106388092041s

(PH4) **********************************************************************
(PH4) Step 3: Assessment of number optimization stages and level of deviation percentage of curve PH4

(PH4) The large yielding parameters are ['tau0']
(PH4) The small yielding parameters are []
(PH4) The large hardening parameters are ['a', 'h0', 'tausat']
(PH4) The small hardening parameters are ['self', 'coplanar', 'collinear', 'orthogonal', 'glissile', 'sessile']

(PH4) There are 1 large yielding parameters
(PH4) 1st stage optimization required
(PH4) There are no small yielding parameters
(PH4) 2nd stage optimization not required
(PH4) There are 3 large hardening parameters
(PH4) 3rd stage optimization required
(PH4) There are 6 small hardening parameters
(PH4) 4th stage optimization required

(PH4) Because there are no small yielding parameters but there are large yielding parameters
(PH4) the large yielding deviation percentage is set as the small yielding deviation percentage
(PH4) largeLinearYieldingDev = 0.5%

(PH4) largeNonlinearYieldingDev = 1%

(PH4) The chosen optimizer is Particle Swarm Optimization
(PH4) Starting the four stage optimization for curve PH4

(PH4) **********************************************************************
(PH4) First optimization stage: Optimize the large yielding parameters for the curve PH4

(PH4) #### Stage 1 ####
(PH4) Optimizing the parameters tau0
(PH4) First optimization stage starts

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Searching time by PSO: 8.21099066734314s

(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 56.47423 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.5451384678301692

(PH4) #### Stage 1 ####
(PH4) Running iteration 69 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) The total weighted yielding MSE of the iteration curve is 827.3636759470752

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 569

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 69 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Searching time by PSO: 8.417875528335571s

(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 52.96494 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.12635701857096898

(PH4) #### Stage 1 ####
(PH4) Running iteration 70 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) The total weighted yielding MSE of the iteration curve is 1831.889454384047

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 570

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 70 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Searching time by PSO: 8.505012273788452s

(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 54.72758 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.18730805182048824

(PH4) #### Stage 1 ####
(PH4) Running iteration 71 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) The total weighted yielding MSE of the iteration curve is 775.592158064284

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 571

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 71 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Searching time by PSO: 8.42325234413147s

(PH4) The best candidate parameters found by PSO
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 56.9864 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.11630227498311944

(PH4) #### Stage 1 ####
(PH4) Running iteration 72 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) The total weighted yielding MSE of the iteration curve is 843.0133772764242

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 572

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 72 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Searching time by PSO: 8.43229627609253s

(PH4) The best candidate parameters found by PSO
+------------+----------------------+
| Parameter  |        Value         |
+------------+----------------------+
|     a      |       6.434218       |
|     h0     |    324.312156 MPa    |
|    tau0    | 54.7921 MPa (target) |
|   tausat   |    784.607804 MPa    |
|    self    |       0.967484       |
|  coplanar  |       1.624813       |
| collinear  |       5.07754        |
| orthogonal |       0.872437       |
|  glissile  |       0.247625       |
|  sessile   |       2.332166       |
+------------+----------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.2376218655795907

(PH4) #### Stage 1 ####
(PH4) Running iteration 73 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) The total weighted yielding MSE of the iteration curve is 777.463196036207

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 573

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 73 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Searching time by PSO: 8.25185513496399s

(PH4) The best candidate parameters found by PSO
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 54.03613 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 0.2090132359866626

(PH4) #### Stage 1 ####
(PH4) Running iteration 74 simulation

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) The total weighted yielding MSE of the iteration curve is 755.7463752852348

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 574

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 1 ####
(PH4) #### (Curve PH4) Iteration 74 ####
(PH4) All loadings have successfully satisfied the deviation percentage
(PH4) Succeeded iteration: 74
(PH4) The first stage parameter solution is:
+------------+-----------------------+
| Parameter  |         Value         |
+------------+-----------------------+
|     a      |        6.434218       |
|     h0     |     324.312156 MPa    |
|    tau0    | 54.03613 MPa (target) |
|   tausat   |     784.607804 MPa    |
|    self    |        0.967484       |
|  coplanar  |        1.624813       |
| collinear  |        5.07754        |
| orthogonal |        0.872437       |
|  glissile  |        0.247625       |
|  sessile   |        2.332166       |
+------------+-----------------------+
(PH4) First optimization stage finished

(PH4) **********************************************************************
(PH4) Second optimization stage: Optimize the small yielding parameters for the curve PH4

(PH4) #### Stage 2 ####
(PH4) There are no small yielding parameters to optimize
(PH4) Saving second stage result curves as the default curves
(PH4) Second optimization stage finished

(PH4) The current result parameters
+------------+----------------+
| Parameter  |     Value      |
+------------+----------------+
|     a      |    6.434218    |
|     h0     | 324.312156 MPa |
|    tau0    |  54.03613 MPa  |
|   tausat   | 784.607804 MPa |
|    self    |    0.967484    |
|  coplanar  |    1.624813    |
| collinear  |    5.07754     |
| orthogonal |    0.872437    |
|  glissile  |    0.247625    |
|  sessile   |    2.332166    |
+------------+----------------+
(PH4) **********************************************************************
(PH4) Third optimization stage: Optimize the large hardening parameters for the curve PH4

(PH4) #### Stage 3 ####
(PH4) Optimizing the parameters a, h0, tausat
(PH4) Third optimization stage starts

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
linear_uniaxial_RD
nonlinear_biaxial_TD
nonlinear_uniaxial_TD

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Searching time by PSO: 47.06193947792053s

(PH4) The best candidate parameters found by PSO
+------------+------------------------+
| Parameter  |         Value          |
+------------+------------------------+
|     a      |     6.541 (target)     |
|     h0     | 903.68316 MPa (target) |
|    tau0    |      54.03613 MPa      |
|   tausat   | 374.01223 MPa (target) |
|    self    |        0.967484        |
|  coplanar  |        1.624813        |
| collinear  |        5.07754         |
| orthogonal |        0.872437        |
|  glissile  |        0.247625        |
|  sessile   |        2.332166        |
+------------+------------------------+
(PH4) This is new parameters. Loss of the best candidate parameters: 55.82486772650221

(PH4) #### Stage 3 ####
(PH4) Running iteration 75 simulation

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Iteration simulation has converged. Saving the one new iteration simulation curves

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) The total weighted hardening MSE of the iteration curve is 54.130066947220655

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Starting to retrain the ANN for all loadings
(PH4) The number of combined interpolate curves is 575

(PH4) #### Stage 3 ####
(PH4) #### (Curve PH4) Iteration 75 ####
(PH4) Finish training ANN for all loadings

(PH4) #### Stage 3 ####
(PH4) The loadings not satisfied are
nonlinear_biaxial_TD

